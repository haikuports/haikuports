SUMMARY="A network protocol suite"
DESCRIPTION="Network Time Protocol, or NTP, is a protocol designed to \
synchronize the clocks of computers over a network. The command line programs \
provided in this package are the implementation by the Network Time Foundation."
HOMEPAGE="http://www.ntp.org/"
COPYRIGHT="1992-2015 University of Delaware
	2011-2018 Network Time Foundation"
LICENSE="NTP"
REVISION="1"
SOURCE_URI="https://www.eecis.udel.edu/~ntp/ntp_spool/ntp4/ntp-4.2/ntp-$portVersion.tar.gz"
CHECKSUM_SHA256="709b222b5013d77d26bfff532b5ea470a8039497ef29d09363931c036cb30454"
PATCHES="ntp-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 ?x86 !x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	ntp$secondaryArchSuffix
	cmd:ntpd$secondaryArchSuffix
	cmd:calc_tickadj$secondaryArchSuffix
	cmd:ntp_keygen$secondaryArchSuffix
	cmd:ntp_wait$secondaryArchSuffix
	cmd:ntpdate$secondaryArchSuffix
	cmd:ntpdc$secondaryArchSuffix
	cmd:ntpq$secondaryArchSuffix
	cmd:ntptrace$secondaryArchSuffix
	cmd:tickadj$secondaryArchSuffix
	cmd:sntp$secondaryArchSuffix
	cmd:update_leap$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libcrypto$secondaryArchSuffix
	lib:libedit$secondaryArchSuffix
	lib:libevent_core_2.1$secondaryArchSuffix
	lib:libevent_2.1$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libncurses$secondaryArchSuffix
	lib:libreadline$secondaryArchSuffix
	lib:libssl$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libcrypto$secondaryArchSuffix
	devel:libedit$secondaryArchSuffix
	devel:libevent_2.1$secondaryArchSuffix
	devel:libintl$secondaryArchSuffix
	devel:libncurses$secondaryArchSuffix
	devel:libreadline$secondaryArchSuffix
	devel:libssl$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:gcc$secondaryArchSuffix
	cmd:libtoolize$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:which
	"

BUILD()
{
	export LDFLAGS="-lbsd -lnetwork"
	export CPPFLAGS="-DBSD_SOURCE"
	autoreconf -vfi
	runConfigure ./configure \
		--disable-simulator \
		--without-ntpsnmpd \
		--enable-step-slew \
		--enable-getifaddrs=no
	make $jobArgs
}

INSTALL()
{
	make install
}

TEST()
{
	make check
}
