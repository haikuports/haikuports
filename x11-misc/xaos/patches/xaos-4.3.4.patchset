From 8c5440ad8f9be91445bb8b17f75bcead5541cbb0 Mon Sep 17 00:00:00 2001
From: begasus <begasus@gmail.com>
Date: Fri, 8 Oct 2021 16:16:32 +0000
Subject: Fix finding catalogs when launched from Deskbar


diff --git a/src/ui/main.cpp b/src/ui/main.cpp
index a71d860..bed5497 100644
--- a/src/ui/main.cpp
+++ b/src/ui/main.cpp
@@ -51,6 +51,11 @@
 #include "windows.h"
 #endif
 
+#ifdef __HAIKU__
+#include <libgen.h>
+#include <unistd.h>
+#endif
+
 /* Command line variables */
 int printspeed;
 int delaytime = 0;
@@ -592,6 +597,13 @@ static void ui_registermenus_i18n(void)
 
 int main(int argc, char *argv[])
 {
+#ifdef __HAIKU__
+       char *binpath = realpath(argv[0], NULL);
+       if (binpath != NULL) {
+               chdir(dirname(binpath));
+               free(binpath);
+       }
+#endif
 #ifdef _WIN32
     // On Windows, attach to parent console to allow command-line output
     if (AttachConsole(ATTACH_PARENT_PROCESS)) {
-- 
2.51.0

