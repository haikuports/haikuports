From e80b5c81b7464dacd9c584bfcd9039640955b4d0 Mon Sep 17 00:00:00 2001
From: Adrien Destugues <pulkomandy@pulkomandy.tk>
Date: Wed, 11 Jul 2018 14:02:51 +0200
Subject: Add Haiku support.

Just pretend we are NetBSD.

diff --git a/setup_cares.py b/setup_cares.py
index 640c863..ea51b65 100644
--- a/setup_cares.py
+++ b/setup_cares.py
@@ -139,6 +139,8 @@ class cares_build_ext(build_ext):
             self.add_include_dir(os.path.join(self.build_config_dir, 'config_freebsd'))
         elif sys.platform.startswith('netbsd'):
             self.add_include_dir(os.path.join(self.build_config_dir, 'config_netbsd'))
+        elif sys.platform.startswith('haiku'):
+            self.add_include_dir(os.path.join(self.build_config_dir, 'config_netbsd'))
         elif sys.platform.startswith('openbsd'):
             self.add_include_dir(os.path.join(self.build_config_dir, 'config_openbsd'))
         elif sys.platform.startswith('sunos'):
-- 
2.50.1


From c2d3b9c4bae2fbdad3b01291482d5c97ae069565 Mon Sep 17 00:00:00 2001
From: Oscar Lesta <oscar.lesta@gmail.com>
Date: Wed, 27 Aug 2025 01:41:47 -0300
Subject: Haiku doesn't defines EV_ENABLE.


diff --git a/deps/c-ares/src/lib/event/ares_event_kqueue.c b/deps/c-ares/src/lib/event/ares_event_kqueue.c
index 00cdcbe..84af05b 100644
--- a/deps/c-ares/src/lib/event/ares_event_kqueue.c
+++ b/deps/c-ares/src/lib/event/ares_event_kqueue.c
@@ -148,7 +148,11 @@ static void ares_evsys_kqueue_event_process(ares_event_t      *event,
   }
 
   if (new_flags & ARES_EVENT_FLAG_READ && !(old_flags & ARES_EVENT_FLAG_READ)) {
+#ifdef EV_ENABLE
     ares_evsys_kqueue_enqueue(kq, event->fd, EVFILT_READ, EV_ADD | EV_ENABLE);
+#else
+    ares_evsys_kqueue_enqueue(kq, event->fd, EVFILT_READ, EV_ADD);
+#endif
   }
 
   if (!(new_flags & ARES_EVENT_FLAG_READ) && old_flags & ARES_EVENT_FLAG_READ) {
@@ -157,7 +161,11 @@ static void ares_evsys_kqueue_event_process(ares_event_t      *event,
 
   if (new_flags & ARES_EVENT_FLAG_WRITE &&
       !(old_flags & ARES_EVENT_FLAG_WRITE)) {
+#ifdef EV_ENABLE
     ares_evsys_kqueue_enqueue(kq, event->fd, EVFILT_WRITE, EV_ADD | EV_ENABLE);
+#else
+    ares_evsys_kqueue_enqueue(kq, event->fd, EVFILT_WRITE, EV_ADD);
+#endif
   }
 
   if (!(new_flags & ARES_EVENT_FLAG_WRITE) &&
-- 
2.50.1

