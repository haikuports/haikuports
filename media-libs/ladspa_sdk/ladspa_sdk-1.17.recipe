SUMMARY="Linux Audio Developer's Simple Plugin API"
DESCRIPTION="There is a large number of synthesis packages in use or development on the Linux \
platform at this time. The Linux Audio Developer's Simple Plugin API (LADSPA) attempts to give \
programmers the ability to write simple \`plugin\' audio processors in C/C++ and link them \
dynamically against a range of host applications.

This package contains the example plug-ins and tools from the LADSPA SDK."
HOMEPAGE="http://www.ladspa.org/"
COPYRIGHT="2000-2021 Richard W.E. Furse, Paul Barton-Davis, Stefan Westerfeld"
LICENSE="GNU LGPL v2.1"
REVISION="1"
SOURCE_URI="http://www.ladspa.org/download/ladspa_sdk_$portVersion.tgz"
CHECKSUM_SHA256="27d24f279e4b81bd17ecbdcc38e4c42991bb388826c0b200067ce0eb59d3da5b"
SOURCE_DIR="ladspa_sdk_$portVersion"
PATCHES="ladspa_sdk-$portVersion.patchset"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	ladspa_sdk$secondaryArchSuffix = $portVersion
	cmd:analyseplugin$secondaryArchSuffix
	cmd:applyplugin$secondaryArchSuffix
	cmd:listplugins$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libsndfile$secondaryArchSuffix
	"

PROVIDES_devel="
	ladspa_sdk${secondaryArchSuffix}_devel = $portVersion
	"
REQUIRES_devel="
	ladspa_sdk$secondaryArchSuffix == $portVersion base
	"

ARCHITECTURES_doc="any"
PROVIDES_doc="
	ladspa_sdk_doc
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libsndfile$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	"

TEST_REQUIRES="
	cmd:sndfile_play$secondaryArchSuffix
	"

BUILD()
{
	cd src
	PLUGINDIR=$libDir/ladspa make $jobArgs targets LIBRARIES="-lsndfile"
}

INSTALL()
{
	cd src
	make install INSTALL_PLUGINS_DIR=$libDir/ladspa \
		INSTALL_INCLUDE_DIR=$includeDir \
		INSTALL_BINARY_DIR=$binDir

	# documentation
	mkdir -p $documentationDir/packages/ladspa-sdk
	cp $sourceDir/doc/* $documentationDir/packages/ladspa-sdk

	# devel package
	packageEntries devel \
		$developDir

	# doc package
	packageEntries doc \
		$documentationDir
}

TEST()
{
	cd src
	LADSPA_PATH=plugins/ make test
}
