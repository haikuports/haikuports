SUMMARY="A lightweight, native, lazy evaluating multithreading library"
DESCRIPTION="Lua Lanes is a Lua extension library providing \
the possibility to run multiple Lua states in parallel. It is \
intended to be used for optimizing performance on multicore CPU's \
and to study ways to make Lua programs naturally parallel to begin with."
HOMEPAGE="http://lualanes.github.io/lanes/"
COPYRIGHT="2007-17 Asko Kauppi
	Benoit Germain"
LICENSE="MIT"
REVISION="1"
SOURCE_URI="https://github.com/LuaLanes/lanes/archive/v$portVersion.tar.gz"
CHECKSUM_SHA256="0a82fadeed96099b7bf90da92ece3862507a5e41a23778a7456b8adaf36e9180"
PATCHES="lanes-$portVersion.patchset"

ARCHITECTURES="?x86_gcc2 ?x86 ?x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	lanes$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:liblua$secondaryArchSuffix >= 5.3
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:liblua$secondaryArchSuffix >= 5.3
	"
BUILD_PREREQUIRES="
	cmd:lua5.3$secondaryArchSuffix
	cmd:make
	cmd:gcc$secondaryArchSuffix
	cmd:pkg_config$secondaryArchSuffix
	cmd:which
	"

BUILD()
{
	make LUA_LIBDIR=$libDir/lua/5.3 \
	LUA_SHAREDIR=$dataDir/lua/5.3
}

INSTALL()
{
	make install LUA_LIBDIR=$libDir/lua/5.3 \
	LUA_SHAREDIR=$dataDir/lua/5.3
}

TEST()
{
	make test
}
