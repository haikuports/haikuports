From 85e54bd1374d75575866f7e4a14f34b0c4a4199a Mon Sep 17 00:00:00 2001
From: Yourself <user@shredder.fritz.box>
Date: Thu, 19 Sep 2024 22:51:45 +0200
Subject: Fixes to compile cleanly on Haiku / newer SDL Mixer 2


diff --git a/configure.ac b/configure.ac
index e08e6ee..c8c9b17 100644
--- a/configure.ac
+++ b/configure.ac
@@ -18,6 +18,8 @@ fi
 
 AC_SUBST(dunelegacydatadir)
 
+AC_SEARCH_LIBS(gethostbyname, [socket, network])
+
 dnl Some flags for gcc
 CXXFLAGS="-std=c++11 -pthread -fPIC -O3 -pipe -pedantic -Wall -Wextra -Wno-unused-parameter -Wno-shift-negative-value -DNDEBUG"
 CFLAGS="-std=c99 -pthread -fPIC -O3 -pipe -pedantic -Wall -Wextra -Wno-unused-parameter -Wno-shift-negative-value -DNDEBUG"
diff --git a/src/FileClasses/music/DirectoryPlayer.cpp b/src/FileClasses/music/DirectoryPlayer.cpp
index 12b8208..5fcbb62 100644
--- a/src/FileClasses/music/DirectoryPlayer.cpp
+++ b/src/FileClasses/music/DirectoryPlayer.cpp
@@ -61,7 +61,7 @@ DirectoryPlayer::DirectoryPlayer() : MusicPlayer(settings.audio.playMusic, setti
 
     music = nullptr;
 
-    Mix_Init(MIX_INIT_FLUIDSYNTH | MIX_INIT_FLAC | MIX_INIT_MP3 | MIX_INIT_OGG);
+    Mix_Init(MIX_INIT_MID | MIX_INIT_FLAC | MIX_INIT_MP3 | MIX_INIT_OGG);
 }
 
 DirectoryPlayer::~DirectoryPlayer() {
diff --git a/src/FileClasses/music/XMIPlayer.cpp b/src/FileClasses/music/XMIPlayer.cpp
index b70def5..9b67e39 100644
--- a/src/FileClasses/music/XMIPlayer.cpp
+++ b/src/FileClasses/music/XMIPlayer.cpp
@@ -32,7 +32,7 @@
 XMIPlayer::XMIPlayer() : MusicPlayer(settings.audio.playMusic, settings.audio.musicVolume) {
     music = nullptr;
 
-    if((Mix_Init(MIX_INIT_FLUIDSYNTH) & MIX_INIT_FLUIDSYNTH) == 0) {
+    if((Mix_Init(MIX_INIT_MID) & MIX_INIT_MID) == 0) {
         SDL_Log("XMIPlayer: Failed to init required midi support: %s", SDL_GetError());
     }
 }
-- 
2.45.2

