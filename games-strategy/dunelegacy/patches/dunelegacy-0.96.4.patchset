From 9591cec42d147084ebd3f768f07d14c0bcc7faa8 Mon Sep 17 00:00:00 2001
From: Yourself <user@shredder.fritz.box>
Date: Sun, 22 Sep 2024 17:36:08 +0200
Subject: Fix to autoconf, obsolete SDL2mixer variables, partial fix to game
 screen flicker issue (Mentat screen affected)


diff --git a/configure.ac b/configure.ac
index e08e6ee..c8c9b17 100644
--- a/configure.ac
+++ b/configure.ac
@@ -18,6 +18,8 @@ fi
 
 AC_SUBST(dunelegacydatadir)
 
+AC_SEARCH_LIBS(gethostbyname, [socket, network])
+
 dnl Some flags for gcc
 CXXFLAGS="-std=c++11 -pthread -fPIC -O3 -pipe -pedantic -Wall -Wextra -Wno-unused-parameter -Wno-shift-negative-value -DNDEBUG"
 CFLAGS="-std=c99 -pthread -fPIC -O3 -pipe -pedantic -Wall -Wextra -Wno-unused-parameter -Wno-shift-negative-value -DNDEBUG"
diff --git a/src/FileClasses/music/DirectoryPlayer.cpp b/src/FileClasses/music/DirectoryPlayer.cpp
index 12b8208..5fcbb62 100644
--- a/src/FileClasses/music/DirectoryPlayer.cpp
+++ b/src/FileClasses/music/DirectoryPlayer.cpp
@@ -61,7 +61,7 @@ DirectoryPlayer::DirectoryPlayer() : MusicPlayer(settings.audio.playMusic, setti
 
     music = nullptr;
 
-    Mix_Init(MIX_INIT_FLUIDSYNTH | MIX_INIT_FLAC | MIX_INIT_MP3 | MIX_INIT_OGG);
+    Mix_Init(MIX_INIT_MID | MIX_INIT_FLAC | MIX_INIT_MP3 | MIX_INIT_OGG);
 }
 
 DirectoryPlayer::~DirectoryPlayer() {
diff --git a/src/FileClasses/music/XMIPlayer.cpp b/src/FileClasses/music/XMIPlayer.cpp
index b70def5..9b67e39 100644
--- a/src/FileClasses/music/XMIPlayer.cpp
+++ b/src/FileClasses/music/XMIPlayer.cpp
@@ -32,7 +32,7 @@
 XMIPlayer::XMIPlayer() : MusicPlayer(settings.audio.playMusic, settings.audio.musicVolume) {
     music = nullptr;
 
-    if((Mix_Init(MIX_INIT_FLUIDSYNTH) & MIX_INIT_FLUIDSYNTH) == 0) {
+    if((Mix_Init(MIX_INIT_MID) & MIX_INIT_MID) == 0) {
         SDL_Log("XMIPlayer: Failed to init required midi support: %s", SDL_GetError());
     }
 }
diff --git a/src/Game.cpp b/src/Game.cpp
index 98279c7..0283119 100644
--- a/src/Game.cpp
+++ b/src/Game.cpp
@@ -1155,7 +1155,7 @@ void Game::runMainLoop() {
 
         drawScreen();
 
-        SDL_RenderPresent(renderer);
+        //SDL_RenderPresent(renderer);
 
         SDL_SetRenderTarget(renderer, nullptr);
         SDL_SetRenderDrawColor(renderer, 0, 0, 0, 255);
-- 
2.45.2

