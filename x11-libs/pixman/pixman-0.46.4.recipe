SUMMARY="A pixel-manipulation library for X and cairo"
DESCRIPTION="Pixman is a low-level software library for pixel manipulation, \
providing features such as image compositing and trapezoid rasterization. \
Important users of pixman are the cairo graphics library and the X server."
HOMEPAGE="https://cgit.freedesktop.org/pixman/"
COPYRIGHT="1994-2025 Free Software Foundation, Inc.
	1987, 1988, 1989, 1998  The Open Group
	1987, 1988, 1989 Digital Equipment Corporation
	1999, 2004, 2008 Keith Packard
	2000 SuSE, Inc.
	2000 Keith Packard, member of The XFree86 Project, Inc.
	2004, 2005, 2007, 2008, 2009, 2010 Red Hat, Inc.
	2004 Nicholas Miell
	2005 Lars Knoll & Zack Rusin, Trolltech
	2005 Trolltech AS
	2007 Luca Barbato
	2008 Aaron Plattner, NVIDIA Corporation
	2008 Rodrigo Kumpera
	2008 André Tupinambá
	2008 Mozilla Corporation
	2008 Frederic Plourde
	2009, Oracle and/or its affiliates. All rights reserved.
	2009, 2010 Nokia Corporatio
	and many others"
LICENSE="MIT"
REVISION="1"
SOURCE_URI="https://cairographics.org/releases/pixman-$portVersion.tar.gz"
CHECKSUM_SHA256="d09c44ebc3bd5bee7021c79f922fe8fb2fb57f7320f55e97ff9914d2346a591c"

ARCHITECTURES="all ?x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

libVersion="0.46.4"
libVersionCompat="$libVersion compat >= ${libVersion%%.*}"

PROVIDES="
	pixman$secondaryArchSuffix = $portVersion
	lib:libpixman_1$secondaryArchSuffix = $libVersionCompat
	"
REQUIRES="
	haiku$secondaryArchSuffix
	"

PROVIDES_devel="
	pixman${secondaryArchSuffix}_devel = $portVersion
	devel:libpixman_1$secondaryArchSuffix  = $libVersionCompat
	"
REQUIRES_devel="
	pixman$secondaryArchSuffix == $portVersion base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:libtoolize
	cmd:meson
	cmd:perl
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	meson build \
		--buildtype=release \
		--prefix="$prefix" \
		--bindir="$binDir" \
		--libdir="$libDir" \
		--includedir="$includeDir" \
		--datadir="$dataDir" \
		--mandir="$manDir"

	ninja -C build
}

INSTALL()
{
	ninja -C build install

	prepareInstalledDevelLibs libpixman-1
	fixPkgconfig

	packageEntries devel \
		$developDir
}

TEST()
{
	ninja -C build test
}
