SUMMARY="A free, open-source version of classic Jazz Jackrabbit games"
DESCRIPTION="A free, open-source version of classic Jazz Jackrabbit games.\
Requires the original game data to work.\
Please put the data into the folder:\
/boot/home/config/non-packaged/data/openjazz
"
HOMEPAGE="https://github.com/AlisterT/openjazz"
COPYRIGHT="Alister Thomson"
LICENSE="GNU GPL v2"
REVISION="1"
COMMIT="0f59db3a6b0e2c076b39917dc65cfb3562611ee6"
SOURCE_URI="https://github.com/AlisterT/openjazz/archive/$COMMIT.tar.gz"
CHECKSUM_SHA256="55c82328ef3f0185951bd339be55411410d1fa786f391091e15b7a093a08fafd"
SOURCE_DIR="openjazz-$COMMIT"
ADDITIONAL_FILES="openjazz.rdef"
PATCHES="datadirs.patch"

ARCHITECTURES="?x86_gcc2 ?x86 x86_64 ?ppc ?arm"

PROVIDES="
	cmd:openjazz = $portVersion
	"
REQUIRES="
	haiku
	libsdl
	libmodplug
	zlib
    "

BUILD_REQUIRES="
    haiku_devel
	libsdl_devel
	libmodplug_devel
	zlib_devel
    "
BUILD_PREREQUIRES="
	cmd:gcc
	cmd:make
	cmd:pkg_config
	"

BUILD()
{
	export LDFLAGS="-lnetwork"
	export CXXFLAGS="-D_BSD_SOURCE"
	export DATAPATH="~/config/non-packaged/Data/openjazz"
	make $jobArgs
}

INSTALL()
{
	mkdir -p $appsDir
	cp OpenJazz $appsDir/
	mkdir -p $dataDir/openjazz/
	cp openjazz.000 $dataDir/openjazz/
	addResourcesToBinaries $portDir/additional-files/openjazz.rdef $appsDir/OpenJazz
	addAppDeskbarSymlink $appsDir/OpenJazz
}

