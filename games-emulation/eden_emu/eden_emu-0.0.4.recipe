SUMMARY="Emulator of Nintendo Switch System"
DESCRIPTION="Eden emulator is a portable NX emulator"
HOMEPAGE="https://eden-emu.dev"
COPYRIGHT="2025 Eden Contributors"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://git.eden-emu.dev/eden-emu/eden/archive/v0.0.4-rc1.tar.gz"
CHECKSUM_SHA256="081358e1730ae70626465970be82d58cb3afb21b450b194eccc90ea28fe1afdc"
SOURCE_DIR="eden"
# No patches, upstream promised to keep-up
PATCHES=""

ARCHITECTURES="x86_64"

PROVIDES="
	eden_emu = $portVersion
	app:eden = $portVersion
	"
REQUIRES="
	haiku
	boost1.89
	lib:libavcodec
	lib:libavformat
	lib:libavutil
	lib:libenet
	lib:libfmt
	lib:libGL
	lib:liblz4
	lib:libopus
	lib:libQt6Core
	lib:libQt6Core5Compat
	lib:libQt6DBus
	lib:libQt6Widgets
	lib:libquazip1_qt6
	lib:libSDL2_2.0
	lib:libssl
	lib:libswresample
	lib:libswscale
	lib:libusb_1.0
	lib:libvulkan
	lib:libzstd
	lib:nlohmann_json
	lib:zydis
	"

BUILD_REQUIRES="
	haiku_devel
	ffmpeg7_devel
	boost1.89_devel
	devel:libenet$secondaryArchSuffix
	devel:libfmt$secondaryArchSuffix >= 11
	devel:libGL
	devel:liblz4
	devel:libopus
	devel:libQt6Core
	devel:libQt6Core5Compat
	devel:libQt6DBus
	devel:libQt6Widgets
	devel:libquazip1_qt6
	devel:libSDL2_2.0
	devel:libssl
	devel:libusb_1.0
	devel:libvulkan
	devel:libzstd
	devel:libzycore
	devel:libzydis
	devel:nlohmann_json
	"

BUILD_PREREQUIRES="
	cmd:cmake
	cmd:gcc
	cmd:ld
	cmd:ninja
	cmd:pkg_config
	cmd:patch
	cmd:glslangValidator
	"

BUILD()
{
	cmake -Bbuild -GNinja -S . \
		-DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=$appsDir/eden/ \
		-DCMAKE_INSTALL_BINDIR=$appsDir/eden/ \
		-DENABLE_SDL2=OFF \
		-DBUILD_TESTING=OFF \
		-DYUZU_TESTS=OFF \
		-DDYNARMIC_TESTS=OFF \
		-DYUZU_USE_CPM=ON \
		-Dmbedtls_FORCE_BUNDLED=ON \
		-DENABLE_CUBEB=OFF \
		-DENABLE_QT_UPDATE_CHECKER=OFF
	cmake --build build -t yuzu $jobArgs
}

INSTALL()
{
	cmake --install build -t yuzu
}
