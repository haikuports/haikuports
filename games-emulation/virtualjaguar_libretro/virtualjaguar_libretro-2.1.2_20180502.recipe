SUMMARY="A port of Virtual Jaguar, an Atari Jaguar emulator to the libretro API"
DESCRIPTION="Virtual Jaguar is an Atari Jaguar emulator originally written by \
David Raingeard, based off CoJag sources by Aaron Giles of MAME fame. The \
Atari Jaguar was a the first 64-bit console on the market but never was able \
to compete commercially with the Sony PlayStation and the Sega Saturn. This is \
the libretro port of Virtual Jaguar."
HOMEPAGE="https://icculus.org/virtualjaguar/"
COPYRIGHT="2003-2018 Cal2, the Virtual Jaguar SDL team, the libretro team"
LICENSE="GNU GPL v3"
REVISION="1"
srcGitRev="2ce1ec0a5f3e8d357795a3b5cfeffc8d91cdd52a"
SOURCE_URI="https://github.com/libretro/virtualjaguar-libretro/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="76d2f869f129de249cd8b89054f0c4e2d6c1c2a7bff7bf3691bfce317fa6b921"
SOURCE_FILENAME="libretro-virtualjaguar-${portVersion/_/-}-$srcGitRev.tar.gz"
SOURCE_DIR="virtualjaguar-libretro-$srcGitRev"
ADDITIONAL_FILES="virtualjaguar_libretro.info.in"

ARCHITECTURES="!x86_gcc2 ?x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	virtualjaguar_libretro$secondaryArchSuffix = $portVersion
	addon:virtualjaguar_libretro$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	retroarch$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:gcc$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	sed -e "s/@DISPLAY_VERSION@/v${portVersion/_/-}/" \
		$portDir/additional-files/virtualjaguar_libretro.info.in \
		> virtualjaguar_libretro.info
	make $jobArgs
}

INSTALL()
{
	install -m 0755 -d "$docDir"
	install -m 0644 -t "$docDir" README.md
	install -m 0755 -d "$addOnsDir"/libretro
	install -m 0644 -t "$addOnsDir"/libretro \
		virtualjaguar_libretro.info \
		virtualjaguar_libretro.so
}
