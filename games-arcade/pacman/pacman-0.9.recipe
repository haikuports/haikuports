SUMMARY="Clone of the original Pac-Man game by Namco"
DESCRIPTION="Clone of maze arcade game Pac-Man by Namco.\
The player controls the character through an enclosed maze.\
The objective is to eat all of the dots placed in the maze while \
avoiding ghosts. One of the main goals of this clone is a \
SDL Application with very little use of CPU power."
HOMEPAGE="https://github.com/ebuc99/pacman"
COPYRIGHT="Martin Prussak
		   Daniel WÃ¼rfel"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="https://github.com/ebuc99/pacman/archive/v$portVersion.zip"
CHECKSUM_SHA256="125ca7d344abac218798e792c029335e59cd3ba80502c50d81bae479ca4b2bdc"
PATCHES="pacman-$portVersion.patchset"
ADDITIONAL_FILES="pacman.rdef"

ARCHITECTURES="!x86_gcc2 ?x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	pacman$secondaryArchSuffix = $portVersion
	app:pacman$secondaryArchSuffix = $portVersion
	"

REQUIRES="
	haiku$secondaryArchSuffix
	lib:libsdl2_2.0$secondaryArchSuffix
	lib:libsdl2_image_2.0$secondaryArchSuffix
	lib:libsdl2_mixer_2.0$secondaryArchSuffix
	lib:libsdl2_ttf$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libsdl2_2.0$secondaryArchSuffix
	devel:libsdl2_image_2.0$secondaryArchSuffix
	devel:libsdl2_mixer_2.0$secondaryArchSuffix
	devel:libsdl2_ttf$secondaryArchSuffix
	"

BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:sed
	"


BUILD()
{
	sed -i 's/$(UPDATE_DESKTOP)//' Makefile.am
	chmod +x autogen.sh
	chmod +x configure
	./autogen.sh
	runConfigure --omit-dirs binDir ./configure --bindir=$appsDir
	make $jobArgs
}

INSTALL()
{
	make install

	rm -rf "$dataDir"/applications
	rm -f "$dataDir"/pacman/fonts/Makefile*
	addResourcesToBinaries $portDir/additional-files/pacman.rdef $appsDir/pacman
	addAppDeskbarSymlink $appsDir/pacman
}
