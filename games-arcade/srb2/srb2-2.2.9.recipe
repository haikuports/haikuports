SUMMARY="3D Sonic the Hedgehog fangame based on a modified version of Doom Legacy"
DESCRIPTION="Sonic Robo Blast 2 is a 3D open-source Sonic the Hedgehog fangame\
 built using a modified version of the Doom Legacy port of Doom. SRB2 is \
closely inspired by the original Sonic games from the Sega Genesis, and \
attempts to recreate the design in 3D. It features tons of levels, enemies, \
speed, and quite a lot of the fun that the original Sonic games provided."
HOMEPAGE="https://www.srb2.org/"
COPYRIGHT="1998-2021 Sonic Team Junior"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="https://git.do.srb2.org/STJr/SRB2/-/archive/SRB2_release_${portVersion}/SRB2-SRB2_release_${portVersion}.tar.gz"
CHECKSUM_SHA256="5f7eeb08e90323e28cdcb02ad25c904eef25ce75316720609b995a1e4ffd154a"
SOURCE_DIR="SRB2-SRB2_release_$portVersion"

ARCHITECTURES="all !x86_gcc2 x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	srb2$secondaryArchSuffix = $portVersion
	app:srb2 = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libexecinfo$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libopenmpt$secondaryArchSuffix
	lib:libpng$secondaryArchSuffix
	lib:libSDL2_2.0$secondaryArchSuffix
	lib:libSDL2_mixer_2.0$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libexecinfo$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libopenmpt$secondaryArchSuffix
	devel:libpng$secondaryArchSuffix
	devel:libSDL2_2.0$secondaryArchSuffix
	devel:libSDL2_mixer_2.0$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:git
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config
	"

BUILD()
{
	cd src
	make HAIKU=1 $jobArgs
}

INSTALL()
{
	mkdir -p $appsDir/srb2
	cp bin/SDL/lsdlsrb2 $appsDir/srb2

	addAppDeskbarSymlink $appsDir/srb2/lsdlsrb2 "Sonic Robo Blast 2"
}
