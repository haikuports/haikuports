From 5d7fe1ede47e9f2f49c2b161050b13762e7dd447 Mon Sep 17 00:00:00 2001
From: mazbrili <mazbrili@yahoo.com>
Date: Sat, 20 Oct 2018 18:56:36 +0700
Subject: apply change


diff --git a/bookinfo.cpp b/bookinfo.cpp
old mode 100644
new mode 100755
index f75bcaa..1c69276
--- a/bookinfo.cpp
+++ b/bookinfo.cpp
@@ -20,7 +20,7 @@
  */
 #include "bookinfo.h"
 #if QT_VERSION >= 0x050000
-#include <poppler-qt5.h>
+#include <poppler/qt5/poppler-qt5.h>
 #else
 #include <poppler-qt4.h>
 #endif
diff --git a/bookinfo.h b/bookinfo.h
old mode 100644
new mode 100755
index 445a9a7..0dc6f75
--- a/bookinfo.h
+++ b/bookinfo.h
@@ -23,7 +23,7 @@
 #define BOOKINFO_H
 #include <QString>
 #if QT_VERSION >= 0x050000
-#include <poppler-qt5.h>
+#include <poppler/qt5/poppler-qt5.h>
 #else
 #include <poppler-qt4.h>
 #endif
diff --git a/booksorganizer.pro b/booksorganizer.pro
old mode 100644
new mode 100755
index 2162d85..6cf9cb0
--- a/booksorganizer.pro
+++ b/booksorganizer.pro
@@ -27,7 +27,10 @@ win32{
     LIBS         += -L poppler-win\bin -lpoppler-qt5
     RC_FILE = myapp.rc
 #    QT +=winextras
-}else{
+}
+haiku{
+	LIBS += -lpoppler -lpoppler-qt5
+	}else{
 
         equals(QT_MAJOR_VERSION, 5) {
           INCLUDEPATH  += /usr/include/poppler/qt5
diff --git a/documentview.h b/documentview.h
old mode 100644
new mode 100755
index dd911c0..7e68d96
--- a/documentview.h
+++ b/documentview.h
@@ -33,7 +33,8 @@ along with qpdfview.  If not, see <http://www.gnu.org/licenses/>.
 
 #include <QtWidgets>
 #include <QtPrintSupport>
-#include <poppler-qt5.h>
+#include <poppler/qt5/poppler-qt5.h>
+
 
 #else
 #include <poppler-qt4.h>
diff --git a/pageitem.h b/pageitem.h
old mode 100644
new mode 100755
index 3606696..f969b8e
--- a/pageitem.h
+++ b/pageitem.h
@@ -26,8 +26,7 @@ along with qpdfview.  If not, see <http://www.gnu.org/licenses/>.
 #include <QtGui>
 
 #if QT_VERSION >= QT_VERSION_CHECK(5,0,0)
-#include <poppler-qt5.h>
-
+#include <poppler/qt5/poppler-qt5.h>
 #include <QtWidgets>
 #include <QtConcurrent>
 #else
diff --git a/searchthread.h b/searchthread.h
old mode 100644
new mode 100755
index 5e36df5..9028025
--- a/searchthread.h
+++ b/searchthread.h
@@ -31,7 +31,7 @@ along with qpdfview.  If not, see <http://www.gnu.org/licenses/>.
 #include <QStandardItemModel>
 
 #if QT_VERSION >= QT_VERSION_CHECK(5,0,0)
-#include <poppler-qt5.h>
+#include <poppler/qt5/poppler-qt5.h>
 #else
 #include <poppler-qt4.h>
 #endif // QT_VERSION
diff --git a/searchtools.cpp b/searchtools.cpp
old mode 100644
new mode 100755
index 3bf60ca..c64a4a4
--- a/searchtools.cpp
+++ b/searchtools.cpp
@@ -24,6 +24,7 @@
 #include "eicon.h"
 #include <QtGui>
 #include <QSettings>
+#include <QAction>
 
 SearchTools::SearchTools(bool isPdf, QWidget *parent) :
     QWidget(parent),
-- 
2.19.0


From d3bd693f2486c105a008a422ace83189ccfb1e16 Mon Sep 17 00:00:00 2001
From: mazbrili <mazbrili@yahoo.com>
Date: Sun, 21 Oct 2018 06:29:07 +0700
Subject: path fix for haiku


diff --git a/bookinfo.cpp b/bookinfo.cpp
index 1c69276..bfac9c1 100755
--- a/bookinfo.cpp
+++ b/bookinfo.cpp
@@ -36,9 +36,16 @@ BookInfo::BookInfo()
 {
 
 QSettings settings;
-
+#if not defined(Q_OS_HAIKU)
 QString appdir=(settings.value("BooksPath",
                                              QDir::homePath()+"/."+QApplication::applicationName()).toString());
+#elif defined(Q_OS_HAIKU)
+QString appdir=(settings.value("BooksPath",
+											QDir::home().absolutePath() + QDir::separator() + 
+        									"config" + QDir::separator() + "settings" + QDir::separator() +
+         									QApplication::applicationName()).toString());
+											
+#endif
 mThumbnails=appdir+"/thumbnails/";
 
 }
diff --git a/booksorganizer.pro b/booksorganizer.pro
index 6cf9cb0..7ed3e97 100755
--- a/booksorganizer.pro
+++ b/booksorganizer.pro
@@ -29,6 +29,7 @@ win32{
 #    QT +=winextras
 }
 haiku{
+	TARGET = BooksOrg
 	LIBS += -lpoppler -lpoppler-qt5
 	}else{
 
diff --git a/main.cpp b/main.cpp
index e45955e..f19d285 100644
--- a/main.cpp
+++ b/main.cpp
@@ -57,9 +57,14 @@ int main(int argc, char *argv[])
     qRegisterMetaType< QList< QRectF > >("QList<QRectF>");
 
     QApplication a(argc, argv);
+    
+#if defined(Q_OS_WIN32)
     a.setApplicationName("booksorg");
+#elseif defined(Q_OS_HAIKU)
+	a.setApplicationName("BooksOrg");
+#endif
     a.setOrganizationName("elokab");
-     a.setApplicationVersion("0.3");
+    a.setApplicationVersion("0.3");
     a.setWindowIcon(QIcon(":/icons/booksorg"));
 
 
@@ -93,12 +98,20 @@ int main(int argc, char *argv[])
     a.setApplicationDisplayName(QObject::tr("Books Organizer"));
 #endif
 
-#ifdef Q_OS_WIN32
+#if defined(Q_OS_WIN32)
     associateFileTypes(QStringList(".pdf"));
-#endif
-
     QDir dir;
     dir.mkpath(QDir::homePath()+"/."+a.applicationName()+"/thumbnails");
+#elif defined(Q_OS_HAIKU)
+       QDir dir(QDir::home().absolutePath() + QDir::separator() + 
+        "config" + QDir::separator() + "settings");
+         dir.mkdir(a.applicationName());
+   	 dir.mkpath(QDir::home().absolutePath() + QDir::separator() + 
+        "config" + QDir::separator() + "settings" + QDir::separator() +
+         a.applicationName()+QDir::separator()+"thumbnails");
+#endif
+
+  
 
     MainWindow w;
     w.show();
diff --git a/mainwindow.cpp b/mainwindow.cpp
index d1f46a0..34384dd 100644
--- a/mainwindow.cpp
+++ b/mainwindow.cpp
@@ -67,10 +67,15 @@ QSettings settings;
     //---------------------------------------------
 
 
-
+#if defined(Q_OS_HAIKU)
+   Path::setWorkingDir(settings.value("BooksPath",
+                           QDir::home().absolutePath() + QDir::separator() + 
+        "config" + QDir::separator() + "settings" + QDir::separator() +
+         QApplication::applicationName()).toString());
+#elif
    Path::setWorkingDir(settings.value("BooksPath",
                              QDir::homePath()+"/."+QApplication::applicationName()).toString());
-
+#endif
    Path::setCopyBooks(settings.value("CopyBooks",false).toBool());
 
 
diff --git a/path.cpp b/path.cpp
index 069e2be..0614a0e 100644
--- a/path.cpp
+++ b/path.cpp
@@ -1,3 +1,9 @@
 #include "path.h"
+#if defined(Q_OS_HAIKU)
+QString Path::mWorkingDir=(QDir::home().absolutePath() + QDir::separator() + 
+        "config" + QDir::separator() + "settings" + QDir::separator() +
+         QApplication::applicationName());
+#elif
 QString Path::mWorkingDir= QDir::homePath()+"/."+QApplication::applicationName();
+#endif
 bool Path::mCopy=false;
-- 
2.19.0

