From e539d5d7786cbc5d98322271a7d7e1853dc55814 Mon Sep 17 00:00:00 2001
From: Mazbrili <mazbrili@yahoo.com>
Date: Sat, 8 Feb 2020 10:44:28 +0700
Subject: patch for haiku path requirement..


diff --git a/database.cpp b/database.cpp
index a8f50da..ddca0ed 100644
--- a/database.cpp
+++ b/database.cpp
@@ -54,6 +54,8 @@ Database::Database()
 
     appDir.cdUp();
     appPath=  appDir.absolutePath()+"/share/elforkane";
+#elif defined(Q_OS_HAIKU)
+    appPath=  appDir.absolutePath()+"/lib";
 #elif defined(Q_OS_MAC)
     if (appDir.dirName() == "MacOS") {
         appDir.cdUp();
diff --git a/fs-wallpapers/fullscreen.cpp b/fs-wallpapers/fullscreen.cpp
index f135ed4..fbb1731 100644
--- a/fs-wallpapers/fullscreen.cpp
+++ b/fs-wallpapers/fullscreen.cpp
@@ -20,6 +20,8 @@ SceenFull::SceenFull(int w, int h):m_Width(w),m_Height(h)
     //  if (appDir.dirName().toLower() == "debug" || appDir.dirName().toLower() == "release")
     appDir.cdUp();
     appPath=  appDir.absolutePath()+"/share/elforkane";
+ #elif defined(Q_OS_HAIKU)
+    appPath=  appDir.absolutePath()+"/lib" ;
 #elif defined(Q_OS_MAC)
     if (appDir.dirName() == "MacOS") {
         appDir.cdUp();
diff --git a/main.cpp b/main.cpp
index f30f038..fb68394 100644
--- a/main.cpp
+++ b/main.cpp
@@ -70,6 +70,8 @@ int main(int argc, char *argv[])
 #if defined(Q_OS_WIN)
     appDir.cdUp();
        appPath=  appDir.absolutePath()+"/share/elforkane";
+ #elif defined(Q_OS_HAIKU)
+    appPath=  appDir.absolutePath()+"/lib"  ;    
 #elif defined(Q_OS_MAC)
     if (appDir.dirName() == "MacOS") {
         appDir.cdUp();
diff --git a/mainwindow.cpp b/mainwindow.cpp
index 9d93cfa..313724c 100644
--- a/mainwindow.cpp
+++ b/mainwindow.cpp
@@ -57,6 +57,8 @@ MainWindow::MainWindow(QWidget *parent) :
 #if defined(Q_OS_WIN)
     appDir.cdUp();
     m_appPath=  appDir.absolutePath()+"/share/elforkane";
+#elif defined(Q_OS_HAIKU)
+    m_appPath=  appDir.absolutePath()+"/lib";
 #elif defined(Q_OS_MAC)
     if (appDir.dirName() == "MacOS") {
         appDir.cdUp();
-- 
2.24.0


From 105fa61987862795f54f4aab30bf4c35362b30a2 Mon Sep 17 00:00:00 2001
From: Mazbrili <mazbrili@yahoo.com>
Date: Tue, 10 Mar 2020 10:52:55 +0700
Subject: patch for close application


diff --git a/mainwindow.cpp b/mainwindow.cpp
index 313724c..90a0259 100644
--- a/mainwindow.cpp
+++ b/mainwindow.cpp
@@ -2381,6 +2381,7 @@ void MainWindow::on_actionQuit_triggered()
         trayIcon->hide();
 
     this->close();
+    qApp->quit();
 }
 
 void MainWindow::on_actionStopMedia_triggered()
-- 
2.24.0


From 3968dfbeabe111fc9d835b9caca3367382b0bdb3 Mon Sep 17 00:00:00 2001
From: mazbrili <mazbrili@yahoo.com>
Date: Sat, 2 May 2020 11:28:55 +0700
Subject: Revert "patch for close application"

This reverts commit 105fa61987862795f54f4aab30bf4c35362b30a2.

diff --git a/mainwindow.cpp b/mainwindow.cpp
index 90a0259..313724c 100644
--- a/mainwindow.cpp
+++ b/mainwindow.cpp
@@ -2381,7 +2381,6 @@ void MainWindow::on_actionQuit_triggered()
         trayIcon->hide();
 
     this->close();
-    qApp->quit();
 }
 
 void MainWindow::on_actionStopMedia_triggered()
-- 
2.24.0


From 6cd6c033e40bc606f5b0f4a0c137fb15689ad39d Mon Sep 17 00:00:00 2001
From: mazbrili <mazbrili@yahoo.com>
Date: Sat, 2 May 2020 11:30:02 +0700
Subject: ugly fix for closing app


diff --git a/main.cpp b/main.cpp
index fb68394..a137d86 100644
--- a/main.cpp
+++ b/main.cpp
@@ -32,7 +32,11 @@
 #include <QSettings>
 #include <QTranslator>
 #include <QLibraryInfo>
-
+#ifdef __HAIKU__
+#include <unistd.h>
+#include <sys/types.h>
+#include <signal.h>
+#endif
 
 static void associateFileTypes()
 {
@@ -212,6 +216,11 @@ int main(int argc, char *argv[])
 
     MainWindow w;
     w.show();
-
+ #ifdef __HAIKU__
+	a.exec();
+	kill(::getpid(),SIGKILL);
+	return 0;
+#elif
     return a.exec();
+#endif
 }
-- 
2.24.0

