SUMMARY="A library to help create robust multi-platform software"
DESCRIPTION="S-Lang is a multi-platform library designed to allow a developer \
to create robust multi-platform software. It provides facilities required by \
interactive applications such as display/screen management, keyboard input, \
keymaps, and so on.
The most exciting feature of the library is the slang interpreter that may \
be easily embedded into a program to make it extensible.

While the emphasis has always been on the embedded nature of the interpreter, \
it may also be used in a stand-alone fashion through the use of slsh, which is \
part of the S-Lang distribution."
HOMEPAGE="http://www.jedsoft.org/slang/"
COPYRIGHT="2004-2013 John E. Davis"
LICENSE="GNU GPL v2"
REVISION="2"
SOURCE_URI="ftp://space.mit.edu/pub/davis/slang/v2.2/slang-2.2.4.tar.bz2"
CHECKSUM_SHA256="9a8257a9a2a55099af858b13338dc8f3a06dd2069f46f0df2c9c3bb84a01d5db"
PATCHES="slang-${portVersion}.patchset"

ARCHITECTURES="x86_gcc2 x86"

GLOBAL_WRITABLE_FILES="
        settings/slsh.rc keep-old
	"

PROVIDES="
	slang = $portVersion compat >= 2.2
	cmd:slsh = $portVersion compat >= 2.2
	lib:libslang = $portVersion compat >= 2.2
	"
REQUIRES="
	haiku
	lib:libiconv
	lib:libncurses
	lib:libpcre
	lib:libpng16
	lib:libz
	"

PROVIDES_devel="
	slang_devel = $portVersion compat >= 2.2
	devel:libslang = $portVersion compat >= 2.2
	"
REQUIRES_devel="
	slang == $portVersion
	"

BUILD_REQUIRES="
	haiku_devel
	devel:libiconv
	devel:libncurses
	devel:libpcre
	devel:libpng16
	devel:libz
	"
BUILD_PREREQUIRES="
	cmd:autoconf
	cmd:gcc
	cmd:ld
	cmd:make
	"

BUILD()
{
	runConfigure ./configure \
	--with-pnglib=$libDir \
	--with-pnginc=$includeDir \
	--with-zlib=$libDir \
	--with-zinc=$includeDir \
	--with-iconvlib=$libDir \
	--with-iconvinc=$includeDir \
	--with-pcrelib=$libDir \
	--with-pcreinc=$includeDir
	#--with-oniglib=$libDir \
	#--with-oniginc=$includeDir

	make
}

INSTALL()
{
	make install

	fixPkgconfig

	prepareInstalledDevelLibs libslang

	packageEntries devel $developDir
}
