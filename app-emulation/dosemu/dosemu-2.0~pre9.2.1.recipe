SUMMARY="Emulator for running DOS programs under Haiku"
DESCRIPTION="Dosemu can run programs directly in the Terminal and allow you to capture standard \
input and output directly."
HOMEPAGE="https://dosemu2.github.io/dosemu2"
COPYRIGHT="2025 Stas Sergeev and other developers"
LICENSE="GNU GPL v2"
SOURCE_URI="https://github.com/dosemu2/dosemu2/archive/7931cc82262fa2b4c42a96d144893844e98a058c.tar.gz"
SOURCE_DIR="dosemu2-7931cc82262fa2b4c42a96d144893844e98a058c"
CHECKSUM_SHA256="0445c0eea9d430fafc153bd873b01b6e27cb8d92315befa245c4d6ab1dc872d4"
PATCHES="$portVersionedName.patchset"
REVISION="1"

ARCHITECTURES="all"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	dosemu$secondaryArchSuffix = $portVersion
	cmd:dosemu
	cmd:mkfatimage16
	lib:libdosemu2
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfdldr
	lib:libfdpp
	"

GLOBAL_WRITABLE_FILES="settings/dosemu/dosemu.conf auto-merge"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfdpp$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:bison
	cmd:flex
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config
	"

BUILD()
{
	./autogen.sh
	runConfigure ./default-configure --disable-searpc
	make $jobArgs OBJ_DIR=objects
}

INSTALL()
{
	make install
}
