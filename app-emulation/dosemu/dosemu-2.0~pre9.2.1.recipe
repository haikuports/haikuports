SUMMARY="Emulator for running DOS programs under Haiku"
DESCRIPTION="Dosemu can run programs directly in the Terminal and allow you to capture standard \
input and output directly."
HOMEPAGE="https://dosemu2.github.io/dosemu2"
COPYRIGHT="2025 Stas Sergeev and other developers"
LICENSE="GNU GPL v2"
SOURCE_URI="https://github.com/dosemu2/dosemu2/archive/d8650e1be27b0478854e5df9b16cb5641b1f864f.tar.gz"
SOURCE_DIR="dosemu2-d8650e1be27b0478854e5df9b16cb5641b1f864f"
CHECKSUM_SHA256="7aebc2b2985a3a2a8fd9b65ad83cc4deb3e3b5e4739fac36fd7ce4316aec9d88"
PATCHES="$portVersionedName.patchset"
REVISION="2"

ARCHITECTURES="all"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	dosemu$secondaryArchSuffix = $portVersion
	cmd:dosemu
	cmd:mkfatimage16
	lib:libdosemu2
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfdldr
	lib:libfdpp
	"

GLOBAL_WRITABLE_FILES="settings/dosemu/dosemu.conf auto-merge"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfdpp$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:bison
	cmd:flex
	cmd:gawk
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config
	"

BUILD()
{
	./autogen.sh
	runConfigure ./default-configure --disable-searpc
	make $jobArgs OBJ_DIR=objects
}

INSTALL()
{
	make install
}
