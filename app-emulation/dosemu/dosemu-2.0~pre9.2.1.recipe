SUMMARY="Emulator for running DOS programs under Haiku"
DESCRIPTION="Dosemu can run programs directly in the Terminal and allow you to capture standard \
input and output directly."
HOMEPAGE="https://dosemu2.github.io/dosemu2"
COPYRIGHT="2025 Stas Sergeev and other developers"
LICENSE="GNU GPL v2"
SOURCE_URI="https://github.com/dosemu2/dosemu2/archive/851953056a3b5efa1ebda72b712aec76c91dc0a5.tar.gz"
SOURCE_DIR="dosemu2-851953056a3b5efa1ebda72b712aec76c91dc0a5"
CHECKSUM_SHA256="78a48b0fc332f74ff9fbc07643d24a7370a237f8ecd776847771e82df82e5eb4"
PATCHES="$portVersionedName.patchset"
REVISION="5"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	dosemu$secondaryArchSuffix = $portVersion
	cmd:dosemu
	cmd:mkfatimage16
	lib:libdosemu2
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfdldr$secondaryArchSuffix
	lib:libfdpp$secondaryArchSuffix
	"

GLOBAL_WRITABLE_FILES="settings/dosemu/dosemu.conf auto-merge"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfdpp$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:bison
	cmd:flex
	cmd:gawk
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	./autogen.sh
	runConfigure ./default-configure --disable-searpc
	make $jobArgs OBJ_DIR=objects
}

INSTALL()
{
	make install
}
