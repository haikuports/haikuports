SUMMARY="Emulator for running DOS programs under Haiku"
DESCRIPTION="Dosemu can run programs directly in the Terminal and allow you to capture standard \
input and output directly."
HOMEPAGE="https://dosemu2.github.io/dosemu2"
COPYRIGHT="2025 Stas Sergeev and other developers"
LICENSE="GNU GPL v2"
SOURCE_URI="https://github.com/dosemu2/dosemu2/archive/af474d99c02dc29c9d799c4658bba3ffa0e22a79.tar.gz"
SOURCE_DIR="dosemu2-af474d99c02dc29c9d799c4658bba3ffa0e22a79"
CHECKSUM_SHA256="234d1ee5d53b8fec6ba721579990e050dc70766d469bd79ed4680bc07db784b1"
PATCHES="$portVersionedName.patchset"
REVISION="4"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	dosemu$secondaryArchSuffix = $portVersion
	cmd:dosemu
	cmd:mkfatimage16
	lib:libdosemu2
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfdldr$secondaryArchSuffix
	lib:libfdpp$secondaryArchSuffix
	"

GLOBAL_WRITABLE_FILES="settings/dosemu/dosemu.conf auto-merge"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfdpp$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:bison
	cmd:flex
	cmd:gawk
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	./autogen.sh
	runConfigure ./default-configure --disable-searpc
	make $jobArgs OBJ_DIR=objects
}

INSTALL()
{
	make install
}
