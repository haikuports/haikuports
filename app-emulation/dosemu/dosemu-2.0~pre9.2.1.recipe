SUMMARY="Emulator for running DOS programs under Haiku"
DESCRIPTION="Dosemu can run programs directly in the Terminal and allow you to capture standard \
input and output directly."
HOMEPAGE="https://dosemu2.github.io/dosemu2"
COPYRIGHT="2025 Stas Sergeev and other developers"
LICENSE="GNU GPL v2"
SOURCE_URI="https://github.com/dosemu2/dosemu2/archive/b438fc265b7add041f18d188ec9c724e0baf1fd1.tar.gz"
SOURCE_DIR="dosemu2-b438fc265b7add041f18d188ec9c724e0baf1fd1"
CHECKSUM_SHA256="23a1f9ebc138831ba946ea286705e5ce041cdd0d96d04e2328aba69a2aa9ecae"
PATCHES="$portVersionedName.patchset"
REVISION="3"

ARCHITECTURES="all"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	dosemu$secondaryArchSuffix = $portVersion
	cmd:dosemu
	cmd:mkfatimage16
	lib:libdosemu2
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfdldr
	lib:libfdpp
	"

GLOBAL_WRITABLE_FILES="settings/dosemu/dosemu.conf auto-merge"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfdpp$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:bison
	cmd:flex
	cmd:gawk
	cmd:gcc$secondaryArchSuffix
	cmd:make
	cmd:pkg_config
	"

BUILD()
{
	./autogen.sh
	runConfigure ./default-configure --disable-searpc
	make $jobArgs OBJ_DIR=objects
}

INSTALL()
{
	make install
}
