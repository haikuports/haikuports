SUMMARY="A free, open-source file pager"
DESCRIPTION="GNU 'less' is a program similar to 'more', but which allows \
backward movement in the file as well as forward movement. Also, 'less' \
does not have to read the entire input file before starting, so with \
large input files it starts up faster than text editors like 'vi'.
Less uses 'termcap' (or 'terminfo' on some systems), so it can run on a \
variety of terminals. There is even limited support for hardcopy terminals."
HOMEPAGE="http://www.greenwoodsoftware.com/less/"
COPYRIGHT="1984-2024 Mark Nudelman"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="http://github.com/gwsw/less/archive/refs/tags/v$portVersion.tar.gz"
CHECKSUM_SHA256="e96a30b246f1c08a7731189025969e473a3a9a01d7e91b671e86cd8577d8e40e"
PATCHES="less-$portVersion.patchset"
ADDITIONAL_FILES="sysless.in"

ARCHITECTURES="x86_64"

GLOBAL_WRITABLE_FILES="
	settings/etc/sysless.src keep-old
	settings/etc/sysless keep-old
	"

PROVIDES="
	less = $portVersion
	cmd:less
	cmd:lessecho
	cmd:lesskey
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libncurses$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libncurses$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:autoreconf
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	cmd:nroff
	"

BUILD()
{
	make -f Makefile.aut distfiles
	runConfigure ./configure --with-editor=nano \
		--sysconfdir="$settingsDir/etc"
	make
}

INSTALL()
{
	make install-strip

	syslessDir=$settingsDir/etc
	mkdir "$syslessDir"
	cp "$portDir/additional-files/sysless.in" \
		"$syslessDir/sysless.src"
	"$binDir"/lesskey -o "$syslessDir/sysless" \
		"$syslessDir/sysless.src"
}

TEST()
{
	make check
}
