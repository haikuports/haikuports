SUMMARY="A very light software real-time synthesizer"
DESCRIPTION="FluidLite is a very light version of FluidSynth \
designed to be hardware, platform and external dependency independant.
It only uses standard C libraries.

It also adds support for SF3 files (SF2 files compressed with ogg vorbis) \
and an additional setting to remove the constraint of channel 9 (drums): \
fluid_settings_setstr(settings, "synth.drums-channel.active", "no"); \
you can still select bank 128 on any channel to use drum kits.

FluidLite keeps very minimal functionnalities (settings and synth), \
therefore MIDI file reading, realtime MIDI events and audio output must be \
implemented externally."
HOMEPAGE="https://github.com/divideconcept/FluidLite"
COPYRIGHT="2007-2012 Josh Green, Pedro Lopez-Cabanillas, David Henningsson"
LICENSE="GNU LGPL v2.1"
REVISION="1"
srcGitRev="e64b4b3161cab212fffe7d1d3fb1c05750c363cc"
SOURCE_URI="$HOMEPAGE/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="b6c4bff689bfd2b8e57b771640da019ee6cf3580a96ddced3954f9f84b66410f"
SOURCE_DIR="FluidLite-$srcGitRev"

ARCHITECTURES="all"
SECONDARY_ARCHITECTURES="x86_gcc2 x86"

PROVIDES="
	fluidlite${secondaryArchSuffix} = $portVersion
	"
REQUIRES="
	haiku${secondaryArchSuffix}
	"

PROVIDES_devel="
	fluidlite${secondaryArchSuffix}_devel = $portVersion
	devel:libfluidlite$secondaryArchSuffix = $portVersion compat >= 1
	"
REQUIRES_devel="
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libogg$secondaryArchSuffix
	devel:libvorbis$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX:PATH=$prefix .
	make $jobArgs
}

INSTALL()
{
	make install

	mv $prefix/lib $prefix/lib2
	mkdir -p $(dirname $includeDir) $(dirname $libDir)
	mv $prefix/include $includeDir
	mv $prefix/lib2 $libDir

	prepareInstalledDevelLib libfluidlite

	# devel package
	packageEntries devel \
		$developDir
}
