SUMMARY="Audio software for multi-track recording and editing"
DESCRIPTION="Audacity can be used to perform a number of audio editing and \
recording tasks such as making ringtones, mixing stero tracks, transferring \
tapes and records to computer or CD, splitting recordings into separate \
tracks and more."
HOMEPAGE="https://www.audacityteam.org"
COPYRIGHT="1999-2020 by Audacity Team"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="https://github.com/audacity/audacity/archive/refs/tags/Audacity-$portVersion.tar.gz"
CHECKSUM_SHA256="cdb4800c8e9d1d4ca19964caf8d24000f80286ebd8a4db566c2622449744c099"
SOURCE_DIR="audacity-Audacity-$portVersion"
PATCHES="audacity-$portVersion.patchset"

ARCHITECTURES="?all !x86_gcc2"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	audacity$secondaryArchSuffix = $portVersion
	app:Audacity$secondaryArchSuffix = $portVersion
	cmd:audacity$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	wxgtk$secondaryArchSuffix
	lib:libatk_1.0$secondaryArchSuffix
	lib:libatomic$secondaryArchSuffix
	lib:libavcodec$secondaryArchSuffix
	lib:libavformat$secondaryArchSuffix
	lib:libavutil$secondaryArchSuffix
	lib:libcairo$secondaryArchSuffix
	lib:libexpat$secondaryArchSuffix
	lib:libflac$secondaryArchSuffix
	lib:libgdk_pixbuf_2.0$secondaryArchSuffix
	lib:libglib_2.0$secondaryArchSuffix
	lib:libgtk_3$secondaryArchSuffix
	lib:libharfbuzz$secondaryArchSuffix
	lib:libiconv$secondaryArchSuffix
#	lib:libid3tag$secondaryArchSuffix		-- missing pkgconfig
	lib:libintl$secondaryArchSuffix
#	lib:libmad$secondaryArchSuffix			-- missing pkgconfig
	lib:libogg$secondaryArchSuffix
	lib:libpango_1.0$secondaryArchSuffix
	lib:libsndfile$secondaryArchSuffix
	lib:libvorbis$secondaryArchSuffix
	lib:libX11$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	wxgtk${secondaryArchSuffix}_devel
	devel:libavcodec$secondaryArchSuffix
	devel:libavformat$secondaryArchSuffix
	devel:libavutil$secondaryArchSuffix
	devel:libexpat$secondaryArchSuffix
	devel:libflac$secondaryArchSuffix
	devel:libglib_2.0$secondaryArchSuffix
	devel:libgtk_3$secondaryArchSuffix
	devel:libiconv$secondaryArchSuffix
#	devel:libid3tag$secondaryArchSuffix
	devel:libintl$secondaryArchSuffix
#	devel:libmad$secondaryArchSuffix
	devel:libsndfile$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:awk
	cmd:cmake
	cmd:diff
	cmd:find
	cmd:gcc$secondaryArchSuffix
	cmd:gettext$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:which
	cmd:wx_config$secondaryArchSuffix
	"

BUILD()
{
	mkdir -p build
	cd build
	cmake .. $cmakeDirArgs -DCMAKE_BUILD_TYPE=Release \
		-DUSE_MIDI=OFF \
		-Daudacity_use_pa_oss=NO -Daudacity_use_pa_jack=off \
		-Daudacity_use_ffmpeg=off -Daudacity_use_midi=off -Daudacity_use_pch=no
	make $jobArgs
}

INSTALL()
{
	make -C build install
}
