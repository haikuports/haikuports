SUMMARY="Tools for using the Ogg Vorbis sound file format"
DESCRIPTION="vorbis-tools - tools for using the Ogg Vorbis sound file format."
HOMEPAGE="http://www.vorbis.com/"
COPYRIGHT="2000-2005 Michael Smith, Stan Seibert and other contributers"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="http://downloads.xiph.org/releases/vorbis/vorbis-tools-$portVersion.tar.gz"
CHECKSUM_SHA256="a1fe3ddc6777bdcebf6b797e7edfe0437954b24756ffcc8c6b816b63e0460dde"
SOURCE_DIR="vorbis-tools-$portVersion"

ARCHITECTURES="ALL !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

# On x86_gcc2 we don't want to install the commands in bin/<arch>/, but in bin/.
commandBinDir=$binDir
commandSuffix=$secondaryArchSuffix
if [ "$targetArchitecture" = x86_gcc2 ]; then
	commandSuffix=
	commandBinDir=$prefix/bin
fi

PROVIDES="
	vorbis_tools$secondaryArchSuffix = $portVersion
	cmd:ogg123$commandSuffix
	cmd:oggdec$commandSuffix
	cmd:oggenc$commandSuffix
	cmd:ogginfo$commandSuffix
	cmd:vcut$commandSuffix
	cmd:vorbiscomment$commandSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libao$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libFLAC$secondaryArchSuffix
	lib:libiconv$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libogg$secondaryArchSuffix
	lib:libspeex$secondaryArchSuffix
	lib:libssl$secondaryArchSuffix
	lib:libvorbis$secondaryArchSuffix
	lib:libvorbis$secondaryArchSuffix
	lib:libvorbisenc$secondaryArchSuffix
	lib:libvorbisfile$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"
if [ "$targetArchitecture" == x86_gcc2 ]; then
	REPLACES="
		vorbis_tools
		"
fi

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libao$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libFLAC$secondaryArchSuffix
	devel:libiconv$secondaryArchSuffix
	devel:libintl$secondaryArchSuffix
	devel:libogg$secondaryArchSuffix
	devel:libspeex$secondaryArchSuffix
	devel:libssl$secondaryArchSuffix >= 3
	devel:libvorbis$secondaryArchSuffix
	devel:libvorbis$secondaryArchSuffix
	devel:libvorbisenc$secondaryArchSuffix
	devel:libvorbisfile$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:aclocal
	cmd:automake
	cmd:autoreconf
	cmd:bison
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:libtoolize$secondaryArchSuffix
	cmd:make
	cmd:msgfmt$secondaryArchSuffix
	cmd:msgmerge$secondaryArchSuffix
	cmd:pkg_config$secondaryArchSuffix
	"

BUILD()
{
	sed -i 's/AM_CONFIG_HEADER/AC_CONFIG_HEADERS/' configure.ac
	autoreconf -fi
	runConfigure --omit-dirs binDir ./configure \
		--bindir=$commandBinDir
	make $jobArgs
}

INSTALL()
{
	make install
}
