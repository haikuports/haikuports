SUMMARY="A cross-platform open source BitTorrent client"
DESCRIPTION="Transmission has the features you want from a BitTorrent client: \
encryption, a web interface, peer exchange, magnet links, DHT, ÂµTP, UPnP and \
NAT-PMP port forwarding, webseed support, watch directories, tracker editing, \
global and per-torrent speed limits, and more."
HOMEPAGE="https://www.transmissionbt.com/"
COPYRIGHT="2005-2016 By the respective authors"
LICENSE="Transmission
	MIT
	GNU GPL v2"
REVISION="5"
SOURCE_URI="https://github.com/transmission/transmission-releases/raw/master/transmission-$portVersion.tar.xz"
CHECKSUM_SHA256="3a8d045c306ad9acb7bf81126939b9594553a388482efa0ec1bfb67b22acd35f"
PATCHES="transmission-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 x86 x86_64"
SECONDARY_ARCHITECTURES="!x86_gcc2 x86"

PROVIDES="
	transmission$secondaryArchSuffix = $portVersion
	cmd:transmission_cli$secondaryArchSuffix
	cmd:transmission_create$secondaryArchSuffix
	cmd:transmission_daemon$secondaryArchSuffix
	cmd:transmission_edit$secondaryArchSuffix
	cmd:transmission_remote$secondaryArchSuffix
	cmd:transmission_show$secondaryArchSuffix
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libcrypto$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libevent_2.1$secondaryArchSuffix
	lib:libiconv$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libminiupnpc$secondaryArchSuffix
	lib:libQt5Core$secondaryArchSuffix
	lib:libQt5Gui$secondaryArchSuffix
	lib:libQt5Network$secondaryArchSuffix
	lib:libQt5PrintSupport$secondaryArchSuffix
	lib:libQt5Script$secondaryArchSuffix
	lib:libQt5Sql$secondaryArchSuffix
	lib:libQt5WebKit$secondaryArchSuffix
	lib:libQt5WebKitWidgets$secondaryArchSuffix
	lib:libQt5Widgets$secondaryArchSuffix
	lib:libssl$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libcurl$secondaryArchSuffix
	devel:libevent_2.1$secondaryArchSuffix
	devel:libgettextlib$secondaryArchSuffix >= 0.14.1
	devel:libiconv$secondaryArchSuffix
	devel:libminiupnpc$secondaryArchSuffix
	devel:libQt5Core$secondaryArchSuffix
	devel:libQt5Gui$secondaryArchSuffix
	devel:libQt5Network$secondaryArchSuffix
	devel:libQt5Script$secondaryArchSuffix
	devel:libQt5Sql$secondaryArchSuffix
	devel:libQt5PrintSupport$secondaryArchSuffix
	devel:libQt5WebKit$secondaryArchSuffix
	devel:libQt5WebKitWidgets$secondaryArchSuffix
	devel:libQt5Widgets$secondaryArchSuffix
	devel:libssl$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:awk
	cmd:cmake
	cmd:gcc$secondaryArchSuffix
#	cmd:intltool_update >= 0.40
	cmd:ld$secondaryArchSuffix
	cmd:pkg_config$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	mkdir -p build
	cd build
	cmake \
		-DCMAKE_INSTALL_PREFIX=$prefix \
		-DCMAKE_CXX_FLAGS="-DB_USE_POSITIVE_POSIX_ERRORS" \
		-DCMAKE_C_FLAGS="-DB_USE_POSITIVE_POSIX_ERRORS" \
		-DUSE_QT5=ON \
		..
	make $jobArgs
}

INSTALL()
{
	make install
}
