SUMMARY="A dynamic virtual terminal manager"
DESCRIPTION="dvtm brings the concept of tiling window management, popularized by
X11-window managers like dwm to the console. As a console window manager it tries
to make it easy to work with multiple console based programs."
HOMEPAGE="http://www.brain-dump.org/projects/dvtm"
COPYRIGHT="2013-2016 Marc Andr√© Tanner"
LICENSE="MIT
    ISC"
REVISION="1"
srcGitRev="7bcf43f8dbd5c4a67ec573a1248114caa75fa3c2"
SOURCE_URI="https://github.com/martanne/dvtm/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="5ad3bb68c7f064a2ff96a2e70637b8a974f7c69018cd546651bc7c0f1eaaf2ea"
SOURCE_DIR="dvtm-$srcGitRev"
PATCHES="dvtm-$portVersion.patchset"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	dvtm$secondaryArchSuffix = $portVersion
	cmd:dvtm = $portVersion
	cmd:dvtm_editor = $portVersion
	cmd:dvtm_pager = $portVersion
	cmd:dvtm_status = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libncursesw$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libncursesw$secondaryArchSuffix
	"

BUILD_PREREQUIRES="
	cmd:gcc$secondaryArchSuffix
	cmd:make
	"

TEST_REQUIRES="
	cmd:diff
	cmd:vis
	cmd:which
	cmd:wget
	"

BUILD()
{
	make $jobArgs \
		PREFIX=$prefix \
		MANPREFIX=$manDir \
		TERMINFO=$dataDir/terminfo \
		LIBS="-lnetwork -lncursesw"
}

INSTALL()
{
	make $jobArgs \
		PREFIX=$prefix \
		MANPREFIX=$manDir \
		TERMINFO=$dataDir/terminfo \
		install
}

# Attention!
#
# - It downloads a text file from: http://www.cl.cam.ac.uk/~mgk25/ucs/examples/UTF-8-demo.txt
#   for testing (we could patch that to use a copy via "additional-files" instead if needed).
# - hangs at the end, and looks better when ran outside of HaikuPorter.
#   Prepare to kill "/bin/bash" and/or "dvtm" and/or "testsuite.sh" to regain
#   control of your terminal.
TEST()
{
	testsuite.sh
}
