From b3a2cfee7f0c370e470733cd370c916fb13df176 Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Wed, 18 Sep 2013 03:11:28 -0600
Subject: check for libnetwork


diff --git a/configure.ac b/configure.ac
index c72148d..315afd9 100644
--- a/configure.ac
+++ b/configure.ac
@@ -900,7 +900,7 @@ if test x$enable_cap = xyes; then
   AC_CHECK_LIB(cap, cap_get_proc)
 fi
 
-AC_CHECK_LIB(socket, socket)
+AC_CHECK_LIB(network, socket)
 AC_SEARCH_LIBS(gethostbyname2, bind)
 
 case $LIBS in
-- 
2.51.0


From 5fb3bf658c01e3854a862d466f116affb85324aa Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zolt=C3=A1n=20Mizsei?= <zmizsei@extrowerk.com>
Date: Wed, 11 Jan 2017 18:17:20 +0100
Subject: Haiku rusage fix


diff --git a/Src/jobs.c b/Src/jobs.c
index a91ef78..1940431 100644
--- a/Src/jobs.c
+++ b/Src/jobs.c
@@ -1036,7 +1036,7 @@ should_report_time(Job j)
 #endif
     }
 
-#ifdef HAVE_GETRUSAGE
+#if defined(HAVE_GETRUSAGE) && !defined(__HAIKU__)
     if (reportmemory >= 0 &&
 	j->procs->ti.ru_maxrss / 1024 > reportmemory)
 	return 1;
-- 
2.51.0


From f2cf8fa6e0e7d304a4330d6ce92aa2a7f6c237eb Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zolt=C3=A1n=20Mizsei?= <zmizsei@extrowerk.com>
Date: Thu, 17 Aug 2017 16:16:21 +0200
Subject: Enable dynamic modules on Haiku


diff --git a/configure.ac b/configure.ac
index 315afd9..558678b 100644
--- a/configure.ac
+++ b/configure.ac
@@ -894,6 +894,7 @@ fi
 
 if test "x$dynamic" = xyes; then
   AC_CHECK_LIB(dl, dlopen)
+  AC_CHECK_LIB(root, dlopen)
 fi
 
 if test x$enable_cap = xyes; then
@@ -2847,7 +2848,8 @@ char *argv[];
     aix*)         DLLDFLAGS="${DLLDFLAGS=-G -bexpall -lc}" ;;
     solaris*|sysv4*|esix*) DLLDFLAGS="${DLLDFLAGS=-G}" ;;
     darwin*)      DLLDFLAGS="${DLLDFLAGS=-bundle -flat_namespace -undefined suppress}" ;;
-    beos*|haiku*) DLLDFLAGS="${DLLDFLAGS=-nostart}" ;;
+    beos*) DLLDFLAGS="${DLLDFLAGS=-nostart}" ;;
+    haiku*) DLLDFLAGS="${DLLDFLAGS=-shared}" ;;
     openbsd*)
       if test x$zsh_cv_sys_elf = xyes; then
 	DLLDFLAGS="${DLLDFLAGS=-shared -fPIC}"
-- 
2.51.0


From 2bfd0565b7da4db0a1d6b430126911a069bbe1c7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Zolt=C3=A1n=20Mizsei?= <zmizsei@extrowerk.com>
Date: Sat, 27 Oct 2018 10:36:50 +0200
Subject: Some other function resides in libroot


diff --git a/configure.ac b/configure.ac
index 558678b..95a4fd0 100644
--- a/configure.ac
+++ b/configure.ac
@@ -745,10 +745,12 @@ dnl and might not be compiled into the zsh executable.
 dnl On ReliantUNIX -lc better be the last library, else funny things
 dnl may happen.
 AC_CHECK_LIB(c, printf, [LIBS="$LIBS -lc"])
+AC_CHECK_LIB(root, printf)
 
 AC_CHECK_LIB(m, pow)
 
 AC_CHECK_LIB(rt, clock_gettime)
+AC_CHECK_LIB(root, clock_gettime)
 
 dnl Various features of ncurses depend on having the right header
 dnl (the system's own curses.h may well not be good enough).
-- 
2.51.0


From 40430e9f75dc9086e80c1269ddc3cfc61a9fee31 Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Mon, 11 Dec 2023 18:27:05 -0700
Subject: remove hd from hexdump completions


diff --git a/Completion/Unix/Command/_hexdump b/Completion/Unix/Command/_hexdump
index f700ca6..6c0e0ba 100644
--- a/Completion/Unix/Command/_hexdump
+++ b/Completion/Unix/Command/_hexdump
@@ -1,4 +1,4 @@
-#compdef hexdump hd
+#compdef hexdump
 
 local -a args fmts optpar
 fmts=(
-- 
2.51.0


From b03e4bce5561135b289ba5ec7cd75de2f257a1da Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Mon, 11 Dec 2023 18:27:51 -0700
Subject: quick fixes for Haiku filesystem layout


diff --git a/Completion/Unix/Type/_domains b/Completion/Unix/Type/_domains
index 851ac79..614e625 100644
--- a/Completion/Unix/Type/_domains
+++ b/Completion/Unix/Type/_domains
@@ -5,11 +5,11 @@ local expl domains tmp
 if ! zstyle -a ":completion:${curcontext}:domains" domains domains; then
   if (( ! $+_cache_domains )); then
     _cache_domains=()
-    if [[ -f /etc/resolv.conf ]]; then
+    if [[ -f /boot/system/settings/network/resolv.conf ]]; then
       while read tmp; do
         [[ "$tmp" = (domain|search)* ]] &&
             _cache_domains=( "$_cache_domains[@]" "${=${tmp%%[ 	]#}#*[ 	]}" )
-      done < /etc/resolv.conf
+      done < /boot/system/settings/network/resolv.conf
       _cache_domains=( "${(@)_cache_domains:#[ 	]#}" )
     fi
   fi
diff --git a/Completion/Unix/Type/_hosts b/Completion/Unix/Type/_hosts
index 4057fee..4df5155 100644
--- a/Completion/Unix/Type/_hosts
+++ b/Completion/Unix/Type/_hosts
@@ -21,7 +21,7 @@ if ! zstyle -a ":completion:${curcontext}:hosts" hosts _hosts; then
       # tested _cache_hosts doesn't exist.
       _cache_hosts=(${(s: :)${(ps:\t:)${(f)~~"$(_call_program hosts getent hosts 2>/dev/null)"}##${~ipstrip}}})
     else
-      _cache_hosts=(${(s: :)${(ps:\t:)${${(f)~~"$(</etc/hosts)"}%%\#*}##${~ipstrip}}})
+      _cache_hosts=(${(s: :)${(ps:\t:)${${(f)~~"$(</boot/system/settings/network/hosts)"}%%\#*}##${~ipstrip}}})
       if (( ${+commands[ypcat]} )) &&
     	tmp=$(_call_program hosts ypcat hosts.byname 2>/dev/null); then
         _cache_hosts+=( ${=${(f)tmp}##${~ipstrip}} ) # If you use YP
@@ -37,7 +37,7 @@ if ! zstyle -a ":completion:${curcontext}:hosts" hosts _hosts; then
     # discarded. ssh's known_hosts files are thus supported. This style defaults
     # to the list /etc/ssh/ssh_known_hosts, ~/.ssh/known_hosts
     zstyle -a ":completion:${curcontext}:hosts" known-hosts-files khostfiles ||
-    khostfiles=(/etc/ssh/ssh_known_hosts ~/.ssh/known_hosts)
+    khostfiles=(/boot/system/settings/ssh/ssh_known_hosts ~/config/settings/ssh/known_hosts)
 
     for khostfile in $khostfiles; do
       if [[ -r $khostfile ]]; then
-- 
2.51.0


From 9c2dd778cffedd2e1a472b519b4fd5fce2e646c6 Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Sun, 3 Nov 2024 06:14:28 -0700
Subject: quick fix for texinfo > 7


diff --git a/Doc/Makefile.in b/Doc/Makefile.in
index 23e5fc7..ec5dbcb 100644
--- a/Doc/Makefile.in
+++ b/Doc/Makefile.in
@@ -266,7 +266,7 @@ texi2html.conf: $(sdir_top)/Config/version.mk
 	d=`echo $(VERSION_DATE)`; \
 	v="<font size=\"-1\">Zsh version $(VERSION), released on $$d.</font>"; \
 	case '$(TEXI2HTML)' in \
-	  *texi2any*) echo "set_from_init_file('PRE_BODY_CLOSE','$$v');" ;; \
+	  *texi2any*) echo "texinfo_set_from_init_file('PRE_BODY_CLOSE','$$v');" ;; \
 	  *) echo "\$$PRE_BODY_CLOSE = '$$v';" ;; \
 	esac > $@
 
-- 
2.51.0

