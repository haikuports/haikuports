From a45d650b748b92b6743c01d92d57b6c6003eba42 Mon Sep 17 00:00:00 2001
From: Luc Schrijvers <begasus@gmail.com>
Date: Wed, 29 Oct 2025 13:47:30 +0100
Subject: add build optimizations

Co-authored-by: Oscar Lesta <oscar.lesta@gmail.com>

diff --git a/Cargo.toml b/Cargo.toml
index 7777937..562e09a 100644
--- a/Cargo.toml
+++ b/Cargo.toml
@@ -10,7 +10,11 @@ categories = ["command-line-utilities"]
 exclude = ["HomebrewFormula", "HomebrewFormula/*", "pkg/*", "docs/*"]
 
 [profile.release]
+opt-level = 'z'
 lto = true
+codegen-units = 1
+panic = 'abort'
+strip = true
 
 [profile.dev]
 debug = true
-- 
2.51.0


From 7188ea0666b3767a0e8756fbd5a19f8b200b16ba Mon Sep 17 00:00:00 2001
From: Luc Schrijvers <begasus@gmail.com>
Date: Wed, 29 Oct 2025 13:36:21 +0100
Subject: Haiku doesn't have TIOCSTI in libroot


diff --git a/src/fake_typer.rs b/src/fake_typer.rs
index ba97d39..fd63ec9 100644
--- a/src/fake_typer.rs
+++ b/src/fake_typer.rs
@@ -12,10 +12,10 @@ extern "C" {
 pub fn use_tiocsti(string: &str) {
     for byte in string.as_bytes() {
         let a: *const u8 = byte;
-        assert!(
-            unsafe { ioctl(0, libc::TIOCSTI.try_into().unwrap(), a) } >= 0,
-            "Error encountered when calling ioctl"
-        );
+//        assert!(
+//            unsafe { ioctl(0, libc::TIOCSTI.try_into().unwrap(), a) } >= 0,
+//            "Error encountered when calling ioctl"
+//        );
     }
 }
 
-- 
2.51.0

