diff -Naur _res/blender-2.47/config/haiku1-config.py ./blender-2.47-haiku-1/config/haiku1-config.py
--- _res/blender-2.47/config/haiku1-config.py	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/config/haiku1-config.py	2008-12-01 22:45:02.000000000 +0100
@@ -0,0 +1,191 @@
+import os
+
+HAIKU_DEVELOP_DIR = '/boot/develop'
+HAIKU_DEVELOP_LIB = HAIKU_DEVELOP_DIR + '/lib/x86' # TODO arch
+HAIKU_DEVELOP_INCLUDE = HAIKU_DEVELOP_DIR + '/headers'
+HAIKU_DEVELOP_INCLUDE_OS = HAIKU_DEVELOP_INCLUDE + '/os'
+HAIKU_DEVELOP_INCLUDE_3RDPARTY = HAIKU_DEVELOP_INCLUDE + '/3rdparty'
+HAIKU_COMMON_DIR = '/boot/common'
+HAIKU_COMMON_LIB = HAIKU_COMMON_DIR + '/lib'
+HAIKU_COMMON_INCLUDE = HAIKU_COMMON_DIR + '/include'
+
+WITH_BF_VERSE = 'false'
+BF_VERSE_INCLUDE = "#extern/verse/dist"
+
+BF_PYTHON = HAIKU_COMMON_DIR
+BF_PYTHON_VERSION = '2.5'
+BF_PYTHON_INC = HAIKU_COMMON_INCLUDE + '/python' + BF_PYTHON_VERSION
+BF_PYTHON_BINARY = BF_PYTHON + '/bin/python' + BF_PYTHON_VERSION
+BF_PYTHON_LIB = 'python' + BF_PYTHON_VERSION
+BF_PYTHON_LIBPATH = HAIKU_COMMON_LIB
+BF_PYTHON_LINKFLAGS = os.popen("python-config --ldflags").readline()
+
+WITH_BF_OPENAL = 'false' # TODO
+#BF_OPENAL = '/usr'
+#BF_OPENAL_INC = '${BF_OPENAL}/include'
+#BF_OPENAL_LIB = 'openal'
+# some distros have a separate libalut
+# if you get linker complaints, you need to uncomment the line below
+# BF_OPENAL_LIB = 'openal alut'  
+
+WITH_BF_SDL = 'true' # setting is ignored
+BF_SDL = HAIKU_COMMON_DIR
+BF_SDL_INC = HAIKU_COMMON_INCLUDE + '/SDL'
+BF_SDL_LIB = 'SDL'
+
+WITH_BF_FMOD = 'false' # TODO
+##BF_FMOD = LIBDIR + '/fmod'
+
+WITH_BF_OPENEXR = 'false' # TODO
+#BF_OPENEXR = '/usr'
+# when compiling with your own openexr lib you might need to set...
+# BF_OPENEXR_INC = '${BF_OPENEXR}/include/OpenEXR ${BF_OPENEXR}/include'
+
+#BF_OPENEXR_INC = '${BF_OPENEXR}/include/OpenEXR'
+#BF_OPENEXR_LIB = 'Half IlmImf Iex Imath '
+# BF_OPENEXR_LIBPATH = '${BF_OPENEXR}/lib'
+
+WITH_BF_DDS = 'true'
+
+WITH_BF_JPEG = 'true' # setting is ignored
+BF_JPEG = HAIKU_COMMON_DIR
+BF_JPEG_INC = HAIKU_COMMON_INCLUDE
+BF_JPEG_LIB = 'jpeg'
+BF_JPEG_LIBPATH = HAIKU_COMMON_LIB
+
+WITH_BF_PNG = 'true'
+BF_PNG = HAIKU_DEVELOP_DIR
+BF_PNG_INC = HAIKU_DEVELOP_INCLUDE_3RDPARTY
+BF_PNG_LIB = 'png'
+
+WITH_BF_TIFF = 'true' # setting is ignored
+BF_TIFF = HAIKU_COMMON_DIR
+BF_TIFF_INC = HAIKU_COMMON_INCLUDE
+
+WITH_BF_ZLIB = 'true'
+BF_ZLIB = HAIKU_DEVELOP_DIR
+BF_ZLIB_INC = HAIKU_DEVELOP_INCLUDE_3RDPARTY
+BF_ZLIB_LIB = 'z'
+
+WITH_BF_INTERNATIONAL = 'false' # TODO
+
+#BF_GETTEXT = '/usr'
+#BF_GETTEXT_INC = '${BF_GETTEXT}/include'
+#BF_GETTEXT_LIB = 'gettextlib'
+#BF_GETTEXT_LIBPATH = '${BF_GETTEXT}/lib'
+
+WITH_BF_FTGL = 'false' # TODO
+#BF_FTGL = '#extern/bFTGL'
+#BF_FTGL_INC = '${BF_FTGL}/include'
+#BF_FTGL_LIB = 'extern_ftgl'
+
+WITH_BF_GAMEENGINE='false' # TODO
+
+WITH_BF_ODE = 'false'
+##BF_ODE = LIBDIR + '/ode'
+BF_ODE_INC = BF_ODE + '/include'
+BF_ODE_LIB = BF_ODE + '/lib/libode.a'
+
+WITH_BF_BULLET = 'true'
+BF_BULLET = '#extern/bullet2/src'
+BF_BULLET_INC = '${BF_BULLET}'
+BF_BULLET_LIB = 'extern_bullet'
+
+BF_SOLID = '#extern/solid'
+BF_SOLID_INC = '${BF_SOLID}'
+BF_SOLID_LIB = 'extern_solid'
+
+WITH_BF_YAFRAY = 'true'
+
+#WITH_BF_NSPR = 'true'
+#BF_NSPR = $(LIBDIR)/nspr
+#BF_NSPR_INC = -I$(BF_NSPR)/include -I$(BF_NSPR)/include/nspr
+#BF_NSPR_LIB = 
+
+# Uncomment the following line to use Mozilla inplace of netscape
+#CPPFLAGS += -DMOZ_NOT_NET
+# Location of MOZILLA/Netscape header files...
+#BF_MOZILLA = $(LIBDIR)/mozilla
+#BF_MOZILLA_INC = -I$(BF_MOZILLA)/include/mozilla/nspr -I$(BF_MOZILLA)/include/mozilla -I$(BF_MOZILLA)/include/mozilla/xpcom -I$(BF_MOZILLA)/include/mozilla/idl
+#BF_MOZILLA_LIB =
+# Will fall back to look in BF_MOZILLA_INC/nspr and BF_MOZILLA_LIB
+# if this is not set.
+#
+# Be paranoid regarding library creation (do not update archives)
+#BF_PARANOID = 'true'
+
+# enable freetype2 support for text objects
+WITH_BF_FREETYPE = 'false'
+#BF_FREETYPE = '/usr'
+#BF_FREETYPE_INC = '${BF_FREETYPE}/include ${BF_FREETYPE}/include/freetype2'
+#BF_FREETYPE_LIB = 'freetype'
+
+WITH_BF_QUICKTIME = 'false'
+#BF_QUICKTIME = '/usr/local'
+#BF_QUICKTIME_INC = '${BF_QUICKTIME}/include'
+
+WITH_BF_ICONV = 'false' # TODO
+##BF_ICONV = LIBDIR + "/iconv"
+#BF_ICONV_INC = '${BF_ICONV}/include'
+#BF_ICONV_LIB = 'iconv'
+#BF_ICONV_LIBPATH = '${BF_ICONV}/lib'
+
+WITH_BF_BINRELOC = 'false' # TODO?
+
+# enable ffmpeg  support
+WITH_BF_FFMPEG = 'false'  # -DWITH_FFMPEG
+#BF_FFMPEG = '#extern/ffmpeg'
+#BF_FFMPEG_LIB = ''
+# Uncomment the following two lines to use system's ffmpeg
+# BF_FFMPEG = '/usr'
+# BF_FFMPEG_LIB = 'avformat avcodec swscale avutil'
+#BF_FFMPEG_INC = '${BF_FFMPEG}/include'
+#BF_FFMPEG_LIBPATH='${BF_FFMPEG}/lib'
+
+# Mesa Libs should go here if your using them as well....
+WITH_BF_STATICOPENGL = 'false'
+#BF_OPENGL = '/usr'
+BF_OPENGL_INC = '${HAIKU_DEVELOP_INCLUDE_OS}/opengl'
+BF_OPENGL_LIB = 'GL'
+BF_OPENGL_LIBPATH = '${HAIKU_DEVELOP_LIB}'
+#BF_OPENGL_LIB_STATIC = '${BF_OPENGL}/libGL.a ${BF_OPENGL}/libGLU.a ${BF_OPENGL}/libXxf86vm.a ${BF_OPENGL}/libX11.a ${BF_OPENGL}/libXi.a ${BF_OPENGL}/libXext.a ${BF_OPENGL}/libXxf86vm.a'
+
+##
+CC = 'gcc'
+CXX = 'g++'
+
+# TODO CHECK ALL VALUES!
+##CCFLAGS = ['-pipe','-fPIC','-funsigned-char','-fno-strict-aliasing']
+
+##CPPFLAGS = ['-DXP_UNIX']
+##CXXFLAGS = ['-pipe','-fPIC','-funsigned-char','-fno-strict-aliasing']
+REL_CFLAGS = ['-O2']
+REL_CCFLAGS = ['-O2']
+##BF_DEPEND = 'true'
+##
+##AR = ar
+##ARFLAGS = ruv
+##ARFLAGSQUIET = ru
+##
+##C_WARN = '-Wall -Wno-char-subscripts -Wdeclaration-after-statement'
+
+##CC_WARN = '-Wall'
+
+##FIX_STUBS_WARNINGS = -Wno-unused
+
+LLIBS = 'stdc++.r4 network be'
+##LOPTS = --dynamic
+##DYNLDFLAGS = -shared $(LDFLAGS)
+
+#BF_PROFILE_FLAGS = ['-pg','-g']
+#BF_PROFILE = 'false'
+
+CPPDEFINES = 'GHOST_DEBUG'
+DEFINES = ['GHOST_DEBUG']
+
+BF_DEBUG = 'false'
+BF_DEBUG_FLAGS = '-g'
+
+BF_BUILDDIR = '../build-haiku1'
+BF_INSTALLDIR='../install-haiku1'
+
diff -Naur _res/blender-2.47/extern/glew/src/glew.c ./blender-2.47-haiku-1/extern/glew/src/glew.c
--- _res/blender-2.47/extern/glew/src/glew.c	2008-12-29 19:15:29.000000000 +0100
+++ ./blender-2.47-haiku-1/extern/glew/src/glew.c	2008-12-29 19:26:04.000000000 +0100
@@ -32,7 +32,7 @@
 #include <GL/glew.h>
 #if defined(_WIN32)
 #  include <GL/wglew.h>
-#elif !defined(__APPLE__) || defined(GLEW_APPLE_GLX)
+#elif (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__)
 #  include <GL/glxew.h>
 #endif
 
@@ -86,7 +86,7 @@
 }
 #endif /* __APPLE__ */
 
-#if defined(__sgi) || defined (__sun)
+#if defined(__sgi) || defined (__sun) || defined(__HAIKU__)
 #include <dlfcn.h>
 #include <stdio.h>
 #include <stdlib.h>
@@ -107,7 +107,7 @@
   else
     return dlsym(h, (const char*)name);
 }
-#endif /* __sgi || __sun */
+#endif /* __sgi || __sun || __HAIKU__ */
 
 /*
  * Define glewGetProcAddress.
@@ -118,7 +118,7 @@
 #  if defined(__APPLE__)
 #    define glewGetProcAddress(name) NSGLGetProcAddress(name)
 #  else
-#    if defined(__sgi) || defined(__sun)
+#    if defined(__sgi) || defined(__sun) || defined(__HAIKU__)
 #      define glewGetProcAddress(name) dlGetProcAddress(name)
 #    else /* __linux */
 #      define glewGetProcAddress(name) (*glXGetProcAddressARB)(name)
@@ -6422,7 +6422,7 @@
   return GLEW_OK;
 }
 
-#elif !defined(__APPLE__) || defined(GLEW_APPLE_GLX)
+#elif (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__)
 
 PFNGLXGETCURRENTDISPLAYPROC __glewXGetCurrentDisplay = NULL;
 
@@ -7139,7 +7139,7 @@
   return GLEW_OK;
 }
 
-#endif /* !__APPLE__ || GLEW_APPLE_GLX */
+#endif /* (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__) */
 
 /* ------------------------------------------------------------------------ */
 
@@ -7176,7 +7176,7 @@
 
 #if defined(_WIN32)
 extern GLenum wglewContextInit (void);
-#elif !defined(__APPLE__) || defined(GLEW_APPLE_GLX) /* _UNIX */
+#elif (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__)
 extern GLenum glxewContextInit (void);
 #endif /* _WIN32 */
 
@@ -7186,7 +7186,7 @@
   if ( (r = glewContextInit()) ) return r;
 #if defined(_WIN32)
   return wglewContextInit();
-#elif !defined(__APPLE__) || defined(GLEW_APPLE_GLX) /* _UNIX */
+#elif (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__)
   return glxewContextInit();
 #else
   return r;
@@ -9429,7 +9429,7 @@
   return ret;
 }
 
-#elif !defined(__APPLE__) || defined(GLEW_APPLE_GLX)
+#elif (!defined(__APPLE__) || defined(GLEW_APPLE_GLX)) && !defined(__HAIKU__)
 
 #if defined(GLEW_MX)
 GLboolean glxewContextIsSupported (GLXEWContext* ctx, const char* name)
diff -Naur _res/blender-2.47/intern/ghost/SConscript ./blender-2.47-haiku-1/intern/ghost/SConscript
--- _res/blender-2.47/intern/ghost/SConscript	2008-12-29 19:15:26.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/SConscript	2008-12-01 22:44:59.000000000 +0100
@@ -14,14 +14,22 @@
     for f in pf:
         sources.remove('intern' + os.sep + f + 'Win32.cpp')
         sources.remove('intern' + os.sep + f + 'Carbon.cpp')
+        sources.remove('intern' + os.sep + f + 'Haiku.cpp')
 elif window_system in ('win32-vc', 'win32-mingw', 'cygwin', 'linuxcross'):
     for f in pf:
         sources.remove('intern' + os.sep + f + 'X11.cpp')
         sources.remove('intern' + os.sep + f + 'Carbon.cpp')
+        sources.remove('intern' + os.sep + f + 'Haiku.cpp')
 elif window_system == 'darwin':
     for f in pf:
         sources.remove('intern' + os.sep + f + 'Win32.cpp')
         sources.remove('intern' + os.sep + f + 'X11.cpp')
+        sources.remove('intern' + os.sep + f + 'Haiku.cpp')
+elif window_system == 'haiku1':
+    for f in pf:
+        sources.remove('intern' + os.sep + f + 'Win32.cpp')
+        sources.remove('intern' + os.sep + f + 'X11.cpp')
+        sources.remove('intern' + os.sep + f + 'Carbon.cpp')
 else:
     print "Unknown window system specified."
     Exit()
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_Debug.h ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_Debug.h
--- _res/blender-2.47/intern/ghost/intern/GHOST_Debug.h	2008-12-29 19:15:26.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_Debug.h	2008-12-01 22:44:59.000000000 +0100
@@ -31,6 +31,9 @@
  * Macro's used in GHOST debug target.
  */
 
+// FIXME1
+#define GHOST_DEBUG
+
 #ifndef _GHOST_DEBUG_H_
 #define _GHOST_DEBUG_H_
 
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_DisplayManagerHaiku.cpp ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_DisplayManagerHaiku.cpp
--- _res/blender-2.47/intern/ghost/intern/GHOST_DisplayManagerHaiku.cpp	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_DisplayManagerHaiku.cpp	2008-12-01 22:44:59.000000000 +0100
@@ -0,0 +1,104 @@
+#ifdef HAVE_CONFIG_H
+#include <config.h>
+#endif
+
+#include "GHOST_Debug.h"
+#include "GHOST_DisplayManagerHaiku.h"
+
+#include <Screen.h>
+
+GHOST_DisplayManagerHaiku::GHOST_DisplayManagerHaiku(void) {
+}
+
+GHOST_DisplayManagerHaiku::~GHOST_DisplayManagerHaiku(void) {
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::initialize(void) {
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::getNumDisplays(GHOST_TUns8& numDisplays) const {
+	/* For now, we only support one screen. */
+	numDisplays = 1;
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::getNumDisplaySettings(GHOST_TUns8 display, GHOST_TInt32& numSettings) const {
+	GHOST_ASSERT(display < 1, "GHOST_DisplayManagerHaiku::getNumDisplaySettings() : Single display support only!\n");
+	numSettings = GHOST_TInt32( 1 );
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::getDisplaySetting(GHOST_TUns8 display, GHOST_TInt32 index, GHOST_DisplaySetting& setting) const {
+	GHOST_ASSERT(display < 1, "GHOST_DisplayManagerHaiku::getDisplaySetting() : Single display support only!\n");
+	GHOST_ASSERT(index < 1, "GHOST_DisplayManagerHaiku::getDisplaySetting() : Single display setting support only!\n");
+
+	BScreen screen;
+	if (!screen.IsValid())
+		return GHOST_kFailure;
+	
+	color_space cspace;	
+	cspace = screen.ColorSpace();
+	
+	switch (cspace)
+	{
+		case B_CMAP8 :
+		{
+			setting.bpp = 8;
+			break;
+		}
+		case B_RGB15 :
+		case B_RGBA15 :
+		{
+			setting.bpp = 15;
+			break;
+		}
+		case B_RGB16 :
+		{
+			setting.bpp = 16;
+			break;
+		}
+		case B_RGB32 :
+		case B_RGBA32 :
+		{
+			setting.bpp = 32;
+			break;
+		}
+		default :
+		{
+			setting.bpp = 16;
+		}
+	}
+	
+	display_mode mode;
+	screen.GetMode(&mode);
+	
+	float total_size = mode.timing.h_total * mode.timing.v_total;
+	float refresh_rate = floor((((float)mode.timing.pixel_clock * 1000.0) / ((float)total_size)));
+	
+	setting.xPixels = mode.timing.h_display;
+	setting.yPixels = mode.timing.v_display;
+	setting.frequency = (GHOST_TUns32)refresh_rate;
+
+#ifdef GHOST_DEBUG
+	printf("GHOST_DisplayManagerHaiku::getDisplaySetting() : %ldx%ldx%d refresh_rate:%luHz\n",
+		setting.xPixels, setting.yPixels, setting.bpp, setting.frequency);
+#endif
+
+	return GHOST_kSuccess;		
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::getCurrentDisplaySetting(GHOST_TUns8 display, GHOST_DisplaySetting& setting) const {
+	return getDisplaySetting(display, (GHOST_TInt32)0, setting);
+}
+
+GHOST_TSuccess
+GHOST_DisplayManagerHaiku::setCurrentDisplaySetting(GHOST_TUns8 display, const GHOST_DisplaySetting& setting) {
+	GHOST_PRINT("TODO GHOST_DisplayManagerHaiku::setCurrentDisplaySetting() : TODO\n");
+	return GHOST_kFailure;
+}
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_DisplayManagerHaiku.h ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_DisplayManagerHaiku.h
--- _res/blender-2.47/intern/ghost/intern/GHOST_DisplayManagerHaiku.h	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_DisplayManagerHaiku.h	2008-12-01 22:44:59.000000000 +0100
@@ -0,0 +1,75 @@
+#ifndef _GHOST_DISPLAY_MANAGER_HAIKU_H_
+#define _GHOST_DISPLAY_MANAGER_HAIKU_H_
+
+#include "GHOST_DisplayManager.h"
+
+class GHOST_SystemHaiku;
+
+/**
+ * Haiku GHOST_DisplayManager implementation
+ * @author	Michael Weirauch
+ * @date	2008-10-04
+ * @see		GHOST_DisplayManager
+ */
+class GHOST_DisplayManagerHaiku : public GHOST_DisplayManager {
+public:
+	/**
+	 * Constructor.
+	 */
+	GHOST_DisplayManagerHaiku(void);
+	
+	/**
+	 * Destructor.
+	 */
+	~GHOST_DisplayManagerHaiku(void);
+
+	/**
+	 * Initializes the list with devices and settings.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess initialize(void);
+
+	/**
+	 * Returns the number of display devices on this system.
+	 * @param numDisplays The number of displays on this system.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess getNumDisplays(GHOST_TUns8& numDisplays) const;
+
+	/**
+	 * Returns the number of display settings for this display device.
+	 * @param display The index of the display to query with 0 <= display < getNumDisplays().
+	 * @param setting The number of settings of the display device with this index.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess getNumDisplaySettings(GHOST_TUns8 display, GHOST_TInt32& numSettings) const;
+
+	/**
+	 * Returns the current setting for this display device. 
+	 * @param display The index of the display to query with 0 <= display < getNumDisplays().
+	 * @param index	  The setting index to be returned.
+	 * @param setting The setting of the display device with this index.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess getDisplaySetting(GHOST_TUns8 display, GHOST_TInt32 index, GHOST_DisplaySetting& setting) const;
+
+	/**
+	 * Returns the current setting for this display device. 
+	 * @param display The index of the display to query with 0 <= display < getNumDisplays().
+	 * @param setting The current setting of the display device with this index.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess getCurrentDisplaySetting(GHOST_TUns8 display, GHOST_DisplaySetting& setting) const;
+
+	/**
+	 * Changes the current setting for this display device.
+	 * The setting given to this method is matched againts the available diplay settings.
+	 * The best match is activated (@see findMatch()).
+	 * @param display The index of the display to query with 0 <= display < getNumDisplays().
+	 * @param setting The setting of the display device to be matched and activated.
+	 * @return Indication of success.
+	 */
+	GHOST_TSuccess setCurrentDisplaySetting(GHOST_TUns8 display, const GHOST_DisplaySetting& setting);
+};
+
+#endif /* _GHOST_DISPLAY_MANAGER_HAIKU_H_ */
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_ISystem.cpp ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_ISystem.cpp
--- _res/blender-2.47/intern/ghost/intern/GHOST_ISystem.cpp	2008-12-29 19:15:26.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_ISystem.cpp	2008-12-01 22:44:59.000000000 +0100
@@ -42,12 +42,12 @@
 
 #ifdef WIN32
 #	include "GHOST_SystemWin32.h"
+#elif __APPLE__
+#	include "GHOST_SystemCarbon.h"
+#elif __HAIKU__
+#	include "GHOST_SystemHaiku.h"
 #else
-#	ifdef __APPLE__
-#		include "GHOST_SystemCarbon.h"
-#	else
-#		include "GHOST_SystemX11.h"
-#	endif
+#	include "GHOST_SystemX11.h"
 #endif
 
 
@@ -60,13 +60,13 @@
 	if (!m_system) {
 #ifdef WIN32
 		m_system = new GHOST_SystemWin32 ();
-#else
-#	ifdef __APPLE__
+#elif __APPLE__
         m_system = new GHOST_SystemCarbon ();
-#	else 
+#elif __HAIKU__
+		m_system = new GHOST_SystemHaiku ();
+#else
 		m_system = new GHOST_SystemX11 ();
-#	endif
-#endif 
+#endif
 		success = m_system != 0 ? GHOST_kSuccess : GHOST_kFailure;
 	}
 	else {
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_NDOFManager.cpp ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_NDOFManager.cpp
--- _res/blender-2.47/intern/ghost/intern/GHOST_NDOFManager.cpp	2008-12-29 19:15:26.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_NDOFManager.cpp	2008-12-01 22:44:59.000000000 +0100
@@ -28,7 +28,7 @@
 // the variable is outside the class because it must be accessed from plugin
 static volatile GHOST_TEventNDOFData currentNdofValues = {0,0,0,0,0,0,0,0,0,0,0};
 
-#if !defined(_WIN32) && !defined(__APPLE__)
+#if !defined(_WIN32) && !defined(__APPLE__) && !defined(__HAIKU__)
 #include "GHOST_SystemX11.h"
 #endif
 
@@ -76,7 +76,7 @@
 #if 0
        	printf("%i client \n", Pid);
 #endif
-		#if defined(_WIN32) || defined(__APPLE__)
+		#if defined(_WIN32) || defined(__APPLE__) || defined(__HAIKU__)
 			m_DeviceHandle = ndofDeviceOpen((void *)&currentNdofValues);    
 		#else
 			GHOST_SystemX11 *sys;
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_SystemHaiku.cpp ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_SystemHaiku.cpp
--- _res/blender-2.47/intern/ghost/intern/GHOST_SystemHaiku.cpp	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_SystemHaiku.cpp	2008-12-01 22:44:59.000000000 +0100
@@ -0,0 +1,129 @@
+#include "GHOST_Debug.h"
+#include "GHOST_SystemHaiku.h"
+#include "GHOST_WindowHaiku.h"
+#include "GHOST_WindowManager.h"
+
+GHOST_SystemHaiku::GHOST_SystemHaiku()
+	: fDisplayManager(NULL),
+	fApplication(NULL)
+{
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::init()
+{
+	GHOST_PRINT("GHOST_SystemHaiku::init()\n");
+	
+	if (GHOST_kSuccess != GHOST_System::init()) {
+		cout << "GHOST_SystemHaiku::init() : GHOST_System::init() failed!" << endl;
+		return GHOST_kFailure;
+	}
+
+	fApplication = new BApplication("application/x-vnd.GHOST.BApplication");
+	
+//	thread_id appThread = spawn_thread(GHOST_SystemHaiku::BApplicationThread,
+//		"GHOST.BApplication", B_NORMAL_PRIORITY, 0);
+//	if (appThread == B_NO_MORE_THREADS) {
+//		GHOST_PRINT("GHOST_SystemHaiku::init() : Reached maximum number of threads!\n");
+//		return GHOST_kFailure;
+//	}
+//	if (appThread == B_NO_MEMORY) {
+//		GHOST_PRINT( "GHOST_SystemHaiku::init() : Not enough memory to allocate the resources for another thread.\n");
+//		return GHOST_kFailure;
+//	}
+	
+	// TODO: It seems the application is not necessary to be Run()ed.
+	/* Resume the initially suspended thread. */
+//	if (B_OK != resume_thread(appThread))
+//		return GHOST_kFailure;
+	
+	fDisplayManager = new GHOST_DisplayManagerHaiku();	
+	
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::exit()
+{
+	GHOST_PRINT("GHOST_SystemHaiku::exit()\n");
+	fApplication->Quit();
+	return GHOST_System::exit();
+}
+
+GHOST_TUns8
+GHOST_SystemHaiku::getNumDisplays() const
+{
+	GHOST_TUns8 numDisplays;
+	fDisplayManager->getNumDisplays(numDisplays);
+	return numDisplays;
+}
+
+void
+GHOST_SystemHaiku::getMainDisplayDimensions(GHOST_TUns32& width, GHOST_TUns32& height) const
+{
+	//GHOST_PRINT("GHOST_SystemHaiku::getMainDisplayDimensions()\n");
+	GHOST_DisplaySetting setting;
+	fDisplayManager->getDisplaySetting((GHOST_TUns8)0, (GHOST_TInt32)0, setting);
+	width = setting.xPixels;
+	height = setting.yPixels;
+}
+
+GHOST_IWindow*
+GHOST_SystemHaiku::createWindow(
+		const STR_String& title,
+		GHOST_TInt32 left, GHOST_TInt32 top, GHOST_TUns32 width, GHOST_TUns32 height,
+		GHOST_TWindowState state, GHOST_TDrawingContextType type,
+		const bool stereoVisual)
+{
+	GHOST_WindowHaiku* window = new GHOST_WindowHaiku(
+		this, title, left, top, width, height, state, type, stereoVisual);
+
+	m_windowManager->addWindow(window);
+
+	return window;
+}
+
+bool
+GHOST_SystemHaiku::processEvents(bool waitForEvent)
+{
+	// TODO
+	//GHOST_PRINT("TODO GHOST_SystemHaiku::processEvents()");
+	return true;
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::getCursorPosition(GHOST_TInt32& x, GHOST_TInt32& y) const
+{
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::setCursorPosition(GHOST_TInt32 x, GHOST_TInt32 y) const
+{
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::getModifierKeys(GHOST_ModifierKeys& keys) const
+{
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_SystemHaiku::getButtons(GHOST_Buttons& buttons) const
+{
+	return GHOST_kFailure;
+}
+
+GHOST_TUns8*
+GHOST_SystemHaiku::getClipboard(int flag) const
+{
+	// TODO
+	return NULL;
+}
+
+void
+GHOST_SystemHaiku::putClipboard(GHOST_TInt8 *buffer, int flag) const
+{
+	// TODO
+}
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_SystemHaiku.h ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_SystemHaiku.h
--- _res/blender-2.47/intern/ghost/intern/GHOST_SystemHaiku.h	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_SystemHaiku.h	2008-12-01 22:44:59.000000000 +0100
@@ -0,0 +1,145 @@
+#ifndef _GHOST_SYSTEM_HAIKU_H_
+#define _GHOST_SYSTEM_HAIKU_H_
+
+#include "GHOST_System.h"
+#include "../GHOST_Types.h"
+#include "GHOST_DisplayManagerHaiku.h"
+
+#include <Application.h>
+
+/**
+ * Haiku GHOST_System implementation
+ * @author	Michael Weirauch
+ * @date	2008-10-04
+ * @see		GHOST_System
+ */
+class GHOST_SystemHaiku : public GHOST_System
+{
+public:
+	GHOST_SystemHaiku();
+
+	/**
+	 * Initialize the system.
+	 * @return Indication of success.
+	 */
+	virtual GHOST_TSuccess init();
+
+	static int32 BApplicationThread(void* arg) {
+		// TODO investigate why the look is necessary here.
+		be_app->Lock();
+		return be_app->Run();
+	}
+
+	/**
+	 * Shut the system down.
+	 * @return Indication of success.
+	 */
+	virtual GHOST_TSuccess exit();
+
+	/***************************************************************************************
+	 ** Display/window management functionality
+	 ***************************************************************************************/
+
+	/**
+	 * Returns the number of displays on this system.
+	 * @return The number of displays.
+	 */
+	virtual	GHOST_TUns8 getNumDisplays() const;
+	
+		/**
+	 * Returns the dimensions of the main display on this system.
+	 * @return The dimension of the main display.
+	 */
+	virtual void getMainDisplayDimensions(GHOST_TUns32& width, GHOST_TUns32& height) const;
+	
+	/**
+	 * Create a new window.
+	 * The new window is added to the list of windows managed. 
+	 * Never explicitly delete the window, use disposeWindow() instead.
+	 * @param	title	The name of the window (displayed in the title bar of the window if the OS supports it).
+	 * @param	left		The coordinate of the left edge of the window.
+	 * @param	top		The coordinate of the top edge of the window.
+	 * @param	width		The width the window.
+	 * @param	height		The height the window.
+	 * @param	state		The state of the window when opened.
+	 * @param	type		The type of drawing context installed in this window.
+	 * @param	stereoVisual	Create a stereo visual for quad buffered stereo.
+	 * @return	The new window (or 0 if creation failed).
+	 */
+	virtual GHOST_IWindow* createWindow(
+		const STR_String& title,
+		GHOST_TInt32 left, GHOST_TInt32 top, GHOST_TUns32 width, GHOST_TUns32 height,
+		GHOST_TWindowState state, GHOST_TDrawingContextType type,
+		const bool stereoVisual);
+
+	/***************************************************************************************
+	 ** Event management functionality
+	 ***************************************************************************************/
+
+	/**
+	 * Retrieves events from the system and stores them in the queue.
+	 * @param waitForEvent Flag to wait for an event (or return immediately).
+	 * @return Indication of the presence of events.
+	 */
+	virtual bool processEvents(bool waitForEvent);
+
+	/***************************************************************************************
+	 ** Cursor management functionality
+	 ***************************************************************************************/
+
+	/**
+	 * Returns the current location of the cursor (location in screen coordinates)
+	 * @param x			The x-coordinate of the cursor.
+	 * @param y			The y-coordinate of the cursor.
+	 * @return			Indication of success.
+	 */
+	virtual GHOST_TSuccess getCursorPosition(GHOST_TInt32& x, GHOST_TInt32& y) const;
+
+	/**
+	 * Updates the location of the cursor (location in screen coordinates).
+	 * Not all operating systems allow the cursor to be moved (without the input device being moved).
+	 * @param x			The x-coordinate of the cursor.
+	 * @param y			The y-coordinate of the cursor.
+	 * @return			Indication of success.
+	 */
+	virtual GHOST_TSuccess setCursorPosition(GHOST_TInt32 x, GHOST_TInt32 y) const;
+	
+	/***************************************************************************************
+	 ** Other (internal) functionality.
+	 ***************************************************************************************/
+
+	/**
+	 * Returns the state of all modifier keys.
+	 * @param keys	The state of all modifier keys (true == pressed).
+	 * @return		Indication of success.
+	 */
+	virtual GHOST_TSuccess getModifierKeys(GHOST_ModifierKeys& keys) const;
+
+	/**
+	 * Returns the state of the mouse buttons (ouside the message queue).
+	 * @param buttons	The state of the buttons.
+	 * @return			Indication of success.
+	 */
+	virtual GHOST_TSuccess getButtons(GHOST_Buttons& buttons) const;
+	
+	/**
+	 * Returns the selection buffer
+	 * @param flag		Only used on X11
+	 * @return 		Returns the clipboard data
+	 */
+	 virtual GHOST_TUns8* getClipboard(int flag) const;
+
+	/**
+	 * Put data to the Clipboard
+	 * @param buffer	The buffer to copy to the clipboard
+	 * @param flag	The clipboard to copy too only used on X11
+	 */
+	virtual void putClipboard(GHOST_TInt8 *buffer, int flag) const;
+
+private:
+	GHOST_DisplayManagerHaiku* fDisplayManager;
+
+	BApplication* fApplication;
+};
+
+#endif /* _GHOST_SYSTEM_HAIKU_H_ */
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_WindowHaiku.cpp ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_WindowHaiku.cpp
--- _res/blender-2.47/intern/ghost/intern/GHOST_WindowHaiku.cpp	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_WindowHaiku.cpp	2008-12-29 19:13:13.000000000 +0100
@@ -0,0 +1,554 @@
+#include "GHOST_Debug.h"
+#include "GHOST_Event.h"
+#include "GHOST_EventButton.h"
+#include "GHOST_EventCursor.h"
+#include "GHOST_EventWheel.h"
+#include "GHOST_Window.h"
+#include "GHOST_WindowHaiku.h"
+
+#include <Application.h>
+
+GHOST_WindowHaiku::GHOST_WindowHaiku(
+		GHOST_System* system,
+		const STR_String& title, 
+		GHOST_TInt32 left,
+		GHOST_TInt32 top,
+		GHOST_TUns32 width,
+		GHOST_TUns32 height,
+		GHOST_TWindowState state,
+		GHOST_TDrawingContextType type = GHOST_kDrawingContextTypeNone,
+		const bool stereoVisual = false)
+	: GHOST_Window(title,left,top,width,height,state,type,stereoVisual),
+	fWindow(NULL)
+{
+#ifdef GHOST_DEBUG
+	printf("GHOST_WindowHaiku::GHOST_WindowHaiku(%s)\n", (const char*)title);
+#endif
+	BRect frame(left, top, left + width, top + height);
+	fWindow = new GHOSTBWindow(
+		system,
+		this,
+		frame,
+		title,
+		B_TITLED_WINDOW_LOOK,
+		B_NORMAL_WINDOW_FEEL, 0);
+	// TODO respect state input param!
+	fWindow->Show();
+}
+
+bool
+GHOST_WindowHaiku::getValid() const
+{
+	GHOST_PRINT("GHOST_WindowHaiku::getValid()\n");
+	return NULL != fWindow;
+}
+
+void
+GHOST_WindowHaiku::setTitle(const STR_String& title)
+{
+	fWindow->SetTitle(title);
+}
+
+void
+GHOST_WindowHaiku::getTitle(STR_String& title) const
+{
+	const char* wTitle = fWindow->Title();
+	if (!wTitle)
+		title = wTitle;
+}
+
+void
+GHOST_WindowHaiku::getWindowBounds(GHOST_Rect& bounds) const
+{
+	BRect windowBounds = fWindow->Frame();
+	bounds.set(
+		windowBounds.left,
+		windowBounds.top,
+		windowBounds.right,
+		windowBounds.bottom);
+}
+
+void
+GHOST_WindowHaiku::getClientBounds(GHOST_Rect& bounds) const
+{
+	BRect windowBounds = fWindow->Bounds();
+	bounds.set(
+		0,
+		0,
+		windowBounds.right,
+		windowBounds.bottom);
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setClientWidth(GHOST_TUns32 width)
+{
+	BRect bounds = fWindow->Bounds();
+	fWindow->ResizeTo(width, bounds.bottom);
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setClientHeight(GHOST_TUns32 height)
+{
+	BRect bounds = fWindow->Bounds();
+	fWindow->ResizeTo(bounds.right, height);
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setClientSize(GHOST_TUns32 width, GHOST_TUns32 height)
+{
+	fWindow->ResizeTo(width, height);
+	return GHOST_kSuccess;
+}
+
+void
+GHOST_WindowHaiku::screenToClient(GHOST_TInt32 inX, GHOST_TInt32 inY, GHOST_TInt32& outX, GHOST_TInt32& outY) const
+{
+	//GHOST_PRINT("GHOST_WindowHaiku::screenToClient()\n");
+	
+	/*
+	 * The mouse coordinates fired in GHOSTBWindow are
+	 * already in client coordinates.
+	 */
+	outX = inX;
+	outY = inY;
+}
+
+void
+GHOST_WindowHaiku::clientToScreen(GHOST_TInt32 inX, GHOST_TInt32 inY, GHOST_TInt32& outX, GHOST_TInt32& outY) const
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::clientToScreen() : TODO\n");
+}
+
+GHOST_TWindowState
+GHOST_WindowHaiku::getState() const
+{
+	// TODO other states
+	if (fWindow->IsMinimized())
+		return GHOST_kWindowStateMinimized;
+	else
+		return GHOST_kWindowStateNormal;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setState(GHOST_TWindowState state)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::setState() : TODO\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setOrder(GHOST_TWindowOrder order)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::setOrder() : TODO\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::swapBuffers()
+{
+	if (m_drawingContextType == GHOST_kDrawingContextTypeOpenGL) {
+		GHOST_PRINT("GHOST_WindowHaiku::swapBuffers(Success)\n");
+		fWindow->View()->SwapBuffers();
+		return GHOST_kSuccess;
+	}
+	GHOST_PRINT("GHOST_WindowHaiku::swapBuffers(No openGL context)\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::activateDrawingContext()
+{
+	// TODO investigate
+	if (m_drawingContextType == GHOST_kDrawingContextTypeOpenGL) {
+		GHOST_PRINT("GHOST_WindowHaiku::activateDrawingContext(OK) : INVESTIGATE\n");
+		//fWindow->View()->LockGL();
+		// FIXME aquire/makecurrent the context here?
+		//fWindow->InstantiateContext();
+		return GHOST_kSuccess;
+	}
+	GHOST_PRINT("GHOST_WindowHaiku::activateDrawingContext(Failure) : INVESTIGATE\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::invalidate()
+{
+	// TODO investigate
+	GHOST_PRINT("GHOST_WindowHaiku::invalidate()\n");
+	fWindow->UpdateIfNeeded();
+	return GHOST_kSuccess;
+}
+
+const GHOST_TabletData*
+GHOST_WindowHaiku::GetTabletData()
+{
+	// TODO
+	return NULL;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::installDrawingContext(GHOST_TDrawingContextType type)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::installDrawingContext() : TODO\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::removeDrawingContext()
+{
+	// TODO investigate
+	GHOST_PRINT("GHOST_WindowHaiku::removeDrawingContext() : TODO\n");
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setWindowCursorVisibility(bool visible)
+{
+	GHOST_PRINT("GHOST_WindowHaiku::setWindowCursorVisibility()\n");
+	if (visible)
+		be_app->ShowCursor();
+	else
+		be_app->HideCursor();
+	
+	return GHOST_kSuccess;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setWindowCursorShape(GHOST_TStandardCursor shape)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::setWindowCursorShape() : TODO\n");
+	return GHOST_kFailure;
+}
+
+GHOST_TSuccess
+GHOST_WindowHaiku::setWindowCustomCursorShape(GHOST_TUns8 bitmap[16][2], GHOST_TUns8 mask[16][2],
+							 int hotX, int hotY)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::setWindowCustomCursorShape() : TODO\n");
+	return GHOST_kFailure;
+}
+							 
+GHOST_TSuccess
+GHOST_WindowHaiku::setWindowCustomCursorShape(GHOST_TUns8 *bitmap, GHOST_TUns8 *mask, 
+						int szx, int szy, int hotX, int hotY, int fg, int bg)
+{
+	// TODO
+	GHOST_PRINT("GHOST_WindowHaiku::setWindowCustomCursorShape() : TODO\n");
+	return GHOST_kFailure;
+}
+
+/*
+ * GHOSTBWindow
+ */
+
+GHOSTBWindow::GHOSTBWindow(GHOST_System* system, GHOST_Window* window,
+	BRect frame, const char* title,
+	window_look look, window_feel feel, uint32 flags,
+	uint32 workspace = B_CURRENT_WORKSPACE)
+	: BWindow(frame, title, look, feel, flags, workspace),
+	fGSystem(system),
+	fGWindow(window),
+	fView(NULL),
+	fLastMouseButton(0)
+{
+	InstantiateContext();
+}
+
+void
+GHOSTBWindow::InstantiateContext() {
+	fView = new BGLView(
+		Bounds(),
+		"GHOST.BGLView",
+		B_FOLLOW_ALL,
+		0,
+		BGL_RGB | BGL_DOUBLE | BGL_DEPTH | BGL_ALPHA | BGL_STENCIL
+		);
+	AddChild(fView);
+}
+
+void
+GHOSTBWindow::DispatchMessage(
+	BMessage* msg, BHandler* target)
+{
+	GHOST_Event* event = NULL;
+	bool dispatch = true;
+	switch (msg->what)
+	{
+//		case B_KEY_DOWN :
+//		case B_KEY_UP :
+//		{			
+//			int8 bbyte = 0;
+//			int32 bkey = 0;
+//			
+//			msg->FindInt8( "byte", &bbyte );
+//			msg->FindInt32( "key", &bkey );
+//			
+//			GHOST_TKey gkey = GHOST_kKeyUnknown;
+//			
+//			if( ( bbyte >= 'A' ) && ( bbyte <= 'Z' ) )
+//			{
+//				gkey = GHOST_TKey( bbyte - 'A' + int( GHOST_kKeyA ) );
+//			}
+//			else if( ( bbyte >= 'a' ) && ( bbyte <= 'z' ) )
+//			{
+//				gkey = GHOST_TKey( bbyte - 'a' + int( GHOST_kKeyA ) );
+//			}
+//			else if( ( bkey >= B_F1_KEY ) && ( bkey <= B_F12_KEY ) )
+//			{
+//				gkey = GHOST_TKey( bkey - B_F1_KEY + int( GHOST_kKeyF1 ) );
+//			}
+//			else
+//			{				
+//				/* multibyte character recognition could go in here */
+//				
+//				if( gkey == GHOST_kKeyUnknown )
+//				{
+//					switch( bkey )
+//					{
+//						/* Numpad keys */
+//						case 0x64 :		gkey = GHOST_kKeyNumpad0;			break;
+//						case 0x58 :		gkey = GHOST_kKeyNumpad1;			break;
+//						case 0x59 :		gkey = GHOST_kKeyNumpad2;			break;
+//						case 0x5a :		gkey = GHOST_kKeyNumpad3;			break;
+//						case 0x48 :		gkey = GHOST_kKeyNumpad4;			break;
+//						case 0x49 :		gkey = GHOST_kKeyNumpad5;			break;
+//						case 0x4a :		gkey = GHOST_kKeyNumpad6;			break;
+//						case 0x37 :		gkey = GHOST_kKeyNumpad7;			break;
+//						case 0x38 :		gkey = GHOST_kKeyNumpad8;			break;
+//						case 0x39 :		gkey = GHOST_kKeyNumpad9;			break;
+//						case 0x65 :		gkey = GHOST_kKeyNumpadPeriod;		break;
+//						case 0x5b :		gkey = GHOST_kKeyNumpadEnter;		break;
+//						case 0x3a :		gkey = GHOST_kKeyNumpadPlus;		break;
+//						case 0x25 :		gkey = GHOST_kKeyNumpadMinus;		break;
+//						case 0x24 :		gkey = GHOST_kKeyNumpadAsterisk;	break;
+//						case 0x23 :		gkey = GHOST_kKeyNumpadSlash;		break;
+//
+// 						/* Other keys */
+//						case 0x1e :		gkey = GHOST_kKeyBackSpace;			break;
+//						case 0x26 :		gkey = GHOST_kKeyTab;				break;
+//						case 0x47 :		gkey = GHOST_kKeyEnter;				break;
+//						case 0x1  :		gkey = GHOST_kKeyEsc;				break;
+//						case 0x5e :		gkey = GHOST_kKeySpace;				break;
+//						
+// 						/* Arrow keys */
+// 						case 0x61 : 	gkey = GHOST_kKeyLeftArrow;			break;
+// 						case 0x63 :		gkey = GHOST_kKeyRightArrow;		break;
+// 						case 0x57 :		gkey = GHOST_kKeyUpArrow;			break;
+// 						case 0x62 :		gkey = GHOST_kKeyDownArrow;			break;
+// 						
+// 						/* Navigation keys */
+// 						case 0x1f :		gkey = GHOST_kKeyInsert;			break;
+// 						case 0x32 :		gkey = GHOST_kKeyDelete;			break;
+// 						case 0x20 :		gkey = GHOST_kKeyHome;				break;
+// 						case 0x35 : 	gkey = GHOST_kKeyEnd;				break;
+// 						case 0x21 :		gkey = GHOST_kKeyUpPage;			break;
+// 						case 0x36 :		gkey = GHOST_kKeyDownPage;			break;
+//					}
+//				}
+//				
+//				if( gkey == GHOST_kKeyUnknown )
+//				{
+//					switch( bbyte )
+//					{
+//						/* normal Number keys */
+//						case 0x30 :		gkey = GHOST_kKey0;					break;
+//						case 0x31 :		gkey = GHOST_kKey1;					break;
+//						case 0x32 :		gkey = GHOST_kKey2;					break;
+//						case 0x33 :		gkey = GHOST_kKey3;					break;
+//						case 0x34 :		gkey = GHOST_kKey4;					break;
+//						case 0x35 :		gkey = GHOST_kKey5;					break;
+//						case 0x36 :		gkey = GHOST_kKey6;					break;
+//						case 0x37 :		gkey = GHOST_kKey7;					break;
+//						case 0x38 :		gkey = GHOST_kKey8;					break;
+//						case 0x39 :		gkey = GHOST_kKey9;					break;
+//						
+//						/* additional keys */
+//						case 0x22 : 	gkey = GHOST_kKeyQuote;				break;
+// 						case 0x2c :		gkey = GHOST_kKeyComma;				break;
+// 						case 0x2d :		gkey = GHOST_kKeyMinus;				break;
+// 						case 0x2e :		gkey = GHOST_kKeyPeriod;			break;
+//						case 0x2f :		gkey = GHOST_kKeySlash;				break;
+//						case 0x3b :		gkey = GHOST_kKeySemicolon;			break;
+//						case 0x3d : 	gkey = GHOST_kKeyEqual;				break;
+//						case 0x5b :		gkey = GHOST_kKeyLeftBracket;		break;
+//						case 0x5c :		gkey = GHOST_kKeyBackslash;			break;
+//						case 0x5d :		gkey = GHOST_kKeyRightBracket;		break;
+//						case 0x60 :		gkey = GHOST_kKeyAccentGrave;		break;
+//					}
+//				}
+//
+//				/* Unhandled GHOST keys: */
+//				// GHOST_kKeyLineFeed ?
+//				// GHOST_kKeyClear ?
+//			}
+//			
+//			GHOST_TEventType type;
+//			if( msg->what == B_KEY_DOWN )
+//				type = GHOST_kEventKeyDown;
+//			else
+//				type = GHOST_kEventKeyUp;
+//			
+//			fWindowZETA->getSystemZETA()->pushEvent(
+//				new GHOST_EventKey(
+//					fWindowZETA->getSystemZETA()->getMilliSeconds(),
+//					type,
+//					fWindowZETA,
+//					gkey,
+//					bbyte ) );
+//			
+//			/* needs to be forwarded */
+//			BWindow::DispatchMessage( msg, target );
+//			
+//			break;
+//		}
+		case B_MOUSE_DOWN :
+		case B_MOUSE_UP :
+		{
+			GHOST_TButtonMask bmask = GHOST_kButtonMaskLeft;
+			int32 buttons;
+			msg->FindInt32("buttons", &buttons);
+			
+			/*
+			 * As the B_MOUSE_UP message doesnt tell which button was released,
+			 * we store the last button further below in fLastMouseButton.
+			 * When we receive the B_MOUSE_UP, we switch(fLastMouseButton)
+			 * instead against buttons.
+			 */
+			
+			switch(msg->what == B_MOUSE_DOWN ? buttons : fLastMouseButton)
+			{
+				case B_PRIMARY_MOUSE_BUTTON :
+				{
+					bmask = GHOST_kButtonMaskLeft;
+					break;
+				}
+				case B_SECONDARY_MOUSE_BUTTON :
+				{
+					bmask = GHOST_kButtonMaskRight;
+					break;
+				}
+				case B_TERTIARY_MOUSE_BUTTON :
+				{
+					bmask = GHOST_kButtonMaskMiddle;
+					break;
+				}
+			}
+			
+			GHOST_TEventType type;			
+			if (msg->what == B_MOUSE_DOWN)
+			{
+				fLastMouseButton = buttons;
+				type = GHOST_kEventButtonDown;
+			}
+			else
+			{
+				type = GHOST_kEventButtonUp;
+			}
+			
+			// FIXME use message time????????
+			event = new GHOST_EventButton(
+					fGSystem->getMilliSeconds(),
+					type,
+					fGWindow,
+					bmask);
+			break;
+		}
+		case B_MOUSE_MOVED :
+		{
+			BPoint point;
+			msg->FindPoint("where", &point);
+			
+			// FIXME use message time????????
+			event = new GHOST_EventCursor(
+					fGSystem->getMilliSeconds(),
+					GHOST_kEventCursorMove,
+					fGWindow,
+					point.x,
+					point.y);
+			break;
+		}
+		case B_MOUSE_WHEEL_CHANGED :
+		{
+			float value;
+			msg->FindFloat("be:wheel_delta_y", &value);
+				
+			//value *= 3;	/* dunno if to unprecise */
+			
+			// FIXME use message time????????
+			event = new GHOST_EventWheel(
+					fGSystem->getMilliSeconds(),
+					fGWindow,
+					floor(value));
+			break;
+		}
+		case B_WINDOW_ACTIVATED :
+		{
+			bool active;
+			msg->FindBool("active", &active);
+			
+			GHOST_TEventType type;
+			if (active)
+				type = GHOST_kEventWindowActivate;
+			else
+				type = GHOST_kEventWindowDeactivate;
+			
+			// FIXME use message time????????
+			event = new GHOST_Event(
+					fGSystem->getMilliSeconds(),
+					type,
+					fGWindow);
+			dispatch = false; // FIXME WHY?
+			break;
+		}
+		case B_WINDOW_RESIZED :
+		{
+			// FIXME use message time????????
+			event = new GHOST_Event(
+					fGSystem->getMilliSeconds(),
+					GHOST_kEventWindowSize,
+					fGWindow);
+			break;
+		}
+		case B_QUIT_REQUESTED :
+		{
+			// FIXME use message time????????
+			event = new GHOST_Event(
+					fGSystem->getMilliSeconds(),
+					GHOST_kEventWindowClose,
+					fGWindow);
+			/* Don't dispatch. */
+			dispatch = false;
+			break;
+		}
+		case _UPDATE_ :
+		case _UPDATE_IF_NEEDED_ :
+		{
+			// FIXME use message time????????
+			event = new GHOST_Event(
+					fGSystem->getMilliSeconds(),
+					GHOST_kEventWindowUpdate,
+					fGWindow);
+			break;
+		}
+		default :
+		{
+			BWindow::DispatchMessage(msg, target);
+		}
+	}
+	
+	if (dispatch) {
+		BWindow::DispatchMessage(msg, target);
+	}
+	
+	if (event) {
+		fGSystem->pushEvent(event);
+	}
+}
diff -Naur _res/blender-2.47/intern/ghost/intern/GHOST_WindowHaiku.h ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_WindowHaiku.h
--- _res/blender-2.47/intern/ghost/intern/GHOST_WindowHaiku.h	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/intern/ghost/intern/GHOST_WindowHaiku.h	2008-12-01 22:44:59.000000000 +0100
@@ -0,0 +1,216 @@
+#ifndef _GHOST_WINDOW_HAIKU_H_
+#define _GHOST_WINDOW_HAIKU_H_
+
+#include "GHOST_System.h"
+#include "GHOST_Window.h"
+
+#include <GLView.h>
+
+class GHOSTBWindow;
+
+class GHOST_WindowHaiku : public GHOST_Window
+{
+public:
+	/**
+	 * Constructor.
+	 * Creates a new window and opens it.
+	 * To check if the window was created properly, use the getValid() method.
+	 * @param title		The text shown in the title bar of the window.
+	 * @param left		The coordinate of the left edge of the window.
+	 * @param top		The coordinate of the top edge of the window.
+	 * @param width		The width the window.
+	 * @param heigh		The height the window.
+	 * @param state		The state the window is initially opened with.
+	 * @param type		The type of drawing context installed in this window.
+	 * @param stereoVisual	Stereo visual for quad buffered stereo.
+	 */
+	GHOST_WindowHaiku(
+		GHOST_System* system,
+		const STR_String& title, 
+		GHOST_TInt32 left,
+		GHOST_TInt32 top,
+		GHOST_TUns32 width,
+		GHOST_TUns32 height,
+		GHOST_TWindowState state,
+		GHOST_TDrawingContextType type = GHOST_kDrawingContextTypeNone,
+		const bool stereoVisual = false);
+
+	/**
+	 * Returns indication as to whether the window is valid.
+	 * @return The validity of the window.
+	 */
+	virtual	bool getValid() const;
+
+	/**
+	 * Sets the title displayed in the title bar.
+	 * @param title	The title to display in the title bar.
+	 */
+	virtual void setTitle(const STR_String& title);
+
+	/**
+	 * Returns the title displayed in the title bar.
+	 * @param title	The title displayed in the title bar.
+	 */
+	virtual void getTitle(STR_String& title) const;
+
+	/**
+	 * Returns the window rectangle dimensions.
+	 * These are screen coordinates.
+	 * @param bounds The bounding rectangle of the window.
+	 */
+	virtual	void getWindowBounds(GHOST_Rect& bounds) const;
+	
+	/**
+	 * Returns the client rectangle dimensions.
+	 * The left and top members of the rectangle are always zero.
+	 * @param bounds The bounding rectangle of the client area of the window.
+	 */
+	virtual	void getClientBounds(GHOST_Rect& bounds) const;
+
+	/**
+	 * Resizes client rectangle width.
+	 * @param width The new width of the client area of the window.
+	 */
+	virtual	GHOST_TSuccess setClientWidth(GHOST_TUns32 width);
+
+	/**
+	 * Resizes client rectangle height.
+	 * @param height The new height of the client area of the window.
+	 */
+	virtual	GHOST_TSuccess setClientHeight(GHOST_TUns32 height);
+
+	/**
+	 * Resizes client rectangle.
+	 * @param width		The new width of the client area of the window.
+	 * @param height	The new height of the client area of the window.
+	 */
+	virtual	GHOST_TSuccess setClientSize(GHOST_TUns32 width, GHOST_TUns32 height);
+
+	/**
+	 * Converts a point in screen coordinates to client rectangle coordinates
+	 * @param inX	The x-coordinate on the screen.
+	 * @param inY	The y-coordinate on the screen.
+	 * @param outX	The x-coordinate in the client rectangle.
+	 * @param outY	The y-coordinate in the client rectangle.
+	 */
+	virtual	void screenToClient(GHOST_TInt32 inX, GHOST_TInt32 inY, GHOST_TInt32& outX, GHOST_TInt32& outY) const;
+
+	/**
+	 * Converts a point in screen coordinates to client rectangle coordinates
+	 * @param inX	The x-coordinate in the client rectangle.
+	 * @param inY	The y-coordinate in the client rectangle.
+	 * @param outX	The x-coordinate on the screen.
+	 * @param outY	The y-coordinate on the screen.
+	 */
+	virtual	void clientToScreen(GHOST_TInt32 inX, GHOST_TInt32 inY, GHOST_TInt32& outX, GHOST_TInt32& outY) const;
+
+	/**
+	 * Returns the state of the window (normal, minimized, maximized).
+	 * @return The state of the window.
+	 */
+	virtual GHOST_TWindowState getState() const;
+
+	/**
+	 * Sets the state of the window (normal, minimized, maximized).
+	 * @param state The state of the window.
+	 * @return Indication of success.
+	 */
+	virtual GHOST_TSuccess setState(GHOST_TWindowState state);
+
+	/**
+	 * Sets the order of the window (bottom, top).
+	 * @param order The order of the window.
+	 * @return Indication of success.
+	 */
+	virtual GHOST_TSuccess setOrder(GHOST_TWindowOrder order);
+
+	/**
+	 * Swaps front and back buffers of a window.
+	 * @return	A boolean success indicator.
+	 */
+	virtual GHOST_TSuccess swapBuffers();
+
+	/**
+	 * Activates the drawing context of this window.
+	 * @return	A boolean success indicator.
+	 */
+	virtual GHOST_TSuccess activateDrawingContext();
+
+	/**
+	 * Invalidates the contents of this window.
+	 * @return Indication of success.
+	 */
+	virtual GHOST_TSuccess invalidate();
+
+	/**
+	 * Returns the tablet data (pressure etc).
+	 * @return The tablet data (pressure etc).
+	 */
+	virtual const GHOST_TabletData* GetTabletData();
+
+	/**
+	 * Tries to install a rendering context in this window.
+	 * @param type	The type of rendering context installed.
+	 * @return Indication as to whether installation has succeeded.
+	 */
+	virtual GHOST_TSuccess installDrawingContext(GHOST_TDrawingContextType type);
+
+	/**
+	 * Removes the current drawing context.
+	 * @return Indication as to whether removal has succeeded.
+	 */
+	virtual GHOST_TSuccess removeDrawingContext();
+
+	/**
+	 * Sets the cursor visibility on the window using
+	 * native window system calls.
+	 */
+	virtual GHOST_TSuccess setWindowCursorVisibility(bool visible);
+	
+	/**
+	 * Sets the cursor shape on the window using
+	 * native window system calls.
+	 */
+	virtual GHOST_TSuccess setWindowCursorShape(GHOST_TStandardCursor shape);
+
+	/**
+	 * Sets the cursor shape on the window using
+	 * native window system calls.
+	 */
+	virtual GHOST_TSuccess setWindowCustomCursorShape(GHOST_TUns8 bitmap[16][2], GHOST_TUns8 mask[16][2],
+							 int hotX, int hotY);
+	
+	virtual GHOST_TSuccess setWindowCustomCursorShape(GHOST_TUns8 *bitmap, GHOST_TUns8 *mask, 
+						int szx, int szy, int hotX, int hotY, int fg, int bg);
+						
+private:
+	GHOSTBWindow* fWindow;
+};
+
+#include <Window.h>
+
+class GHOSTBWindow : public BWindow
+{
+public:
+	GHOSTBWindow(GHOST_System* system, GHOST_Window* window,
+		BRect frame, const char* title,
+		window_look look, window_feel feel, uint32 flags,
+		uint32 workspace = B_CURRENT_WORKSPACE);
+
+	virtual void DispatchMessage(BMessage* msg, BHandler* target);
+
+	void InstantiateContext();
+
+	BGLView* View() { return fView; };
+
+private:
+	GHOST_System* fGSystem;
+
+	GHOST_Window* fGWindow;
+
+	BGLView* fView;
+	
+	int32 fLastMouseButton;
+};
+
+#endif // _GHOST_WINDOW_HAIKU_H_
diff -Naur _res/blender-2.47/source/blender/blenlib/intern/storage.c ./blender-2.47-haiku-1/source/blender/blenlib/intern/storage.c
--- _res/blender-2.47/source/blender/blenlib/intern/storage.c	2008-12-29 19:15:44.000000000 +0100
+++ ./blender-2.47-haiku-1/source/blender/blenlib/intern/storage.c	2008-12-01 22:45:00.000000000 +0100
@@ -47,7 +47,7 @@
 #include <time.h>
 #include <sys/stat.h>
 
-#if defined (__sun__) || defined (__sun)
+#if defined (__sun__) || defined (__sun) || defined(__HAIKU__)
 #include <sys/statvfs.h> /* Other modern unix os's should probably use this also */
 #elif !defined(__FreeBSD__) && !defined(linux) && (defined(__sgi) || defined(__sparc) || defined(__sparc__))
 #include <sys/statfs.h>
@@ -77,7 +77,7 @@
 
 
 #include <fcntl.h>
-#if !defined(__BeOS) && !defined(WIN32)
+#if !defined(__BeOS) && !defined(WIN32) && !defined(__HAIKU__)
 #include <sys/mtio.h>			/* tape comando's */
 #endif
 #include <string.h>			/* strcpy etc.. */
@@ -179,7 +179,7 @@
 	return (double) (freec*bytesps*sectorspc);
 #else
 
-#if defined (__sun__) || defined (__sun)
+#if defined (__sun__) || defined (__sun) || defined(__HAIKU__)
 	struct statvfs disk;
 #else
 	struct statfs disk;
@@ -204,7 +204,7 @@
 	return -1;
 #endif
 
-#if defined (__sun__) || defined (__sun)
+#if defined (__sun__) || defined (__sun) || defined(__HAIKU__)
 	if (statvfs(name, &disk)) return(-1);	
 #elif !defined(__FreeBSD__) && !defined(linux) && (defined (__sgi) || defined(__sparc) || defined(__sparc__))
 	/* WARNING - This may not be supported by geeneric unix os's - Campbell */
diff -Naur _res/blender-2.47/tools/Blender.pyc ./blender-2.47-haiku-1/tools/Blender.pyc
--- _res/blender-2.47/tools/Blender.pyc	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/tools/Blender.pyc	2008-12-29 18:18:05.000000000 +0100
@@ -0,0 +1,120 @@
+
+Z4Ic           @   s  d  Z  d d k Z d d k Z d d k Z d d k Z d d k Z d d k l Z d d k	 Z
+ d d k Z
+ d d k Z
+ d d k Z
+ d d k Z e i   Z e
+ i i Z e
+ i i Z e
+ i i Z e i Z d Z d Z g  Z g  Z d Z d Z g  Z g  Z d g Z h  a d   Z  d   Z! d d d d d	  Z" d d d d d
+  Z# d d d  Z$ d   Z% d   Z& d   Z' d   Z( d   Z) d   Z* d   Z+ d   Z, d   Z- d   Z. d   Z/ d d d d  Z0 d   Z1 d e f d     YZ2 d S(   s  
+tools.BlenderEnvironment
+
+This environment builds on SCons.Script.SConscript.SConsEnvironment
+
+* library repository
+* custom printout
+* wrapper functions
+
+TODO: clean up and sanitise code - crosscheck with btools and SConstruct
+to kill any code duplication
+
+iN(   t   SConsEnvironmentt    t   corec           C   s   t  S(   N(   t	   resources(    (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   getresources5   s    c          C   s   x t  D] }  h  t |  <q Wd  S(   N(   t   possible_typest   libs(   t   pt(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   init_lib_dict8   s     id   c         C   sd   | |  | j oO d  } x4 | p, |  | i |  o | d } q t } q W| |  | | <n d  S(   Ni   (   t   Nonet   has_keyt   True(   t   dictt   libtypet   libnamet   priorityt   done(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   internal_lib_to_dict=   s     c         C   s   |  p | p | o d GHt    n t |  t j o* t |  t j o t |  | | |  n t |  t j os t |  t j o` t |  t |  j o7 x@ t | |  D] \ } } t |  | | |  q Wq d GHt    n d GHt    d  S(   Ns   Passed wrong args0   libtype and priority lists are unequal in lengthsS   Wrong type combinations for libtype and priority. Only str and int or list and list(   t   Exitt   typet   strt   intR   t   listt   lent   zip(   R   R   R   R   t   ltt   p(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   add_lib_to_dictH   s    && c         C   s   |  p | o	 d GHn g  } | t  j o g  } x+ t | i   D] \ } } | i |  qC W| i   t | } xE | D]9 } | | } | i d t d |  d | |  d  q{ Wn | S(   Ns   missing argt   #s   lib/t	   LIBPREFIXt	   LIBSUFFIX(   R   R   t	   iteritemst   appendt   sortt   root_build_dir(   t   lenvR   t   lstt   sortlistt   kt   vt   curlibt   sk(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   create_blender_liblistZ   s    	 
+
+ 
+1c      	   C   s  g  } d |  d |  d |  d |  d |  d |  d |  d g } | t  |  d	  7} | t  |  d
+  7} |  d o, | t  |  d  7} | t  |  d  7} n |  d o | t  |  d  7} n |  d o | t  |  d  7} n |  d d j o | t  |  d  7} n | | f S(   Ns   /usr/libt   BF_PYTHON_LIBPATHt   BF_OPENGL_LIBPATHt   BF_SDL_LIBPATHt   BF_JPEG_LIBPATHt   BF_PNG_LIBPATHt   BF_ZLIB_LIBPATHt   BF_ICONV_LIBPATHt   BF_OPENEXR_LIBPATHt   BF_FFMPEG_LIBPATHt   WITH_BF_INTERNATIONALt   BF_GETTEXT_LIBPATHt   BF_FREETYPE_LIBPATHt   WITH_BF_OPENALt   BF_OPENAL_LIBPATHt   WITH_BF_STATICOPENGLt   BF_OPENGL_LIB_STATICt   OURPLATFORMs   win32-vcs   win32-mingwt
+   linuxcrosst   BF_PTHREADS_LIBPATH(   s   win32-vcs   win32-mingws
+   linuxcross(   t   Split(   R#   t   statlibst   libincs(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   setup_staticlibsl   s*    c         C   s  |  d |  d |  d g } |  d d j o* |  d d j o | i  |  d d	  n | i  |  d  |  d
+ o, | t |  d  7} | t |  d  7} n |  d o | t |  d  7} n |  d o" |  d d j o | d g 7} n |  d o | t |  d  7} n |  d o | t |  d  7} n |  d o | t |  d  7} n | t |  d  7} |  d p | t |  d  7} n |  d d  j o | t |  d  7} n | t |  d  7} | S(!   Nt   BF_JPEG_LIBt
+   BF_PNG_LIBt   BF_ZLIB_LIBt   BF_DEBUGi   R;   s   win32-vct   BF_PYTHON_LIBt   _dR4   t   BF_FREETYPE_LIBt   BF_GETTEXT_LIBR7   t   BF_OPENAL_LIBt   WITH_BF_OPENMPt   CCt   icct   gompt   WITH_BF_ICONVt   BF_ICONV_LIBt   WITH_BF_OPENEXRt   BF_OPENEXR_LIBt   WITH_BF_FFMPEGt   BF_FFMPEG_LIBt
+   BF_SDL_LIBR9   t   BF_OPENGL_LIBs   win32-mingwR<   t   BF_PTHREADS_LIBt   LLIBS(   s   win32-vcs   win32-mingws
+   linuxcross(   R    R>   (   R#   t   syslibs(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   setup_syslibs   s4    "c          C   s   t  i d t  i GHx t D] }  t  i d |  t  i GHd } g  } x+ t |  i   D] \ } } | i |  qT W| i   t |  } x/ | D]' } | | } d G| G| GH| d 7} q Wq Wd  S(   Ns   Priorities:s   	i    s   		i   (	   t   bct   OKBLUEt   ENDCR   t   OKGREENR   R   R    R!   (   t   tt   new_priorityR%   R&   R'   R(   R)   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   propose_priorities   s       
+
+ 
+c      
+   C   s?  t  i d  } t  i d  } t i d  i   d  } g  } |  d d j o t i d j o t d d	  } | i d
+ |  | i d |  | i d |  | i d  | i d  | i	   |  i
+ d d d g  n6 |  i
+ d d | d | d d | d d t i g  |  i t d | t d g  g } n | S(   s%   
+    Generate a buildinfo object
+    s   %Y-%m-%ds   %H:%M:%St
+   svnversionit   BF_BUILDINFOi   t   win32s   source/creator/winbuildinfo.ht   ws   char *build_date="%s";
+s   char *build_time="%s";
+s   char *build_rev="%s";
+s   char *build_platform="win32";
+s   char *build_type="dynamic";
+t
+   CPPDEFINESt   NAN_BUILDINFOt
+   BUILD_DATEs   BUILD_TIME='"%s"'s   BUILD_DATE='"%s"'s   BUILD_TYPE='"dynamic"'s   BUILD_REV='"%s"'s   BUILD_PLATFORM='"%s"'s   source/creator/%s_buildinfos   source/creator/buildinfo.c(   t   timet   strftimet   ost   popent   readt   syst   platformt   opent   writet   closet   Appendt   ObjectR"   (   R#   t
+   build_typet
+   build_datet
+   build_timet	   build_revt   objt   build_info_file(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt	   buildinfo   s.    
+c         C   sV   d | d } t  i i |  \ } } t i d t i d t i d | d t i S(   Ns   %si    t	   Compilings    ==> 't   '(   Rk   t   patht   splitR[   R\   R]   R^   (   t   targett   sourcet   envt   at   dt   f(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   my_compile_print   s    c         C   sV   d | d } t  i i |  \ } } t i d t i d t i d | d t i S(   Ns   %si    s   Creating MOCs    ==> 'R}   (   Rk   R~   R   R[   R\   R]   R^   (   R   R   R   R   R   R   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   my_moc_print   s    c         C   sV   d |  d } t  i i |  \ } } t i d t i d t i d | d t i S(   Ns   %si    s   Linking librarys    ==> 'R}   (   Rk   R~   R   R[   R\   R]   R^   (   R   R   R   R_   R   R   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   my_linking_print   s    c         C   sV   d |  d } t  i i |  \ } } t i d t i d t i d | d t i S(   Ns   %si    s   Linking programs    ==> 'R}   (   Rk   R~   R   R[   R\   R]   R^   (   R   R   R   R_   R   R   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   my_program_print   s    c         C   sR   t  i i |   } t  i i |   } | |  d d <| |  d d <| |  d d <d  S(   Nt   BUILDERSt   Libraryt   StaticLibraryt   Program(   t   SConst   Toolt   createStaticLibBuildert   createProgBuilder(   R   t
+   static_libt   program(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt	   msvc_hack   s
+    c         C   s  t  d d t } t  d d t } t  d d t } t  d d t } t  d d t } t  d d t } t i i |   \ } } | i d |  | i d	 |  | i d |  | i d	 |  t i i d
+ | d d d d d d d d d d  }	 t i i d
+ | d d d d d d d d d d d t i	 i
+  }
+ | |  d d <| |  d d <|	 |  d d <|	 |  d d <|
+ |  d d <d  S(   Ns   $CCCOMt   strfunctions   $SHCCCOMs   $CXXCOMs	   $SHCXXCOMs   $ARCOMs   $LINKCOMs   .cs   .cppt   actiont   emitters   $LIBEMITTERt   prefixs
+   $LIBPREFIXt   suffixs
+   $LIBSUFFIXt
+   src_suffixs
+   $OBJSUFFIXt   src_buildert   StaticObjects   $PROGEMITTERs   $PROGPREFIXs   $PROGSUFFIXRt   t   target_scannerR   R   R   R   (   t   ActionR   R   R   R   R   t   createObjBuilderst
+   add_actiont   Buildert   Defaultst   ProgScan(   R   t	   mycactiont   myshcactiont   mycppactiont   myshcppactiont   mylibactiont   mylinkactiont	   static_obt	   shared_obR   R   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   set_quiet_output   s:    	c         C   s.   d |  d } t  i i |  \ } } d | S(   Ns   %si    s   making bundle for (   Rk   R~   R   (   R   R   R   R   R   R   (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   my_appit_print  s    c      	   C   s{  d d  k  } d d  k } d d  k } d |  d } | i i |  \ } } | i d  i }	 | d }
+ | d j o t i d t i	 GHd Sn |	 d |
+ } |	 d	 |
+ } | d
+ d |
+ } | d
+ d |
+ } | i i
+ |  o | i |  n | i | |  d | | f } | i |  d | |
+ | |
+ |
+ f } | i |  d | |
+ f } | GH| i |  | d |
+ } | i |	 d |  | i |	 d |  d |	 | |
+ f } | i |  d |	 | |
+ f } | i |  d |	 | |
+ f } | i |  d |	 | |
+ f } | i |  d | |
+ |
+ f } | i |  d | |
+ f } | i |  d | |
+ f } | i |  d  S(   Nis   %si    t   .t
+   BINARYKINDt   verses   no bundle for verses   /source/darwin/%s.apps)   /source/darwin/%s.app/Contents/Info.plistt   /s   %s.app/Contents/Info.plists   %s.appsV   cat %s | sed s/VERSION/`cat release/VERSION`/ | sed s/DATE/`date +'%%Y-%%b-%%d'`/ > %ss$   cp %s/%s %s/%s.app/Contents/MacOS/%ss(   mkdir %s/%s.app/Contents/MacOS/.blender/s   /%s.app/Contents/MacOS/.blenders   /bin/.blender/.bfont.ttfs   /bin/.blender/.Blanguagess:   cp -R %s/bin/.blender/locale %s/%s.app/Contents/Resources/s?   cp -R %s/bin/.blender/locale %s/%s.app/Contents/MacOS/.blender/s<   cp %s/bin/.blender/.Blanguages %s/%s.app/Contents/Resources/s;   cp -R %s/release/scripts %s/%s.app/Contents/MacOS/.blender/s%   chmod +x  %s/%s.app/Contents/MacOS/%ss3   find %s/%s.app -name .svn -prune -exec rm -rf {} \;s1   find %s/%s.app -name .DS_Store -exec rm -rf {} \;(   t   shutilt   commandst   os.pathR~   R   t   Dirt   abspathR[   R\   R]   t   isdirt   rmtreet   copytreet	   getoutputt   copy(   R   R   R   R   R   Rk   R   t   builddirt   bt   bldroott   binaryt	   sourcedirt
+   sourceinfot
+   targetinfot   cmd(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   AppIt$  sR    
+c         C   s  t  i i | d i  } d | d i d } d | t  i d } d | t  i d } t  i d | d |  t | d d !d	  } | i   } | i   t | d d !d
+  }	 x' | D] }
+ |	 i	 d |
+ d  d  q W|	 i   t  i d | d |  t  i d |  d  S(   Ni    s   "s   *.sbr"s   bscmake.tmp"s	   dir /b/s s    >i   it   rRe   s   "
+s   bscmake /nologo /n /os    @s   del (
+   Rk   R~   t   dirnameR   t   sept   systemRp   t	   readlinesRr   Rq   (   R   R   R   t   bdt   bscfilet   bscpathcollectt
+   bscpathtmpt   myfilet   linest   newfilet   l(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   bscX  s    
+ 
+t   BlenderEnvironmentc        	   B   sq   e  Z d d d d  g d g d  Z d d d g  g  d d d d  Z d d d d d d d d d  Z d   Z RS(	   R   id   c         C   s   |  p | p | o" t  i d | t  i GHt   n |  d d
+ j o! t  i d t  i GH|  i   n t  i d t  i t  i | t  i GH|  i   } | i d t	 d	 | |  } t
+ i |  |  t i |  d  S(   Ns2   Cannot continue.  Missing argument for BlenderRes R;   s   win32-vcs   win32-mingwR<   s   BlenderRes is for windows only!s   Configuring resource R   s   lib/(   s   win32-vcs   win32-mingws
+   linuxcross(   R[   t   FAILR]   R   t   ENDt   HEADERR^   t   Copyt   RESR"   R    t   DefaultR   R    (   t   selfR   R   R   R   R#   t   res(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt
+   BlenderReso  s    %t   commonc   
+      C   s  |  p | p | o" t  i d | t  i GHt   n | t j p t t  d j o9| t j o; t  i d t  i t  i | t  i t  i	 d t  i GHn& t  i d t  i t  i | t  i GH|  i
+   } | i d |  | i d |  | d o | i d d g  n | d	 o | i d d
+ g  n | i d | d  | d p | t j o8 | i d t | d   | i d t | d   n) | i d | d  | i d | d  | d o. | i d t | d  d t | d   n | o$ | i d |  | i d |  n | i d t | d   | i d t | d   | i d d t d | d |  }	 t i |  |	  n< t  i d t  i t  i | t  i d t  i	 d t  i GHt t | | |  d  S(   Ns6   Cannot continue. Missing argument for BuildBlenderLib i    s   Configuring library s    (debug mode)t   CPPPATHRf   t   WITH_BF_GAMEENGINEs   GAMEBLENDER=1t   WITH_BF_BULLETs   WITH_BULLET=1t   CXXFLAGSt   CCFLAGSRE   t   BF_DEBUG_FLAGSt
+   REL_CFLAGSt   REL_CCFLAGSt
+   BF_PROFILEt   BF_PROFILE_FLAGSt   C_WARNt   CC_WARNR   R   s   lib/R   s   Not building s    for t   BF_QUICK(   R[   R   R]   R   t   quickieR   t
+   quickdebugR   R^   R\   R   Rs   t   ReplaceR>   R   R"   R    R   t   WARNINGR   R   (
+   R   R   t   sourcest   includest   definesR   R   t   compileflagsR#   t   lib(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt
+   BlenderLib  s@     ;%$;R   c         C   s  t  i d t  i t  i | t  i GH|  i   } | d d# j oK | i d t | d   | d o" | i d d d	 | d
+ g  q n | d d j o, | i d | d  | i d | d  n | d d j oT | i d | d  | i d | d  | d i d  o | i	 d d  q/n | d d j o@ | i d | d  | i d | d  | i d | d  n | d o | i d | d  n | i d |  | i d |  | i d |  | d o, | i d | d  | i d | d  n | i
+ d | d | d |  }	 | d o^ | d d j oM | d oB | i | d  |  }
+ | i |
+ |	 t g  } t i |  |  n t i |  |	  t i |	  | d d j o* | | d! <| i |	 t t d" t  n |	 S($   Ns   Configuring program R;   s   win32-vct   cygwint	   LINKFLAGSt   PLATFORM_LINKFLAGSRE   s   /DEBUGs   /PDB:s   .pdbt   linux2t   BF_PYTHON_LINKFLAGSt   sunos5t   CXXRL   t   LINKs   $CXXt   darwint   BF_OPENGL_LINKFLAGSR   R   R   t   LIBPATHt   LIBSt   WITH_BF_QUICKTIMEt   BF_QUICKTIME_LIBt   BF_QUICKTIME_LIBPATHR   s   bin/R   t   BF_BSCs   .bscR   R   (   s   win32-vcs   cygwin(   R[   R   R]   R^   R   Rs   R>   t   Prependt   endswithR   R   t   Filet   CommandR   R    R   t   program_listR    t   AddPostActionR   R   R   (   R   R   t   prognameR   R   R   t   libpatht
+   binarykindR#   t   progR   t   brs(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   BlenderProg  sJ    %& '
+ c         C   sb   t  i t |  d  d d  } g  } x7 t i | |  D]" } | i t  i | | d   q8 W| S(   Nt
+   SConscriptR   (   t   stringt   replacet   GetBuildPatht   globR    (   R#   t   patternR~   t   filest   i(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyt   Glob  s      N(   t   __name__t
+   __module__R	   R   R   R  R  (    (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pyR   m  s   !)!'(3   t   __doc__R   Rk   R  R  Ri   Rn   t   SCons.Script.SConscriptR    t   SCons.ActionR   t
+   SCons.Utilt   SCons.Buildert
+   SCons.Toolt   bcolorsR[   t   UtilR>   R   R   R  R"   R	   R   t	   quicklistR	  t	   argumentst   targetsR   t   blenderdepsR   R   R   R   R   R   R*   RA   RZ   Ra   R{   R   R   R   R   R   R   R   R   R   R   (    (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/Blender.pys   <module>   sZ   						"		"						#	4	
\ No newline at end of file
diff -Naur _res/blender-2.47/tools/__init__.pyc ./blender-2.47-haiku-1/tools/__init__.pyc
--- _res/blender-2.47/tools/__init__.pyc	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/tools/__init__.pyc	2008-12-29 18:18:05.000000000 +0100
@@ -0,0 +1,2 @@
+
+Z4Ic           @   s   d  S(   N(    (    (    (    sB   /storage/data/devel/blender/blender-2.47-haiku-1/tools/__init__.pys   <module>   s    
\ No newline at end of file
diff -Naur _res/blender-2.47/tools/bcolors.pyc ./blender-2.47-haiku-1/tools/bcolors.pyc
--- _res/blender-2.47/tools/bcolors.pyc	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/tools/bcolors.pyc	2008-12-29 18:18:05.000000000 +0100
@@ -0,0 +1,3 @@
+
+Z4Ic           @   s   d  d d     YZ  d S(   t   bcolorsc           B   s5   e  Z d  Z d Z d Z d Z d Z d Z d   Z RS(   s   [95ms   [94ms   [92ms   [93ms   [91ms   [0mc         C   s:   d |  _  d |  _ d |  _ d |  _ d |  _ d |  _ d  S(   Nt    (   t   HEADERt   OKBLUEt   OKGREENt   WARNINGt   FAILt   ENDC(   t   self(    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/bcolors.pyt   disable	   s    					(	   t   __name__t
+   __module__R   R   R   R   R   R   R	   (    (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/bcolors.pyR       s   N(    (   R    (    (    (    sA   /storage/data/devel/blender/blender-2.47-haiku-1/tools/bcolors.pys   <module>   s    
\ No newline at end of file
diff -Naur _res/blender-2.47/tools/btools.pyc ./blender-2.47-haiku-1/tools/btools.pyc
--- _res/blender-2.47/tools/btools.pyc	1970-01-01 01:00:00.000000000 +0100
+++ ./blender-2.47-haiku-1/tools/btools.pyc	2008-12-29 18:18:05.000000000 +0100
@@ -0,0 +1,103 @@
+
+Z4Ic           @   s  d  d k  Z  d  d k Z  d  d k Z y d  d k Z Wn e j
+ o n Xy d  d k Z Wn e j
+ o n Xd  d k Z d  d k Z d  d k	 Z	 d  d k
+ Z
+ e i Z e i i Z d   Z d   Z d   Z d   Z d d d     YZ d   Z d	   Z d
+   Z d d d d  Z d S(   iNc         C   sv   t  |   oN xb |  i   D]9 \ } } d | i | | i d | i | | i GHq Wn d | i d | i GHd  S(   Ns   	s    = s    No  command-line arguments given(   t   lent	   iteritemst   OKBLUEt   ENDCt   OKGREENt   WARNING(   t   argst   bct   kt   v(    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   print_arguments   s
+     5c      z   C   s.  d d d d d d d d d	 d
+ d d d d d d d d d d d d d d d d d d d d d d  d! d" d# d$ d% d& d' d( d) d* d+ d, d- d. d/ d0 d1 d2 d3 d4 d5 d6 d7 d8 d9 d: d; d< d= d> d? d@ dA dB dC dD dE dF dG dH dI dJ dK dL dM dN dO dP dQ dR dS dT dU dV dW dX dY dZ d[ d\ d] d^ d_ d` da db dc dd de df dg dh di dj dk dl dm dn do dp dq dr ds dt du dt dv dw dx dy gz } dz dw d{ d| d} d~ d d dv d d d d d d d d d d d dl dx dy g } | | } h  } xX |  i    D]J \ } } | | j o | | | <qd | i d | i | d | GHqW| S(   Nt	   BF_PYTHONt   BF_PYTHON_VERSIONt   BF_PYTHON_INCt   BF_PYTHON_BINARYt   BF_PYTHON_LIBt   BF_PYTHON_LIBPATHt   BF_PYTHON_LINKFLAGSt   WITH_BF_OPENALt	   BF_OPENALt   BF_OPENAL_INCt   BF_OPENAL_LIBt   BF_OPENAL_LIBPATHt   WITH_BF_SDLt   BF_SDLt
+   BF_SDL_INCt
+   BF_SDL_LIBt   BF_SDL_LIBPATHt   BF_PTHREADSt   BF_PTHREADS_INCt   BF_PTHREADS_LIBt   BF_PTHREADS_LIBPATHt   WITH_BF_FMODt   WITH_BF_OPENEXRt
+   BF_OPENEXRt   BF_OPENEXR_INCt   BF_OPENEXR_LIBt   BF_OPENEXR_LIBPATHt   WITH_BF_DDSt   WITH_BF_FFMPEGt   BF_FFMPEG_LIBt   BF_FFMPEG_EXTRAt	   BF_FFMPEGt   BF_FFMPEG_INCt   WITH_BF_JPEGt   BF_JPEGt   BF_JPEG_INCt   BF_JPEG_LIBt   BF_JPEG_LIBPATHt   WITH_BF_PNGt   BF_PNGt
+   BF_PNG_INCt
+   BF_PNG_LIBt   BF_PNG_LIBPATHt   BF_TIFFt   BF_TIFF_INCt   WITH_BF_ZLIBt   BF_ZLIBt   BF_ZLIB_INCt   BF_ZLIB_LIBt   BF_ZLIB_LIBPATHt   WITH_BF_INTERNATIONALt
+   BF_GETTEXTt   BF_GETTEXT_INCt   BF_GETTEXT_LIBt   BF_GETTEXT_LIBPATHt   WITH_BF_ICONVt   BF_ICONVt   BF_ICONV_INCt   BF_ICONV_LIBt   BF_ICONV_LIBPATHt   WITH_BF_ODEt   BF_ODEt
+   BF_ODE_INCt
+   BF_ODE_LIBt   WITH_BF_GAMEENGINEt   WITH_BF_BULLETt	   BF_BULLETt   BF_BULLET_INCt   BF_BULLET_LIBt   BF_SOLIDt   BF_SOLID_INCt	   BF_WINTABt   BF_WINTAB_INCt   WITH_BF_YAFRAYt   BF_FREETYPEt   BF_FREETYPE_INCt   BF_FREETYPE_LIBt   BF_FREETYPE_LIBPATHt   WITH_BF_QUICKTIMEt   BF_QUICKTIMEt   BF_QUICKTIME_INCt   BF_QUICKTIME_LIBt   BF_QUICKTIME_LIBPATHt   WITH_BF_STATICOPENGLt	   BF_OPENGLt   BF_OPENGL_INCt   BF_OPENGL_LIBt   BF_OPENGL_LIBPATHt   BF_OPENGL_LIB_STATICt   BF_OPENGL_LINKFLAGSt   WITH_BF_FTGLt   BF_FTGLt   BF_FTGL_INCt   BF_FTGL_LIBt   WITH_BF_PLAYERt   WITH_BF_GLEXTt   WITH_BF_BINRELOCt   CFLAGSt   CCFLAGSt   CPPFLAGSt
+   REL_CFLAGSt   REL_CCFLAGSt   C_WARNt   CC_WARNt   LLIBSt   PLATFORM_LINKFLAGSt   BF_PROFILE_FLAGSt   LCGDIRt   WITH_BF_VERSEt   BF_VERSE_INCLUDEt   VERSE_BUILD_BINARYt   VERSE_BUILD_DIRt   VERSE_REGEN_PROTOt   BF_TWEAK_MODEt   BF_SPLIT_SRCt   WITHOUT_BF_INSTALLt   WITH_BF_OPENMPt   BF_FANCYt   BF_QUIETt   BF_X264_CONFIGt   BF_XVIDCORE_CONFIGt   BF_DEBUGt   BF_CROSSt	   BF_UPDATEt   BF_INSTALLDIRt
+   BF_TOOLSETt
+   BF_BINNAMEt   BF_BUILDDIRt   BF_QUICKt
+   BF_PROFILEt   BF_DEBUG_FLAGSt   BF_BSCt	   BF_CONFIGt   BF_PRIORITYLISTt   BF_BUILDINFOt   CCt   CXXt   BF_QUICKDEBUGt   BF_LISTDEBUGs   	s   Invalid argument: t   =(   R   R   R   (   R   R   t	   opts_listt   arg_listt   all_listt   okdictR   R	   (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   validate_arguments   sj    						
+ 'c         C   sl   t  |   d j o, xR |  D] } d | i | | i GHq Wn* d | i d | i | i d | i GHd  S(   Ni    s   	s   No targets given, using t   default(   R    R   R   R   R   (   t   targsR   t   t(    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   print_targetsY   s
+     c         C   s   d d d d d d d d d	 d
+ d d d g } g  } xG |  D]? } | | j o | i  |  q: d | i d | i | GHq: W| S(   Nt   .t   blendert   blenderstatict   blenderplayert	   webplugint   blendernogamet   blenderstaticnogamet   releaset
+   everythingt   cleans   install-bint   installt   nsiss   	s   Invalid target: (   t   appendR   R   (   R   R   t
+   valid_listt   oklistR   (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   validate_targets`   s    	 t   ourSpawnc           B   s   e  Z d    Z RS(   c         C   s   t  i | d d  } | d | } t i   } | i t i O_ t i | d t i d t i d t i d | d t }	 |	 i	   \ }
+ } |	 i
+   } | o d GH| GHd GHn | S(	   Ni   t    t   stdint   stdoutt   stderrt   startupinfot   shells   =====(   t   stringt   joint
+   subprocesst   STARTUPINFOt   dwFlagst   STARTF_USESHOWWINDOWt   Popent   PIPEt   Falset   communicatet   wait(   t   selft   sht   escapet   cmdR   t   envt   newargst   cmdlineR   t   proct   datat   errt   rv(    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   ourspawnm   s    	(   t   __name__t
+   __module__R   (    (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyR   l   s   c         C   s#   t    } |  | _ | i |  d <d  S(   Nt   SPAWN(   R   t   ourenvR   (   R   t   buf(    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt
+   SetupSpawn|   s    		c         C   sD  t  i  |  |  } | i dddt d
+ d d  dddddddddddd d!t d# d$ d  t d% d& d'  t d( d) d  d"d#d$d%t d1 d2 d  d&d'd(d)d*d+d,d-t dC dD d  t dE dF d'  d.d/d0d1t dO dP d'  t dQ dR d  d2d3d4d5d6t d] d^ d'  d7d8d9d:t dg dh d'  d;d<d=d>d?d@t du dv d'  dAdBdCdDt d d d'  dEdFdGdHt d d d'  dIdJdKdLt d d d'  t d d d'  dMdNdOt d d d'  dPdQdRdSdTdUdVdWdXdYdZt d d d  t d d d  d[d\d]d^t d d d'  d_d`dadbdcddt d d d'  dedfdgt d d d'  t d d d  dhdidjdkdldmdndodpt d d d  dqt d d d  drt d d d'  dsdtdudvt d dd'  t ddd  t ddd  t ddd  t dd	d'  t d
+dd'  t ddd  dwdx | S(y  NRy   s    Build a release or debug binary.R   Rz   s(   Target directory for intermediate files.s   ${BF_BUILDDIR}/extern/verseR{   s(   Whether to regenerate the protocol filest   yesRw   s   Use VERSE if truet   falseRx   s   verse include dirs   /usr/includeRv   s   location of cvs lib dirt   BF_DEBUG_LIBSs-   list of libraries to build with debug symbolsR   s   base path for pythont    R   s   Python version to useR   s   include path for Python headersR   s   Path to the Python interpreterR   s   Python libraryR   s   Library pathR   s   Python link flagst   BF_NO_ELBEEMs   Disable Fluid SimRT   s   Enable Yafrayt   trueR   s   Use OpenAL if trueR   s   base path for OpenALR   s   include path for python headersR   s   Path to OpenAL libraryR   R   s   Use SDL if trueR   s   SDL base pathR   s   SDL include pathR   s   SDL libraryR   s   SDL library pathR   s   Pthreads base pathR   s   Pthreads include pathR   s   Pthreads libraryR   s   Pthreads library pathR    s   Use FMOD if trueR!   s   Use OPENEXR if trueR"   s   OPENEXR base pathR#   s   OPENEXR include pathR$   s   OPENEXR libraryR%   s   OPENEXR library pathR&   s   Use DDS if trueR'   s   Use FFMPEG if trueR*   s   FFMPEG base pathR(   s   FFMPEG libraryR)   s#   FFMPEG flags that must be preservedR+   s   FFMPEG includest   BF_FFMPEG_LIBPATHs   FFMPEG library pathR,   s   Use JPEG if trueR-   s   JPEG base pathR.   s   JPEG include pathR/   s   JPEG libraryR0   s   JPEG library pathR1   s   Use PNG if trueR2   s   PNG base pathR3   s   PNG include pathR4   s   PNG libraryR5   s   PNG library pathR6   s   TIFF base pathR7   s   TIFF include pathR8   s   Use ZLib if trueR9   s   ZLib base pathR:   s   ZLib include pathR;   s   ZLib libraryR<   s   ZLib library pathR=   s    Use Gettext and Freetype if trueR>   s   gettext base pathR?   s   gettext include pathR@   s   gettext libraryRA   s   gettext library pathRB   s   Use iconv if trueRC   s   iconv base pathRD   s   iconv include pathRE   s   iconv libraryRF   s   iconv library pathRK   s   Build with gameengineRG   s   Use ODE if trueRH   s   ODE base pathRI   s   ODE include pathRJ   s   ODE libraryRL   s   Use Bullet if trueRM   s   Bullet base dirRN   s   Bullet include pathRO   s   Bullet libraryRP   s   Solid base dirs   #/extern/solidRQ   s   Solid include pathRR   s   WinTab base dirRS   s   WinTab include dirRU   s   Freetype base pathRV   s   Freetype include pathRW   s   Freetype libraryRX   s   Freetype library pathR   s   Use OpenMP if trueRY   s   Use QuickTime if trueRZ   s   QuickTime base pathR[   s   QuickTime include pathR\   s   QuickTime libraryR]   s   QuickTime library pathR^   s   Use MESA if trueR_   s   OpenGL base pathR`   s   OpenGL include pathRa   s   OpenGL librariesRb   s   OpenGL library pathRc   s   OpenGL static librariesRd   s   OpenGL link flagsRe   s   Use FTGL if trueRf   s   FTGL base pathRg   s   FTGL include pathRh   s   FTGL librariesRj   s   Enable GL ExtensionsRi   s   Build blenderplayer if trueRl   s   C-compiler flagsRm   s   C++-compiler flagsRn   t   DefinesRo   s   C release flagsRp   s   C++ release flagsRq   s   C warning flagsRr   s   C++ warning flagsRs   s   Platform libsRt   s   Platform linkflagsR   s!   Add profiling information if trueRu   s   Profiling flagsR   s   Add debug flags if trueR   s   Debug flagsR   s   Create .bsc files (msvc only)R   s	   Build dirR   s   Installation dirR   s   C compiler to useR   s   C++ compiler to useR   s   Buildtime in splash if trueR|   s   Enable tweak mode if trueR}   s)   Split src lib into several chunks if trueR~   s   dont install if trueR   s   Enable fancy output if trueR   s   Enable silent output if trueRk   s&   Enable relocatable binary (linux only)R   s   configuration flags for x264R   s    configuration flags for xvidcore(   s   VERSE_BUILD_BINARYs    Build a release or debug binary.s   release(   s   VERSE_BUILD_DIRs(   Target directory for intermediate files.s   ${BF_BUILDDIR}/extern/verse(   s   VERSE_REGEN_PROTOs(   Whether to regenerate the protocol filess   yes(   s   BF_VERSE_INCLUDEs   verse include dirs   /usr/include(   s   LCGDIRs   location of cvs lib dir(   s   VERSE_BUILD_BINARYs    Build a release or debug binary.s   release(   s   VERSE_BUILD_DIRs(   Target directory for intermediate files.s   ${BF_BUILDDIR}/extern/verse(   s   VERSE_REGEN_PROTOs(   Whether to regenerate the protocol filess   yes(   s   BF_DEBUG_LIBSs-   list of libraries to build with debug symbols(   s	   BF_PYTHONs   base path for pythonR   (   s   BF_PYTHON_VERSIONs   Python version to useR   (   s   BF_PYTHON_INCs   include path for Python headersR   (   s   BF_PYTHON_BINARYs   Path to the Python interpreterR   (   s   BF_PYTHON_LIBs   Python libraryR   (   s   BF_PYTHON_LIBPATHs   Library pathR   (   s   BF_PYTHON_LINKFLAGSs   Python link flagsR   (   s	   BF_OPENALs   base path for OpenALR   (   s   BF_OPENAL_INCs   include path for python headersR   (   s   BF_OPENAL_LIBs   Path to OpenAL libraryR   (   s   BF_OPENAL_LIBPATHs   Path to OpenAL libraryR   (   s   BF_SDLs   SDL base pathR   (   s
+   BF_SDL_INCs   SDL include pathR   (   s
+   BF_SDL_LIBs   SDL libraryR   (   s   BF_SDL_LIBPATHs   SDL library pathR   (   s   BF_PTHREADSs   Pthreads base pathR   (   s   BF_PTHREADS_INCs   Pthreads include pathR   (   s   BF_PTHREADS_LIBs   Pthreads libraryR   (   s   BF_PTHREADS_LIBPATHs   Pthreads library pathR   (   s
+   BF_OPENEXRs   OPENEXR base pathR   (   s   BF_OPENEXR_INCs   OPENEXR include pathR   (   s   BF_OPENEXR_LIBs   OPENEXR libraryR   (   s   BF_OPENEXR_LIBPATHs   OPENEXR library pathR   (   s	   BF_FFMPEGs   FFMPEG base pathR   (   s   BF_FFMPEG_LIBs   FFMPEG libraryR   (   s   BF_FFMPEG_EXTRAs#   FFMPEG flags that must be preservedR   (   s   BF_FFMPEG_INCs   FFMPEG includesR   (   s   BF_FFMPEG_LIBPATHs   FFMPEG library pathR   (   s   BF_JPEGs   JPEG base pathR   (   s   BF_JPEG_INCs   JPEG include pathR   (   s   BF_JPEG_LIBs   JPEG libraryR   (   s   BF_JPEG_LIBPATHs   JPEG library pathR   (   s   BF_PNGs   PNG base pathR   (   s
+   BF_PNG_INCs   PNG include pathR   (   s
+   BF_PNG_LIBs   PNG libraryR   (   s   BF_PNG_LIBPATHs   PNG library pathR   (   s   BF_TIFFs   TIFF base pathR   (   s   BF_TIFF_INCs   TIFF include pathR   (   s   BF_ZLIBs   ZLib base pathR   (   s   BF_ZLIB_INCs   ZLib include pathR   (   s   BF_ZLIB_LIBs   ZLib libraryR   (   s   BF_ZLIB_LIBPATHs   ZLib library pathR   (   s
+   BF_GETTEXTs   gettext base pathR   (   s   BF_GETTEXT_INCs   gettext include pathR   (   s   BF_GETTEXT_LIBs   gettext libraryR   (   s   BF_GETTEXT_LIBPATHs   gettext library pathR   (   s   BF_ICONVs   iconv base pathR   (   s   BF_ICONV_INCs   iconv include pathR   (   s   BF_ICONV_LIBs   iconv libraryR   (   s   BF_ICONV_LIBPATHs   iconv library pathR   (   s   BF_ODEs   ODE base pathR   (   s
+   BF_ODE_INCs   ODE include pathR   (   s
+   BF_ODE_LIBs   ODE libraryR   (   s	   BF_BULLETs   Bullet base dirR   (   s   BF_BULLET_INCs   Bullet include pathR   (   s   BF_BULLET_LIBs   Bullet libraryR   (   s   BF_SOLIDs   Solid base dirs   #/extern/solid(   s   BF_SOLID_INCs   Solid include pathR   (   s	   BF_WINTABs   WinTab base dirR   (   s   BF_WINTAB_INCs   WinTab include dirR   (   s   BF_FREETYPEs   Freetype base pathR   (   s   BF_FREETYPE_INCs   Freetype include pathR   (   s   BF_FREETYPE_LIBs   Freetype libraryR   (   s   BF_FREETYPE_LIBPATHs   Freetype library pathR   (   s   BF_QUICKTIMEs   QuickTime base pathR   (   s   BF_QUICKTIME_INCs   QuickTime include pathR   (   s   BF_QUICKTIME_LIBs   QuickTime libraryR   (   s   BF_QUICKTIME_LIBPATHs   QuickTime library pathR   (   s	   BF_OPENGLs   OpenGL base pathR   (   s   BF_OPENGL_INCs   OpenGL include pathR   (   s   BF_OPENGL_LIBs   OpenGL librariesR   (   s   BF_OPENGL_LIBPATHs   OpenGL library pathR   (   s   BF_OPENGL_LIB_STATICs   OpenGL static librariesR   (   s   BF_OPENGL_LINKFLAGSs   OpenGL link flagsR   (   s   BF_FTGLs   FTGL base pathR   (   s   BF_FTGL_INCs   FTGL include pathR   (   s   BF_FTGL_LIBs   FTGL librariesR   (   s   CFLAGSs   C-compiler flagsR   (   s   CCFLAGSs   C++-compiler flagsR   (   s   CPPFLAGSR   R   (   s
+   REL_CFLAGSs   C release flagsR   (   s   REL_CCFLAGSs   C++ release flagsR   (   s   C_WARNs   C warning flagsR   (   s   CC_WARNs   C++ warning flagsR   (   s   LLIBSs   Platform libsR   (   s   PLATFORM_LINKFLAGSs   Platform linkflagsR   (   s   BF_PROFILE_FLAGSs   Profiling flagsR   (   s   BF_DEBUG_FLAGSs   Debug flagsR   (   s   BF_BUILDDIRs	   Build dirR   (   s   BF_INSTALLDIRs   Installation dirR   (   s   CCs   C compiler to useR   (   s   CXXs   C++ compiler to useR   (   s   BF_X264_CONFIGs   configuration flags for x264R   (   s   BF_XVIDCORE_CONFIGs    configuration flags for xvidcoreR   (   t   Optionst
+   AddOptionst
+   BoolOption(   t   cfgR   t	   localopts(    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt	   read_opts   s   c         C   s   d S(   Ns&   Creating NSIS installer for Blender 3D(    (   t   targett   sourceR   (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt
+   NSIS_printH  s    c   C   #   C   s	  | d d j o! | d d j o d GHt    n t i   } | d } | d } t i i | | d d  p t i | | d d  n x3 t i d	  D]" } t i | | | d d  q Wt i d
+ | | d d  t i	 d  t
+ d  } | i   d  } | i d  d | i d  d }	 | i   | | d }
+ t i	 d  t
+ d d  } t | i    } | i   g  } t i |
+ d  } x\ | D]T } t i i |
+ d |  d j o- | i d t i i |
+  d | d  qqWt i | d  } | d 7} t i | d |  } g  } x@ | D]8 } t i i |
+ |  d j o | i d |  q3q3Wt i | d  } | d 7} t i | d |  } g  } d |
+ d f } t i |  } x^ | D]V } d  | | f } t i i |  d j o' t i i |  } | i d! |  qqWt i | d  } | d 7} t i | d" |  } g  } d |
+ d# f } t i |  } x^ | D]V } d  | | f } t i i |  d j o' t i i |  } | i d! |  qqWt i | d  } | d 7} t i | d$ |  } g  } d |
+ d% f } t i |  } x^ | D]V } d  | | f } t i i |  d j o' t i i |  } | i d! |  q:q:Wt i | d  } | d 7} t i | d& |  } g  }  d |
+ d' f }! t i |!  }" xL |" D]D }# d  |! |# f }$ t i i |$  d j o |  i d! |$  qqWt i |  d  }% |% d 7}% t i | d( |%  } g  }& d |
+ d) f }' t i |'  }( x |( D]z }) d  |' |) f }* t i i |*  d j oK |* i d*  p |* i d+  o' t i i |*  }* |& i d! |*  qqqWt i |& d  }+ |+ d 7}+ t i | d, |+  } g  }, d |
+ d- f }- t i |-  }. xL |. D]D }/ d  |- |/ f }0 t i i |0  d j o |, i d! |0  qqqqWt i |, d  }1 |1 d 7}1 t i | d. |1  } g  }2 t i |
+ d/  }3 x\ |3 D]T }4 t i i |
+ d0 |4  d j o- |2 i d t i i |
+  d0 |4 d  q
+q
+Wt i |2 d  }5 |5 d 7}5 t i | d1 |5  } g  }6 g  }7 t i |
+ d2  }8 xq |8 D]i }9 t i i |
+ d3 |9  d j oB |7 i d4 |9 d5  |7 i d t i i |
+  d3 |9 d6  qqWt i |7 d  }: |: d 7}: t i | d7 |:  } t i | d8 t i i |
+ d   } t i | d9 |	  } t i | d |  } t i | d: t i i |   } t i i | t i | d; t i d<  }; t
+ |; d=  }< |< i |  |< i   t i	 |  dD |; d }= t i   }> |> i t i O_ t i |= d? t i d@ t i dA t i dB |> dC t }? |? i    \ }@ }A |? i!   }B d S(E   Nt   OURPLATFORMs   win32-vcs   win32-mingws,   NSIS installer is only available on Windows.s   \release\windows\installer\s   \R   s   /plugins/includes    source/blender/blenpluginapi/*.hs'   source/blender/blenpluginapi/plugin.defs   /plugins/include/R   t   VERSIONiR   i    i   s   windows/installers   00.sconsblender.nsit   rs   File "s   "s   
+  s   
+
+s   [ROOTDIRCONTS]s   Delete $INSTDIR\s   
+ s   
+s   [DELROOTDIRCONTS]s   %s%ss   \.blender\scriptss   %s\%ss	   File "%s"s   [SCRIPTCONTS]s   \.blender\scripts\bpymoduless   [SCRIPTMODCONTS]s(   \.blender\scripts\bpymodules\ColladaImExs   [SCRIPTMODCOLLADACONT]s   \.blender\scripts\bpydatas   [SCRIPTDATACONTS]s   \plugins\includes   .hs   .DEFs   [PLUGINCONTS]s    \.blender\scripts\bpydata\configs   [SCRIPTDATACFGCONTS]s	   \.blenders
+   \.blender\s   [DOTBLENDERCONTS]s   \.blender\locales   \.blender\locale\s(   SetOutPath $BLENDERHOME\.blender\locale\s   \LC_MESSAGESs   \LC_MESSAGES\blender.mo"s   [LANGUAGECONTS]t   DISTDIRt   SHORTVERt   RELDIRR   s   00.blender_tmp.nsit   ws	   makensis R   R   R   R   R   s
+   makensis "("   t   Exitt   ost   getcwdt   patht   existst   mkdirt   globt   shutilt   copyt   chdirt   opent   readt   splitt   closet   strt   listdirt   isdirR   t   normpathR   R   t   replacet   findt   sept   writeR   R   R   R   R   R   t   TrueR   R   (C   R   R   R   t	   start_dirt   rel_dirt   install_base_dirt   fR	   t   versiont   shortvert   inst_dirt   nst   ns_cntt   rootlistt   rootdirt   rootitemt
+   rootstringt   delrootlistt   delrootstringt
+   scriptlistt
+   scriptpatht	   scriptdirt
+   scriptitemt
+   scriptfilet   scriptstringt
+   bpymodlistt
+   bpymodpatht	   bpymoddirt
+   bpymoditemt
+   bpymodfilet   bpymodstringt   colladalistt   bpydatalistt   bpydatapatht
+   bpydatadirt   bpydataitemt   bpydatafilet   bpydatastringt   plugincludelistt   plugincludepatht   plugincludedirt   plugincludeitemt   plugincludefilet   plugincludestringt   cfglistt   cfgpatht   cfgdirt   cfgitemt   cfgfilet	   cfgstringt   dotblendlistt   dotblenddirt   dotblenditemt   dotblendstringt   langlistt	   langfilest   langdirt   langitemt
+   langstringt   tmpnsit   new_nsisR   R   R   R   R   R   (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pyt   NSIS_InstallerK  s*   "
+
+  $
+
+ !1
+ 
+ 
+ 
+ 
+ 
+  
+ 
+ !+
+ !+
+%!,
+(    (   R   t   os.patht   SCons.Optionst   SConst   SCons.Options.BoolOptiont   ImportErrorR   R   R   R   t   sysR   R   R
+   R   R   R   R   R   R   R   t   NoneR<  (    (    (    s@   /storage/data/devel/blender/blender-2.47-haiku-1/tools/btools.pys   <module>   s2   			=					
\ No newline at end of file
