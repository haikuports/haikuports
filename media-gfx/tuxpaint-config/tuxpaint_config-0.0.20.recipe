SUMMARY="A graphical tool for configurations of TuxPaint"
DESCRIPTION="Tux Paint is a free, award-winning drawing program for children \
ages 3 to 12 (for example, preschool and K-6). Tux Paint is used \
in schools and around the world as a computer literacy drawing activity. \
It combines an easy-to-use interface, fun sound effects, and an \
encouraging cartoon mascot who guides children as they use the program."
HOMEPAGE="http://www.tuxpaint.org/"
COPYRIGHT="2002-2020 Bill Kendrick and others"
LICENSE="GNU GPL v2"
REVISION="1"
SOURCE_URI="http://downloads.sf.net/tuxpaint/tuxpaint-config-$portVersion.tar.gz"
CHECKSUM_SHA256="aa17449ff6e7856ec2c406a2ab2d4a3beb28ff074311d5adf88f8a6e7fff195d"
SOURCE_DIR="tuxpaint-config-$portVersion"
PATCHES="tuxpaint_config-$portVersion.patchset"
ADDITIONAL_FILES="tuxpaint_config.rdef.in"

ARCHITECTURES="!x86_gcc2 ?x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	tuxpaint_config$secondaryArchSuffix = $portVersion
	cmd:tuxpaint_config = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libfltk$secondaryArchSuffix
	lib:libintl$secondaryArchSuffix
	lib:libpaper$secondaryArchSuffix
	lib:libunibreak$secondaryArchSuffix
	lib:libX11$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libfltk$secondaryArchSuffix
	devel:libintl$secondaryArchSuffix
	devel:libpaper$secondaryArchSuffix
	devel:libunibreak$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:make
	cmd:gcc$secondaryArchSuffix
	cmd:pkg_config$secondaryArchSuffix
	"


BUILD()
{
	make PREFIX=$prefix DATA_PREFIX=$dataDir DOC_PREFIX=$docDir \
		MAN_PREFIX=$manDir LOCALE_PREFIX=$dataDir/locale
}

INSTALL()
{
	make PREFIX=$prefix DATA_PREFIX=$dataDir DOC_PREFIX=$docDir \
		MAN_PREFIX=$manDir LOCALE_PREFIX=$dataDir/locale  install

	# remove not needed files
	rm -rf $prefix/{share,X11R6}
	rm -rf $dataDir/images

	local MAJOR="`echo "$portVersion" | cut -d. -f1`"
	local MIDDLE="`echo "$portVersion" | cut -d. -f2`"
	local MINOR="`echo "$portVersion" | cut -d. -f3`"
	local APP_NAME="Tux Paint Config"
	local LONG_INFO="$SUMMARY"
	local APP_SIGNATURE="application/x-vnd.tuxpaint_config"
	sed \
		-e "s|@MAJOR@|$MAJOR|" \
		-e "s|@MIDDLE@|$MIDDLE|" \
		-e "s|@MINOR@|$MINOR|" \
		-e "s|@LONG_INFO@|$LONG_INFO|" \
		-e "s|@APP_NAME@|$APP_NAME|" \
		-e "s|@APP_SIGNATURE@|$APP_SIGNATURE|" \
		$portDir/additional-files/tuxpaint_config.rdef.in > tuxpaint_config.rdef

	addResourcesToBinaries tuxpaint_config.rdef $prefix/bin/tuxpaint-config

	addAppDeskbarSymlink $prefix/bin/tuxpaint-config "Tux Paint Config"
}
