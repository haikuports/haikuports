From 08aee05e07a20c115be085e34d4a2bcf2b5ec234 Mon Sep 17 00:00:00 2001
From: Luc Schrijvers <begasus@gmail.com>
Date: Sat, 13 Sep 2025 11:39:22 +0200
Subject: Disable KWaylandExtras


diff --git a/src/dbusrunner.cpp b/src/dbusrunner.cpp
index 84293ec..5c62150 100644
--- a/src/dbusrunner.cpp
+++ b/src/dbusrunner.cpp
@@ -17,7 +17,9 @@
 #include <QIcon>
 #include <set>
 
+#ifndef Q_OS_HAIKU
 #include <KWaylandExtras>
+#endif
 #include <KWindowSystem>
 
 #include "dbusutils_p.h"
@@ -288,6 +290,9 @@ void DBusRunner::run(const KRunner::RunnerContext & /*context*/, const KRunner::
         QDBusConnection::sessionBus().call(runMethod, QDBus::NoBlock);
     };
 
+#ifdef Q_OS_HAIKU
+    run();
+#else
     if (KWindowSystem::isPlatformWayland() && qGuiApp->focusWindow()) {
         auto tokenFuture = KWaylandExtras::xdgActivationToken(qGuiApp->focusWindow(), {});
         tokenFuture.then(this, [this, service, matchId, actionId, run](const QString &token) {
@@ -301,6 +306,7 @@ void DBusRunner::run(const KRunner::RunnerContext & /*context*/, const KRunner::
     } else {
         run();
     }
+#endif
 }
 
 QImage DBusRunner::decodeImage(const RemoteImage &remoteImage)
-- 
2.51.0

