From a1809e59e74ad68a5554c754963da82abbb13a12 Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Sun, 16 Jul 2023 16:39:11 -0600
Subject: Switch to rdef and fix supported mime types


diff --git a/main/Resource.rdef b/main/Resource.rdef
new file mode 100644
index 0000000..d6db76e
--- /dev/null
+++ b/main/Resource.rdef
@@ -0,0 +1,131 @@
+
+resource mini_icon array {
+	$"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFADA"
+	$"FFFFFFFFFFFFFF0000000000FFFAF9FF"
+	$"FFFFFFFFFFFFFF0000190000FAF9FFFF"
+	$"FF20FFFFFFFFFF003F193FFAF9000000"
+	$"202020FFFFFF0B000019FAF9FF001500"
+	$"20202020F9F900003FFAF900FF001500"
+	$"FF2020F9F9F9F900FAF900000B001500"
+	$"FFFF20F9F9F9F9FAF93F3F3F00001500"
+	$"FFFFFF0BF9F940103F403F3F3F000000"
+	$"FFFFFF0000003F40403F3F403F3F3F00"
+	$"FFFFFF003F00003F403F3F403F3F000B"
+	$"FFFFFFFF003F00003F403F3F00000BFF"
+	$"FFFFFFFFFF00003F003F4000400000FF"
+	$"FFFFFFFFFFFF000000000000000000FF"
+	$"FFFFFFFFFFFFFFFFFF0B0BFFFFFFFFFF"
+};
+
+resource(1, "BEOS:M:application/x-be-resource") #'MICN' array {
+	$"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFF0000000000FFFFFFFF"
+	$"FFFFFFFFFFFFFF0000190000FFFFFFFF"
+	$"FF20FFFFFFFFFF003F193F00FF000000"
+	$"202020FFFFFF0B0000190000FF001400"
+	$"20202020F9F900003F193F00FF001400"
+	$"FF2020F9F9F9F900000000000B001400"
+	$"FFFF20F9F9F9F9403F3F3F3F00000000"
+	$"FFFFFF0BF9F9403F3F403F3F3F00000B"
+	$"FFFFFF0000003F40403F3F403F3F3F00"
+	$"FFFFFF003F00003F403F3F403F3F000B"
+	$"FFFFFFFF003F00003F403F3F00000BFF"
+	$"FFFFFFFFFF00003F003F4000400000FF"
+	$"FFFFFFFFFFFF000000000000000000FF"
+	$"FFFFFFFFFFFFFFFFFF0B0BFFFFFFFFFF"
+};
+
+resource file_types message {
+	"types" = "application/x-vnd.be-elfexecutable",
+	"types" = "application/x-vnd.Be-elfexecutable",
+	"types" = "application/x-be-executable",
+	"types" = "application/x-be-resource"
+};
+
+resource app_signature "application/x-vnd.resourcer";
+
+resource app_version {
+	major  = 3,
+	middle = 0,
+	minor  = 0,
+
+	variety = B_APPV_DEVELOPMENT,
+	internal = 0,
+
+	short_info = "Resourcer",
+	long_info = "Resourcer file resource editor"
+};
+
+resource app_flags B_SINGLE_LAUNCH;
+
+resource(1, "BEOS:L:application/x-be-resource") #'ICON' array {
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFF003F0000000000003F00FF000000000000000000FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FF003F3F3F3F3F3F3F00FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FF003F3F3F3F3F3F3F00FF"
+	$"FFFFFFFF00FFFFFFFFFFFF003F0060606060003F00FF003F3F0E1C0F0F3F00FF"
+	$"FFFFFF002000FFFFFFFFFF00000060606060000000FF003F3F0E0F0F3F3F00FF"
+	$"FFFF0020202000FFFFFFFF00000000000000000000FF003F3F0E1C0F1C3F00FF"
+	$"FF002020202000000000FF003F0060606060003F00FF003F3F0E1C0F3F3F00FF"
+	$"002020202000F9F9F9F90000000060606060000000FF003F3F3F3F3F3F3F00FF"
+	$"0000000000F9F9F9F9F9F900603FAEAEAEAE0000FFFF003F3F3F3F3F3F3F00FF"
+	$"FFFFFFFF00F9F9F9F9F9F9003FAEAEAEAEAEAEAE0000000000000000000000FF"
+	$"FFFFFFFF00F9F9F9F9F9F9003FAEAEAEAEAEAEAE3F3F0000FFFFFFFFFFFFFFFF"
+	$"FFFFFFFF00F9F9F9F9F9F9003F60AEAEAEAEAE603F603F3F0000FFFFFFFFFFFF"
+	$"FFFFFFFFFF00F9F9F9F900AEAE3F3F3F3F3F3F3F3F3FAEAEAEAE0000FFFFFFFF"
+	$"FFFFFFFF006000000000AEAEAE3F3F3F3F3F3F3F3F3FAEAEAEAEAEAE0000FFFF"
+	$"FFFFFF00603F3FAEAEAEAEAE3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F603F00FF"
+	$"FFFF00603F603F603F603F603F603F603F603F603F603F603F603F603F00FFFF"
+	$"FF00603F603F603F603F603F603F603F603F603F603F603F603F603F00AEAEAE"
+	$"00003F603F603F603F603F603F603F603F603F603F603F603F603F0000AEAE1B"
+	$"FFAE0000603F603F603F603F603F603F603F603F603F603F603F00AE8700AE1B"
+	$"FFFFAE0000006060606060606060606060601B60606060606000AE87870100AE"
+	$"FFFFFFAE00AE00006060606060606060606060601B60606000AE870000AEAEAE"
+	$"FFFFFFFFAE00AEAE00006087608760876087608760871B29AE0000AEAEFFFFFF"
+	$"FFFFFFFFFFAE0087AEAE000087878787878787878787010000AEAEFFFFFFFFFF"
+	$"FFFFFFFFFFFFAE008787AEAE0000878787878787870100AEAEFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFAE00608787AEAE0000AEAEAEAE00AEAEFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFAE0060608787AEAE0000AE00AEAEFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFAE00606060870000AE00AEAEFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFAE00600000AEAEAEAEAEFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFAE00AEAEFFFFFFAEFFFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFFFAEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
+};
+
+resource large_icon array {
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FFFFFFFFFFFF58585858FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FFFFFFFFFFFA58585858FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF003F0000000000003F00FF000000FAFAF9F9F900FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FF003FFAFAF9F9F93F00FF"
+	$"FFFFFFFFFFFFFFFFFFFFFF00000060606060000000FF00FAFAF9F9F93F3F00FF"
+	$"FFFFFFFF00FFFFFFFFFFFF003F0060606060003F00FFFAFAF9F9F90F0F3F00FF"
+	$"FFFFFF002000FFFFFFFFFF00000060606060000000FAFAF9F9F90F0F3F3F00FF"
+	$"FFFF0020202000FFFFFFFF000000000000000000FAFAF9F9F90E1C0F1C3F00FF"
+	$"FF002020202000000000FF003F006060606000FAFAF9F9F93F0E1C0F3F3F00FF"
+	$"002020202000F9F9F9F90000000060606060FAFAF9F9F93F3F3F3F3F3F3F00FF"
+	$"0000000000F9F9F9F9F9F900603FAEAEAEFAFAF9F9F9003F3F3F3F3F3F3F00FF"
+	$"FFFFFFFF00F9F9F9F9F9F9003FAEAEAEFAFAF9F9F900000000000000000000FF"
+	$"FFFFFFFF00F9F9F9F9F9F9003FAEAEFAFAF9F9F93F3F0000FFFFFFFFFFFFFFFF"
+	$"FFFFFFFF00F9F9F9F9F9F9003F60FAFAF9F9F9603F603F3F0000FFFFFFFFFFFF"
+	$"FFFFFFFFFF00F9F9F9F900AEAE3F0BF9F9F93F3F3F3FAEAEAEAE0000FFFFFFFF"
+	$"FFFFFFFF006000000000AEAEAE3F0B0BF93F3F3F3F3FAEAEAEAEAEAE0000FFFF"
+	$"FFFFFF00603F3FAEAEAEAEAE3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F603F00FF"
+	$"FFFF00603F603F603F603F603F603F603F603F603F603F603F603F603F00FFFF"
+	$"FF00603F603F603F603F603F603F603F603F603F603F603F603F603F00AEAEAE"
+	$"00003F603F603F603F603F603F603F603F603F603F603F603F603F0000AEAE1B"
+	$"FFAE0000603F603F603F603F603F603F603F603F603F603F603F00AE8700AE1B"
+	$"FFFFAE0000006060606060606060606060601B60606060606000AE87870100AE"
+	$"FFFFFFAE00AE00006060606060606060606060601B60606000AE870000AEAEAE"
+	$"FFFFFFFFAE00AEAE00006087608760876087608760871B29AE0000AEAEFFFFFF"
+	$"FFFFFFFFFFAE0087AEAE000087878787878787878787010000AEAEFFFFFFFFFF"
+	$"FFFFFFFFFFFFAE008787AEAE0000878787878787870100AEAEFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFAE00608787AEAE0000AEAEAEAE00AEAEFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFAE0060608787AEAE0000AE00AEAEFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFAE00606060870000AE00AEAEFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFAE00600000AEAEAEAEAEFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFAE00AEAEFFFFFFAEFFFFFFFFFFFFFFFFFFFFFFFFFF"
+	$"FFFFFFFFFFFFFFFFFFFFFFFFAEFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF"
+};
diff --git a/main/makefile b/main/makefile
index 72641a8..e76b8a5 100644
--- a/main/makefile
+++ b/main/makefile
@@ -40,12 +40,12 @@ SRCS= main.cp
 
 #	specify the resource definition files to use
 #	full path or a relative path to the resource file can be used.
-RDEFS= 
+RDEFS= Resource.rdef
 	
 #	specify the resource files to use. 
 #	full path or a relative path to the resource file can be used.
 #	both RDEFS and RSRCS can be defined in the same makefile.
-RSRCS= Resource.rsrc
+RSRCS= 
 
 # @<-src@ 
 #%}
-- 
2.39.2


From a43ae7c9032e1757fb525deaa2942cfb696d7d75 Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Sun, 16 Jul 2023 17:00:48 -0600
Subject: disable narrowing conversion warnings


diff --git a/editors/makefile b/editors/makefile
index 30de579..2690f6d 100644
--- a/editors/makefile
+++ b/editors/makefile
@@ -124,7 +124,7 @@ SYMBOLS =
 DEBUGGER = 
 
 #	specify additional compiler flags for all files
-COMPILER_FLAGS =
+COMPILER_FLAGS = -Wno-narrowing
 
 #	specify additional linker flags
 LINKER_FLAGS =
diff --git a/main/makefile b/main/makefile
index e76b8a5..347e1c6 100644
--- a/main/makefile
+++ b/main/makefile
@@ -124,7 +124,7 @@ SYMBOLS =
 DEBUGGER = 
 
 #	specify additional compiler flags for all files
-COMPILER_FLAGS =
+COMPILER_FLAGS = -Wno-narrowing
 
 #	specify additional linker flags
 LINKER_FLAGS =
-- 
2.39.2


From 9b0a500453db905f15c86b8dd2014f9e03e0677c Mon Sep 17 00:00:00 2001
From: Chris Roberts <cpr420@gmail.com>
Date: Sun, 16 Jul 2023 17:16:51 -0600
Subject: fix /tmp directory and app sig


diff --git a/main/class.h b/main/class.h
index 67865fb..a456067 100644
--- a/main/class.h
+++ b/main/class.h
@@ -5,7 +5,7 @@ bool openpan;
 
 class BRApplication : public BApplication {
 	public:
-	BRApplication(void) : BApplication("application/resourcer") {openpan = false;retrieve = new char[2];retrieve[0] = 0;}
+	BRApplication(void) : BApplication("application/x-vnd.resourcer") {openpan = false;retrieve = new char[2];retrieve[0] = 0;}
 	void RefsReceived(BMessage *message);
 	void getready(BMessage *message,bool istempfile = false);
 	void dissectwindow(BMessage *msg);
@@ -41,13 +41,13 @@ class BRApplication : public BApplication {
 			return;
 		BMessage *msg = new BMessage(B_SAVE_REQUESTED);
 		entry_ref ref;
-		BEntry("/boot/var/tmp").GetRef(&ref);
+		BEntry("/tmp").GetRef(&ref);
 		//BEntry entry;
 		msg->AddRef("directory",&ref);
 		char text[B_FILE_NAME_LENGTH];
 		sprintf(text,"tmpresfile0");
 		BEntry entry;
-		BDirectory tmp("/boot/var/tmp");
+		BDirectory tmp("/tmp");
 		for (int i = 1;tmp.FindEntry(text,&entry) != B_ENTRY_NOT_FOUND; i++) {
 			sprintf(text,"tmpresfile%d",i);
 		}
-- 
2.39.2

