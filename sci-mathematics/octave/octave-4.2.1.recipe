SUMMARY="A high-level language for numerical computations"
DESCRIPTION="GNU Octave is a high-level language, primarily intended for \
numerical computations.  It provides a convenient command line interface \
for solving linear and nonlinear problems numerically."
HOMEPAGE="http://www.octave.org/"
COPYRIGHT="2011-2016 The octave Project"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://ftp.gnu.org/gnu/octave/octave-$portVersion.tar.gz"
CHECKSUM_SHA256="80c28f6398576b50faca0e602defb9598d6f7308b0903724442c2a35a605333b"
PATCHES="octave-$portVersion.patchset"

ARCHITECTURES="!x86_gcc2 ?x86 x86_64"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	octave$secondaryArchSuffix = $portVersion
	cmd:mkoctfile$secondaryArchSuffix = $portVersion
	cmd:octave$secondaryArchSuffix = $portVersion
	cmd:octave_cli$secondaryArchSuffix = $portVersion
	cmd:octave_config$secondaryArchSuffix = $portVersion
	cmd:mkoctfile_$portVersion$secondaryArchSuffix = $portVersion
	cmd:octave_$portVersion$secondaryArchSuffix = $portVersion
	cmd:octave_cli_$portVersion$secondaryArchSuffix = $portVersion
	cmd:octave_config_$portVersion$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libbz2$secondaryArchSuffix
	lib:libcurl$secondaryArchSuffix
	lib:libfftw3$secondaryArchSuffix
	lib:libfontconfig$secondaryArchSuffix
	lib:libfreetype$secondaryArchSuffix
	lib:libgfortran$secondaryArchSuffix
	lib:libGl$secondaryArchSuffix
	lib:libGLU$secondaryArchSuffix
	lib:libgomp$secondaryArchSuffix
	#lib:libgraphicsmagick$secondaryArchSuffix
	lib:liblapack$secondaryArchSuffix
	#lib:libmagick++_6.q16$secondaryArchSuffix
	lib:libncursesw$secondaryArchSuffix
	lib:libopenblas$secondaryArchSuffix
	lib:libpcre$secondaryArchSuffix
	lib:libreadline$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

PROVIDES_devel="
	octave${secondaryArchSuffix}_devel = $portVersion
	#devel:liboctave$secondaryArchSuffix = $portVersion compat >= 0
	"
REQUIRES_devel="
	octave$secondaryArchSuffix == $portVersion base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libbz2$secondaryArchSuffix
	devel:libcurl$secondaryArchSuffix
	devel:libfftw3$secondaryArchSuffix
	devel:libfontconfig$secondaryArchSuffix
	devel:libfreetype$secondaryArchSuffix
	devel:libgfortran$secondaryArchSuffix
	devel:libGl$secondaryArchSuffix
	devel:libGLU$secondaryArchSuffix
	devel:libgomp$secondaryArchSuffix
	#devel:libgraphicsmagick$secondaryArchSuffix
	devel:liblapack$secondaryArchSuffix
	#devel:libmagick++_6.q16$secondaryArchSuffix
	devel:libncursesw$secondaryArchSuffix
	devel:libopenblas$secondaryArchSuffix
	devel:libpcre$secondaryArchSuffix
	devel:libreadline$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:awk
	cmd:bison
	cmd:find
	#cmd:flex
	cmd:gfortran$secondaryArchSuffix
	cmd:gnuplot$secondaryArchSuffix
	#cmd:gperf
	cmd:grep
	#cmd:gs
	cmd:g++$secondaryArchSuffix
	cmd:less
	cmd:libtoolize$secondaryArchSuffix
	cmd:make
	#cmd:makeinfo
	cmd:perl
	cmd:pkg_config$secondaryArchSuffix
	#cmd:python
	#cmd:rsvg_convert
	cmd:sed
	"

BUILD()
{
	export LDFLAGS="-lnetwork"

	runConfigure ./configure \
		--disable-docs \
		--without-qt \
		--with-openssl \
		--without-x \
		--with-lapack=$libDir/liblapack.so.3

	make $jobArgs
}

INSTALL()
{
	make install

	packageEntries devel \
		$developDir
}

TEST()
{
	make check
}
