From f31b86938397bd423a781ce0f989749827256962 Mon Sep 17 00:00:00 2001
From: Jerome Duval <jerome.duval@gmail.com>
Date: Fri, 26 Feb 2016 14:51:15 +0000
Subject: Haiku patch


diff --git a/src/arscan.c b/src/arscan.c
index edd4070..ee88d6b 100644
--- a/src/arscan.c
+++ b/src/arscan.c
@@ -331,7 +331,7 @@ ar_scan (const char *archive, ar_member_func_t function, const void *varg)
 #endif
 
 #ifndef WINDOWS32
-# if !defined (__ANDROID__) && !defined (__BEOS__) && !defined(MK_OS_ZOS)
+# if !defined (__ANDROID__) && !defined (__BEOS__) && !defined(__HAIKU__) && !defined(MK_OS_ZOS)
 #  include <ar.h>
 # else
    /* These platforms don't have <ar.h> but have archives in the same format
-- 
2.45.2


From ebc3c52617c0f666f3a59fdd0160786f9cc05e94 Mon Sep 17 00:00:00 2001
From: David Karoly <david.karoly@outlook.com>
Date: Sun, 21 Nov 2021 15:47:19 +0000
Subject: fix build


diff --git a/src/dir.c b/src/dir.c
index 3e94b98..622a9a0 100644
--- a/src/dir.c
+++ b/src/dir.c
@@ -1253,7 +1253,7 @@ read_dirstream (void *stream)
           /* The glob interface wants a 'struct dirent', so mock one up.  */
           struct dirent *d;
           size_t len = df->length + 1;
-          size_t sz = sizeof (*d) - sizeof (d->d_name) + len;
+          size_t sz = offsetof (struct dirent, d_name) + len;
           if (sz > bufsz)
             {
               bufsz *= 2;
-- 
2.45.2

