From 1ac43d9e9219a827163384f99b5e86eac75858e7 Mon Sep 17 00:00:00 2001
From: Luc Schrijvers <begasus@gmail.com>
Date: Wed, 30 Apr 2025 08:59:19 +0200
Subject: Fix build error for tests


diff --git a/test/signal/test-signalhandler.cpp b/test/signal/test-signalhandler.cpp
index 335a942..2f71b49 100644
--- a/test/signal/test-signalhandler.cpp
+++ b/test/signal/test-signalhandler.cpp
@@ -52,7 +52,7 @@
     ++*static_cast<int*>(nullptr); // NOLINT(clang-analyzer-core.NullDereference)
 }
 
-#if !defined(__APPLE__)
+#if !defined(__APPLE__) && !defined(__HAIKU__)
 /*static*/ int my_fpe() // NOLINT(misc-use-internal-linkage)
 {
     if (feenableexcept(FE_ALL_EXCEPT) == -1)
@@ -78,7 +78,7 @@ int main(int argc, const char * const argv[])
         my_abort();
     else if (strcmp(argv[1], "segv") == 0)
         my_segv();
-#if !defined(__APPLE__)
+#if !defined(__APPLE__) && !defined(__HAIKU__)
     else if (strcmp(argv[1], "fpe") == 0)
         return my_fpe();
 #endif
-- 
2.50.1


From 51eef1a146f07b4be39db0773da738f34bb00c57 Mon Sep 17 00:00:00 2001
From: Joachim Reichel <reichel@debian.org>
Date: Wed, 30 Apr 2025 10:58:42 +0200
Subject: Install the translations in /lang instead of /usr/bin


diff --git a/gui/CMakeLists.txt b/gui/CMakeLists.txt
index 143f966..95855ad 100644
--- a/gui/CMakeLists.txt
+++ b/gui/CMakeLists.txt
@@ -99,7 +99,7 @@ CheckOptions:
     endif()
 
     install(TARGETS cppcheck-gui RUNTIME DESTINATION ${CMAKE_INSTALL_FULL_BINDIR} COMPONENT applications)
-    install(FILES ${qms} DESTINATION ${CMAKE_INSTALL_FULL_BINDIR} COMPONENT applications)
+    install(FILES ${qms} DESTINATION ${FILESDIR}/lang COMPONENT applications)
 
     install(FILES cppcheck-gui.desktop DESTINATION ${CMAKE_INSTALL_DATAROOTDIR}/applications)
 
-- 
2.50.1


From 578215a8cf7ff7ddb4b197e6e0ec3c3cf4f5e876 Mon Sep 17 00:00:00 2001
From: Joachim Reichel <reichel@debian.org>
Date: Wed, 30 Apr 2025 11:00:26 +0200
Subject: Set configuration directory and python version


diff --git a/gui/main.cpp b/gui/main.cpp
index 91bc9e7..e974aac 100644
--- a/gui/main.cpp
+++ b/gui/main.cpp
@@ -60,6 +60,12 @@ int main(int argc, char *argv[])
 
     auto* settings = new QSettings("Cppcheck", "Cppcheck-GUI", &app);
 
+    // Set some default settings
+    if( settings->value("DATADIR", QString()).toString().isEmpty())
+        settings->setValue("DATADIR", FILESDIR);
+    if( settings->value(SETTINGS_PYTHON_PATH, QString()).toString().isEmpty())
+        settings->setValue(SETTINGS_PYTHON_PATH, QString("/usr/bin/python3"));
+
     // Set data dir..
     const QStringList args = QApplication::arguments();
     auto it = std::find_if(args.cbegin(), args.cend(), [](const QString& arg) {
-- 
2.50.1

