SUMMARY="A cross-platform build system"
DESCRIPTION="BSDBuild is a cross-platform build system. Derived from the \
traditional 4.4BSD make libraries, BSDBuild allows BSD-style Makefiles \
(without BSD make extensions), and works natively under most operating \
systems and make flavors. Since BSDBuild is implemented as a library \
(as opposed to a macro package), Makefiles are edited directly, as opposed \
to being compiled (however, if the build directory is separate from the \
source directory, BSDBuild will produce the required Makefiles in place)."
HOMEPAGE="http://hypertriton.com/bsdbuild/"
COPYRIGHT="2001-2012 Hypertrition, Inc."
LICENSE="BSD (2-clause)"
REVISION="1"
SOURCE_URI="http://stable.hypertriton.com/bsdbuild/bsdbuild-$portVersion.tar.gz"
CHECKSUM_SHA256="d4c562c33cda97f2c5c71ced422f336060a7402237ffc41d84937ca30e942dff"
PATCHES="bsdbuild-$portVersion.patchset"

ARCHITECTURES="x86_gcc2 ?x86_64"

PROVIDES="
	bsdbuild = $portVersion
	cmd:h2mandoc
	cmd:man2wiki
	cmd:mkconfigure
	cmd:mkify
	cmd:mkprojfiles
	cmd:uman
	"
REQUIRES="
	haiku
	"

BUILD_REQUIRES="
	haiku_devel
	"
BUILD_PREREQUIRES="
	cmd:gcc
	cmd:make
	cmd:perl
	"

BUILD()
{
	cp mkconfigure.pl mkconfigure
	cp gen-dotdepend.pl gen-dotdepend-tmp.pl
	sed -i 's#/usr/bin/perl#/bin/env perl#' mkconfigure
	sed -i 's#$INSTALLDIR/gen-dotdepend.pl#./gen-dotdepend.pl#' mkconfigure
	cat configure.in | mkconfigure > configure
	rm mkconfigure
if [ "$targetArchitecture" = x86_gcc2 ]; then
	./configure --bindir=$binDir --mandir=$manDir --datadir=$libDir/perl5/5.18.2
else
	./configure --bindir=$binDir --mandir=$manDir --datadir=$libDir/perl5/5.26
fi
	make depend all $jobArgs
}

INSTALL()
{
	make install
	#rm -r $prefix/libtool #do we need these?
	cp -R man/*.1 $manDir/man1
	cp -R man/*.5 $manDir/man5
	rm -r $manDir/cat*
	rm -r $manDir/{man2,man3,man4,man6,man7,man8,man9}
}
