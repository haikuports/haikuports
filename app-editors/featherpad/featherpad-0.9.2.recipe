SUMMARY="A lightweight Qt5 plain-text editor for Linux"
DESCRIPTION="FeatherPad (by Pedram Pourang, a.k.a. Tsu Jan \
<tsujan2000@gmail.com>) is a lightweight Qt5 plain-text editor for Linux \
It is independent of any desktop environment and has: \
* Drag-and-drop support, including tab detachment and attachment;
* X11 virtual desktop awareness (using tabs on current desktop but opening \
a new window on another);
* An optionally permanent search-bar with a different search entry for each tab;
* Instant highlighting of found matches when searching;
* A docked window for text replacement;
* Support for showing line numbers and jumping to a specific line;
* Automatic detection of text encoding as far as possible and optional \
saving with encoding;
* Syntax highlighting for common programming languages;
* Ability to open URLs with appropriate applications;
* Session management;
* Side-pane mode;
* Auto-saving;
* Printing;
* Text zooming;
* Appropriate but non-interrupting prompts;
* Haiku OS support; and
* Other features that can be found in its settings,
on its menus or when it is actually used."
HOMEPAGE="https://github.com/tsujan/FeatherPad"
COPYRIGHT="2016, 2018 Pedram Pourang"
LICENSE="GNU GPL v3"
REVISION="1"
SOURCE_URI="https://github.com/tsujan/FeatherPad/archive/V$portVersion.tar.gz"
CHECKSUM_SHA256="f3ed0bc17b1679e8498d3e453209055274a9f89b1fec01a1201389365d47e67c"
SOURCE_FILENAME="FeatherPad-$portVersion-tar.gz"
SOURCE_DIR="FeatherPad-$portVersion"
ADDITIONAL_FILES="featherpad.rdef.in"

ARCHITECTURES="!x86_gcc2 x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

PROVIDES="
	featherpad$secondaryArchSuffix = $portVersion
	app:FeatherPad$secondaryArchSuffix = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libGL$secondaryArchSuffix
	lib:libQt5Core$secondaryArchSuffix
	lib:libQt5Gui$secondaryArchSuffix
	lib:libQt5Network$secondaryArchSuffix
	lib:libQt5PrintSupport$secondaryArchSuffix
	lib:libQt5Svg$secondaryArchSuffix
	lib:libQt5Widgets$secondaryArchSuffix
	lib:libz$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libGL$secondaryArchSuffix
	devel:libQt5Core$secondaryArchSuffix
	devel:libQt5Gui$secondaryArchSuffix
	devel:libQt5Network$secondaryArchSuffix
	devel:libQt5PrintSupport$secondaryArchSuffix
	devel:libQt5Svg$secondaryArchSuffix
	devel:libQt5Widgets$secondaryArchSuffix
	devel:libz$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:find
	cmd:g++$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:lrelease$secondaryArchSuffix >= 5
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	cmd:qmake$secondaryArchSuffix >= 5
	"

BUILD()
{
	qmake PREFIX=$appsDir/FeatherPad
	make $jobArgs
}

INSTALL()
{
	make install

	local APP_SIGNATURE="application/x-vnd-featherpad"
	local MAJOR="`echo "$portVersion" | cut -d. -f1`"
	local MIDDLE="`echo "$portVersion" | cut -d. -f2`"
	local MINOR="`echo "$portVersion" | cut -d. -f3`"
	local LONG_INFO="$SUMMARY"

	sed \
		-e "s|@APP_SIGNATURE@|$APP_SIGNATURE|" \
		-e "s|@MAJOR@|$MAJOR|" \
		-e "s|@MIDDLE@|$MIDDLE|" \
		-e "s|@MINOR@|$MINOR|" \
		-e "s|@LONG_INFO@|$LONG_INFO|" \
		$portDir/additional-files/featherpad.rdef.in > featherpad.rdef

	addResourcesToBinaries featherpad.rdef $appsDir/FeatherPad/FeatherPad
	addAppDeskbarSymlink $appsDir/FeatherPad/FeatherPad
}
