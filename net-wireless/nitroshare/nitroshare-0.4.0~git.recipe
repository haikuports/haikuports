SUMMARY="A cross-platform network file transfer application"
DESCRIPTION="Features

* Runs on Windows / Mac OS X / Linux
* Automatic discovery of devices on the local network
* Simple and intuitive user interface
* Incredibly fast transfer speeds
* Transfer entire directories
* Optional TLS encryption
* Local HTTP API
* Completely free and open-source"
HOMEPAGE="https://github.com/nitroshare/nitroshare-desktop"
COPYRIGHT="2015-2019 Nathan Osman"
LICENSE="MIT"
REVISION="1"
srcGitRev="a2fc0eae88fb2ea8a13f02e052a0af47b8532a2f"
SOURCE_URI="$HOMEPAGE/archive/$srcGitRev.tar.gz"
CHECKSUM_SHA256="5aee1aa91f800068d5ee3428a9d900a768ba3fea93e329c52b5e0cd12e3852b6"
SOURCE_FILENAME="nitroshare-$srcGitRev.tar.gz"
SOURCE_DIR="nitroshare-desktop-$srcGitRev"
PATCHES="nitroshare-$portVersion.patchset"

ARCHITECTURES="all !x86_gcc2"
SECONDARY_ARCHITECTURES="?x86"

PROVIDES="
	nitroshare$secondaryArchSuffix = $portVersion
	app:nitroshare = $portVersion
	lib:libnitroshare$secondaryArchSuffix
	cmd:nitroshare$secondaryArchSuffix
	cmd:nitroshare_cli$secondaryArchSuffix
	cmd:nitroshare_nmh$secondaryArchSuffix
	cmd:nitroshare_ui$secondaryArchSuffix

	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libqhttpengine$secondaryArchSuffix
	lib:libqmdnsengine$secondaryArchSuffix
	lib:libQt5Core$secondaryArchSuffix
	lib:libQt5Gui$secondaryArchSuffix
	lib:libQt5Network$secondaryArchSuffix
	lib:libQt5Svg$secondaryArchSuffix
	lib:libQt5Widgets$secondaryArchSuffix
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	devel:libqhttpengine$secondaryArchSuffix
	devel:libqmdnsengine$secondaryArchSuffix
	devel:libQt5Core$secondaryArchSuffix
	devel:libQt5Gui$secondaryArchSuffix
	devel:libQt5Network$secondaryArchSuffix
	devel:libQt5Svg$secondaryArchSuffix
	devel:libQt5Widgets$secondaryArchSuffix
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:g++$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	cmd:pkg_config$secondaryArchSuffix
	"

defineDebugInfoPackage nitroshare$secondaryArchSuffix \
	"$appsDir"/Nitroshare

BUILD()
{
	cmake -DCMAKE_BUILD_TYPE=Release \
	-DINSTALL_BIN_PATH=$binDir \
	-DINSTALL_LIB_PATH=$libDir \
	-DINSTALL_INCLUDE_PATH=$includeDir
	
	make $jobArgs
}

INSTALL()
{
	make install
	rm -rf $includeDir
	mkdir -p $appsDir
	cp out/bin/nitroshare-ui $appsDir/Nitroshare

	# TODO: Add icon
	addAppDeskbarSymlink $appsDir/Nitroshare/Nitroshare
}
