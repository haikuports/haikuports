SUMMARY="C library and command line tools for LZMA"
DESCRIPTION="Easylzma is a C library and command line tools for LZMA \
compression and decompression.  It uses a Igor Pavlov's reference \
implementation and SDK written in C."
HOMEPAGE="https://lloyd.github.io/easylzma/"
COPYRIGHT="2009 lloyd"
LICENSE="Public Domain"
REVISION="1"
SOURCE_URI="https://github.com/lloyd/easylzma/archive/$portVersion.tar.gz"
CHECKSUM_SHA256="c32565643598ba5147332d094d0392ec5b15b494e237c39a712db3fab9d9939a"
SOURCE_FILENAME="easylzma-$portVersion.tar.gz"
PATCHES="easylzma-$portVersion.patchset"

ARCHITECTURES="x86_gcc2 x86 x86_64"
SECONDARY_ARCHITECTURES="x86"

libVersion="$portVersion"
libVersionCompat="$libVersion compat >= ${libVersion%%.*}"

PROVIDES="
	easylzma$secondaryArchSuffix = $portVersion
	cmd:elzma$secondaryArchSuffix = $portVersion
	cmd:unelzma$secondaryArchSuffix = $portVersion
	lib:libeasylzma$secondaryArchSuffix = $libVersionCompat
	"
REQUIRES="
	haiku$secondaryArchSuffix
	"

PROVIDES_devel="
	easylzma${secondaryArchSuffix}_devel = $portVersion
	devel:libeasylzma$secondaryArchSuffix = $libVersionCompat
	devel:libeasylzma_s$secondaryArchSuffix = $libVersionCompat
	"
REQUIRES_devel="
	easylzma$secondaryArchSuffix == $portVersion base
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	cmd:cmake
	cmd:gcc$secondaryArchSuffix
	cmd:ld$secondaryArchSuffix
	cmd:make
	"

BUILD()
{
	mkdir build && cd build
	cmake ..
	make $jobArgs
}

INSTALL()
{
	cd build/easylzma-$portVersion
	install -d $binDir $libDir $includeDir/easylzma
	install -t $binDir bin/*
	install -t $libDir lib/*
	install -t $includeDir/easylzma include/easylzma/*

	prepareInstalledDevelLibs libeasylzma libeasylzma_s
	packageEntries devel \
		$developDir
}
