SUMMARY="Pre-built binaries for the FPC build"
DESCRIPTION="Pre-built FPC binaries for Haiku i386."
HOMEPAGE="http://www.freepascal.org"
COPYRIGHT="1993-2015 Florian Klaempfl and others"
LICENSE="GNU LGPL v3
	GNU GPL v3"
REVISION="1"
SOURCE_URI="http://sourceforge.net/projects/freepascal/files/Haiku/3.0.2/fpc-3.0.2.i386-haiku.tar"
CHECKSUM_SHA256="f3e1cdd1e5f354d7436313f07ec5fbee91f7b02df01433b30902609b3bb3d2ea"
SOURCE_DIR="fpc-3.0.2.i386-haiku"
DISABLE_SOURCE_PACKAGE="YES"

ARCHITECTURES="x86_gcc2 x86"

PROVIDES="
	fpc_bin = $portVersion
	cmd:fpc = $portVersion
	cmd:ppc386 = $portVersion
	cmd:bin2obj = $portVersion
	cmd:chmcmd = $portVersion
	cmd:chmls = $portVersion
	cmd:data2inc = $portVersion
	cmd:delp = $portVersion
	cmd:fd2pascal = $portVersion
	cmd:fp = $portVersion
	cmd:fpcjres = $portVersion
	cmd:fpclasschart = $portVersion
	cmd:fpcmake = $portVersion
	cmd:fpcmkcfg = $portVersion
	cmd:fpcres = $portVersion
	cmd:fpcsubst = $portVersion
	cmd:fpdoc = $portVersion
	cmd:fppkg = $portVersion
	cmd:fprcp = $portVersion
	cmd:h2pas = $portVersion
	cmd:h2paspp = $portVersion
	cmd:instantfpc = $portVersion
	cmd:makeskel = $portVersion
	cmd:mkarmins = $portVersion
	cmd:mkinsadd = $portVersion
	cmd:mkx86ins = $portVersion
	cmd:pas2fpm = $portVersion
	cmd:pas2jni = $portVersion
	cmd:pas2ut = $portVersion
	cmd:plex = $portVersion
	cmd:postw32 = $portVersion
	cmd:ppdep = $portVersion
	cmd:ppudump = $portVersion
	cmd:ppufiles = $portVersion
	cmd:ppumove = $portVersion
	cmd:ptop = $portVersion
	cmd:pyacc = $portVersion
	cmd:rmcvsdir = $portVersion
	cmd:rstconv = $portVersion
	cmd:unitdiff = $portVersion
	cmd:cvsco.tdf = $portVersion
	cmd:cvsdiff.tdf = $portVersion
	cmd:cvsup.tdf = $portVersion
	cmd:fp.ans = $portVersion
	cmd:gplprog.pt = $portVersion
	cmd:gplunit.pt = $portVersion
	cmd:grep.tdf = $portVersion
	cmd:makeskel.rsj = $portVersion
	cmd:program.pt = $portVersion
	cmd:ptop.rsj = $portVersion
	cmd:tpgrep.tdf = $portVersion
	cmd:unit.pt = $portVersion
	"
REQUIRES="
	haiku$secondaryArchSuffix
	lib:libncurses
	"

BUILD_REQUIRES="
	haiku${secondaryArchSuffix}_devel
	"
BUILD_PREREQUIRES="
	binutils
	cmd:tar
	"

BUILD()
{
	true
}

INSTALL()
{
	for f in `tar tf binary.i386-haiku.tar`; do
		tar -xOf binary.i386-haiku.tar $f | tar -C $prefix -xzf -
	done
	mkdir -p $docDir/examples
	#no pdf doc
	#tar -xzf doc-pdf.tar.gz -C $docDir --strip 1
	#no demos
	#tar -xzf demo.tar.gz -C $docDir/examples
	ln -s ../lib/fpc/3.0.2/ppc386 ../../packaging/fpc_bin/bin/ppc386
	# generate configuration file
	pwd
	mkdir -p ../../packaging/fpc_bin/lib/fpc/etc
	#old../../packaging/fpc_bin/lib/fpc/3.0.2/samplecfg /boot/system/lib/fpc/3.0.2 ../../packaging/fpc_bin/lib/fpc/etc
	##move to post_install_script # ../../packaging/fpc_bin/lib/fpc/3.0.2/samplecfg /boot/system/lib/fpc/3.0.2 /etc
	#remove doc and share folders
	rm -dR $prefix/doc
	rm -dR $prefix/share
	#create post script
	mkdir $prefix/boot
	mkdir $prefix/boot/post-install
	echo "#!/bin/bash" > $postInstallDir/createcfg.sh
	echo "/boot/system/lib/fpc/3.0.2/samplecfg /boot/system /etc" >$postInstallDir/createcfg.sh
	chmod 755 $postInstallDir/createcfg.sh

}

POST_INSTALL_SCRIPTS="
boot/post-install/createcfg.sh
"
